function e(e,t,n,o){Object.defineProperty(e,t,{get:n,set:o,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},i=t.parcelRequire1e7e;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},t.parcelRequire1e7e=i);var r=i.register;r("hbluw",function(e,t){let n="STAGE",o={PROD:{ENDPOINT:"",UPLOAD_ENDPOINT:""},STAGE:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"},DEV:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"}};e.exports={ENDPOINT:o[n].ENDPOINT,UPLOAD_ENDPOINT:o[n].UPLOAD_ENDPOINT}}),r("jXEky",function(t,n){e(t.exports,"LOADER_ELEM_ID",function(){return r}),e(t.exports,"uriUserPage",function(){return a}),e(t.exports,"uriCollectionPage",function(){return l}),e(t.exports,"LevelPrivacy",function(){return c}),e(t.exports,"PRIVACY_BADGE_STYLE",function(){return d}),e(t.exports,"PRIVACY_BADGE_TEXT",function(){return s}),e(t.exports,"startLoader",function(){return u}),e(t.exports,"cancelLoader",function(){return m}),e(t.exports,"callJsonApi",function(){return p}),e(t.exports,"looksLikeMail",function(){return f}),e(t.exports,"activateGoHomeLink",function(){return E}),e(t.exports,"MEDIA_CONSTRAINTS",function(){return y});var o=i("hbluw");let r="loader",a="/index.html?userid=",l="/index.html?collectionid=";Object.freeze({none:0,owner:1,admin:2,member:3,guest:4});let c=Object.freeze({public:1,onlyreg:2,private:3}),d={[c.public]:"badge-public",[c.onlyreg]:"badge-onlyreg",[c.private]:"badge-private"},s={[c.public]:"PUBLIC",[c.onlyreg]:"REG USERS",[c.private]:"PRIVATE"},u=(e,t)=>{let n=document.getElementById(e);n.nextElementSibling.textContent=t,n.classList.add(e)},m=e=>{let t=document.getElementById(e);t.classList.remove(e),t.nextElementSibling.textContent=""},p=async(e,t,n)=>{let i={method:t||"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}};n&&(i.body=JSON.stringify(n));try{u(r,"Loading...");let t=await fetch(o.ENDPOINT+e,i);m(r);let n=await t.json();if(n&&!n.error)return n;return(null==n?void 0:n.error)||"An error occurred"}catch(e){return m(r),e}},f=e=>{let t=e.lastIndexOf("@"),n=e.lastIndexOf(".");return t<n&&t>0&&-1==e.indexOf("@@")&&n>2&&e.length-n>2},E=()=>{let e=document.getElementById("goHome");"localhost:80"===window.location.host||"http://localhost"===window.location.origin?e.href=window.location.origin+"/index.html":e.href=window.location.origin};/^((?!chrome|android).)*safari/i.test(navigator.userAgent);let y={audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,latency:0,channelCount:1}}}),r("faZmx",function(t,n){e(t.exports,"checkIfTermsAccepted",function(){return r}),e(t.exports,"generateAcceptTermsModal",function(){return d});var o=i("jXEky");let r=(e,t)=>{(0,o.cancelLoader)(o.LOADER_ELEM_ID),t(null==e?void 0:e.terms_accepted)},a=()=>{$("#acceptTermsModal").modal({backdrop:"static",keyboard:!1}),$("#acceptTermsModal").modal("show"),document.getElementById("buttonAcceptTerms").onclick=l,document.getElementById("buttonRejectTerms").onclick=c},l=async()=>{(await (0,o.callJsonApi)("/acceptterms","PUT")).ok&&$("#acceptTermsModal").modal("hide")},c=async()=>{(await (0,o.callJsonApi)("/rejectterms","PUT")).ok&&($("#acceptTermsModal").modal("hide"),window.location.href=window.location.origin)},d=e=>{if(!document.getElementById("acceptTermsModal")){let t=`<div class="modal fade" id="acceptTermsModal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title">Accept Terms</h5>                
                </div>
                <div class="modal-body">
                <p>By clicking on OK you accept the Terms of Use.</p>
                <p>More information at: <span> <a href="${window.location.origin}/static/terms.html" target="_blank">${window.location.origin}/static/terms.html</a></span></p>
                </div>
                <div class="modal-footer">
                <button id="buttonRejectTerms" type="button" class="btn btn-secondary" data-dismiss="modal">Reject</button>
                <button id="buttonAcceptTerms" type="button" class="btn btn-primary">OK</button>
                </div>
            </div>
            </div>
        </div>`;document.getElementsByTagName(e)[0].insertAdjacentHTML("afterend",t)}a()}});var a=i("hbluw"),l=i("jXEky"),c=i("faZmx");let d=null,s=!1;const u=document.getElementById("editusernamebutton"),m=e=>{e||(0,c.generateAcceptTermsModal)("main")},p=async e=>{let t=await (0,l.callJsonApi)("/profile","GET");t&&e(t)},f=e=>{document.getElementById("button-deleteprofile").addEventListener("click",async()=>{await y(e)})},E=()=>{document.getElementById("copytokenbutton").onclick=()=>{window.prompt("Copy to clipboard: Ctrl+C, Enter",document.getElementById("apitoken").innerHTML)}},y=async e=>{let t=prompt("To confirm, please enter your User ID","");if(t===e)try{let t=await fetch(a.ENDPOINT+"/deleteuser/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"}});await t.json()&&(window.location.href=window.location.origin)}catch(e){alert(e)}else t!==e&&null!==t&&alert("Sorry, the User ID does not match")},g=()=>{document.getElementById("usernameinputfield").classList.add("italic"),document.getElementById("usernameinputfield").removeAttribute("readonly")},w=async()=>{let e=document.getElementById("usernameinputfield"),t=e.value;if(e.value=t.trim(),d===t)T();else{let n=await (0,l.callJsonApi)("/updateusername","PATCH",{user_name:t});n.ok?(d=t,T()):(e.classList.add("is-invalid"),document.getElementById("validationusernameresult").innerText="Sorry, "+n)}},T=()=>{let e=document.getElementById("usernameinputfield");s=!1,u.innerHTML='<i class="fas fa-edit">&nbsp;</i>Edit username',e.setAttribute("readonly","true"),e.classList.remove("is-invalid"),e.classList.remove("italic"),document.getElementById("validationusernameresult").innerText=""};(0,l.activateGoHomeLink)(),u.addEventListener("click",()=>{s?w():(s=!0,u.innerHTML='<i class="fas fa-save">&nbsp;</i>Save',g())},!1),p(e=>{e.ok?((0,c.checkIfTermsAccepted)(e,m),document.getElementById("profilecard").hidden=!1,document.getElementById("profilepicture").src=`https://picsum.photos/seed/${e.user_uid}/200`,d=e.name,document.getElementById("usernameinputfield").value=e.name,document.getElementById("userid").innerHTML=e.user_uid,document.getElementById("emailaddress").innerHTML=e.email,f(e.user_uid),document.getElementById("apicard").hidden=!1,document.getElementById("apitoken").innerHTML=e.token,document.getElementById("curlcode").innerHTML=`$ export JWT="${e.token}"  <br /><br />$ curl ${window.location.protocol}//${window.location.host}/profile   -H "Authorization: Bearer $JWT"`,E()):document.getElementById("logincard").hidden=!1});
//# sourceMappingURL=profile.4b0b8ddc.js.map
