function e(e,t,n,o){Object.defineProperty(e,t,{get:n,set:o,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},i=t.parcelRequire1e7e;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},t.parcelRequire1e7e=i);var r=i.register;r("hbluw",function(e,t){let n="STAGE",o={PROD:{ENDPOINT:"",UPLOAD_ENDPOINT:""},STAGE:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"},DEV:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"}};e.exports={ENDPOINT:o[n].ENDPOINT,UPLOAD_ENDPOINT:o[n].UPLOAD_ENDPOINT}}),r("jXEky",function(t,n){e(t.exports,"uriUserPage",function(){return r}),e(t.exports,"uriCollectionPage",function(){return a}),e(t.exports,"UserRole",function(){return l}),e(t.exports,"LevelPrivacy",function(){return d}),e(t.exports,"PRIVACY_BADGE_STYLE",function(){return c}),e(t.exports,"PRIVACY_BADGE_TEXT",function(){return s}),e(t.exports,"startLoader",function(){return u}),e(t.exports,"cancelLoader",function(){return m}),e(t.exports,"callJsonApi",function(){return p}),e(t.exports,"looksLikeMail",function(){return f}),e(t.exports,"activateGoHomeLink",function(){return y}),e(t.exports,"MEDIA_CONSTRAINTS",function(){return g});var o=i("hbluw");let r="/index.html?userid=",a="/index.html?collectionid=",l=Object.freeze({none:0,owner:1,admin:2,member:3,guest:4}),d=Object.freeze({public:1,onlyreg:2,private:3}),c={[d.public]:"badge-public",[d.onlyreg]:"badge-onlyreg",[d.private]:"badge-private"},s={[d.public]:"PUBLIC",[d.onlyreg]:"REG USERS",[d.private]:"PRIVATE"},u=e=>{let t=document.getElementById("loader");t.innerHTML=`<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;${e}`,t.classList.remove("loader-hidden")},m=()=>{document.getElementById("loader").classList.add("loader-hidden")},p=async(e,t,n,i)=>{let r={method:t||"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}};n&&(r.body=JSON.stringify(n));try{i&&u(i);let t=await fetch(o.ENDPOINT+e,r);i&&m();let n=await t.json();if(n&&!n.error)return n;return(null==n?void 0:n.error)||"An error occurred"}catch(e){return i&&m(),e}},f=e=>{let t=e.lastIndexOf("@"),n=e.lastIndexOf(".");return t<n&&t>0&&-1==e.indexOf("@@")&&n>2&&e.length-n>2},y=()=>{let e=document.getElementById("goHome");"localhost:80"===window.location.host||"http://localhost"===window.location.origin?e.href=window.location.origin+"/index.html":e.href=window.location.origin};/^((?!chrome|android).)*safari/i.test(navigator.userAgent);let g={audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,latency:0,channelCount:1}}}),r("faZmx",function(t,n){e(t.exports,"checkIfTermsAccepted",function(){return r}),e(t.exports,"generateAcceptTermsModal",function(){return c});var o=i("jXEky");let r=(e,t)=>{(0,o.cancelLoader)(),t(null==e?void 0:e.terms_accepted)},a=()=>{$("#acceptTermsModal").modal({backdrop:"static",keyboard:!1}),$("#acceptTermsModal").modal("show"),document.getElementById("buttonAcceptTerms").onclick=l,document.getElementById("buttonRejectTerms").onclick=d},l=async()=>{(await (0,o.callJsonApi)("/acceptterms","PUT",null,"Welcome...")).ok&&$("#acceptTermsModal").modal("hide")},d=async()=>{(await (0,o.callJsonApi)("/rejectterms","PUT",null,"Deleting information...")).ok&&($("#acceptTermsModal").modal("hide"),window.location.href=window.location.origin)},c=e=>{if(!document.getElementById("acceptTermsModal")){let t=`<div class="modal fade" id="acceptTermsModal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title">Accept Terms</h5>                
                </div>
                <div class="modal-body">
                <p>By clicking on OK you accept the Terms of Use.</p>
                <p>More information at: <span> <a href="${window.location.origin}/static/terms.html" target="_blank">${window.location.origin}/static/terms.html</a></span></p>
                </div>
                <div class="modal-footer">
                <button id="buttonRejectTerms" type="button" class="btn btn-secondary" data-dismiss="modal">Reject</button>
                <button id="buttonAcceptTerms" type="button" class="btn btn-primary">OK</button>
                </div>
            </div>
            </div>
        </div>`;document.getElementsByTagName(e)[0].insertAdjacentHTML("afterend",t)}a()}});var a=i("hbluw"),l=i("jXEky"),d=i("faZmx");let c=null,s=!1;const u=document.getElementById("editusernamebutton"),m=e=>{e||(0,d.generateAcceptTermsModal)("main")},p=async e=>{let t=await (0,l.callJsonApi)("/profile","GET");t&&e(t)},f=e=>{document.getElementById("button-deleteprofile").addEventListener("click",async()=>{await g(e)})},y=()=>{document.getElementById("copytokenbutton").onclick=()=>{window.prompt("Copy to clipboard: Ctrl+C, Enter",document.getElementById("apitoken").innerHTML)}},g=async e=>{let t=prompt("To confirm, please enter your User ID","");if(t===e)try{let t=await fetch(a.ENDPOINT+"/deleteuser/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"}});await t.json()&&(window.location.href=window.location.origin)}catch(e){alert(e)}else t!==e&&null!==t&&alert("Sorry, the User ID does not match")},E=()=>{document.getElementById("usernameinputfield").classList.add("italic"),document.getElementById("usernameinputfield").removeAttribute("readonly")},T=async()=>{let e=document.getElementById("usernameinputfield"),t=e.value;if(e.value=t.trim(),c===t)w();else{let n=await (0,l.callJsonApi)("/updateusername","PATCH",{user_name:t},"Updating user...");n.ok?(c=t,w()):(e.classList.add("is-invalid"),document.getElementById("validationusernameresult").innerText="Sorry, "+n)}},w=()=>{let e=document.getElementById("usernameinputfield");s=!1,u.innerHTML='<i class="fas fa-edit">&nbsp;</i>Edit username',e.setAttribute("readonly","true"),e.classList.remove("is-invalid"),e.classList.remove("italic"),document.getElementById("validationusernameresult").innerText=""};(0,l.activateGoHomeLink)(),u.addEventListener("click",()=>{s?T():(s=!0,u.innerHTML='<i class="fas fa-save">&nbsp;</i>Save',E())},!1),p(e=>{e.ok?((0,d.checkIfTermsAccepted)(e,m),document.getElementById("profilecard").hidden=!1,document.getElementById("profilepicture").src=`https://picsum.photos/seed/${e.user_uid}/200`,c=e.name,document.getElementById("usernameinputfield").value=e.name,document.getElementById("userid").innerHTML=e.user_uid,document.getElementById("emailaddress").innerHTML=e.email,f(e.user_uid),document.getElementById("apicard").hidden=!1,document.getElementById("apitoken").innerHTML=e.token,document.getElementById("curlcode").innerHTML=`$ export JWT="${e.token}"  <br /><br />$ curl ${window.location.protocol}//${window.location.host}/profile   -H "Authorization: Bearer $JWT"`,y()):document.getElementById("logincard").hidden=!1});
//# sourceMappingURL=profile.87314ad6.js.map
