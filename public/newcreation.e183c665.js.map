{"version":3,"sources":["common/js/config.js","common/js/utils.js","pages/home/scripts/breadcrumbhandler.js","common/js/acceptterms.js","pages/home/scripts/home.js","common/js/collectionshandler.js","pages/home/scripts/editcollections.js","pages/home/scripts/newcreation.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["MODE","DEVPORT","ENVIRONMENTS","PROD","ENDPOINT","UPLOAD_ENDPOINT","STAGE","window","location","protocol","host","DEV","hostname","module","exports","LOADER_ELEM_ID","startLoader","loaderId","loadingMessage","loaderElement","document","getElementById","nextElementSibling","textContent","classList","add","cancelLoader","remove","callJsonApi","apimethod","rqstmethod","body","request","method","headers","JSON","stringify","fetch","sendRqst","json","respToJson","error","looksLikeMail","str","lastAtPos","lastIndexOf","lastDotPos","indexOf","length","breadcrumbHandler","isauth","createBreadCrumbNavBar","querySelectorAll","forEach","element","addEventListener","event","preventDefault","querySelector","currentTarget","section","getAttribute","navigate","navBar","userOptions","ok","innerHTML","getRecentCompositions","getMyCompositions","hidden","getAllCompositions","console","log","checkIfTermsAccepted","userprofile","callback","terms_accepted","handleTermsNotAccepted","$","modal","backdrop","keyboard","onclick","rqstAcceptTerms","rqstRejectTerms","data","href","origin","generateAcceptTermsModal","attachToElem","isModal","modalDialog","getElementsByTagName","insertAdjacentHTML","uriCompositionPage","uriProfilePage","homePageTermsAccepted","termsAccepted","getMyProfile","doAfterIfLogged","doAfterIfNotLogged","isAuthenticated","style","display","innerText","name","compositions","renderHomePage","alert","compositionsList","paintListOfCompositions","listElelemts","collection","template","opentocontrib","uuid","photo_url","COMPOSITION_COVER","title","removeAttribute","initHomPage","isAuth","getCollections","response","result","respJson","getCollectionsError","createListCollections","collections","listId","coll_id","theList","all_collections","listCollContainer","listOptions","selected","EDIT_STATUS","showAllCollButton","editButton","fetchCollectionsTree","createTreeHTML","item","html","composition","renderTree","treeContainer","clickEditButtonHandler","disableEdition","enableEdition","elementsWithHiddenAttribute","removeCollectionClickhHandler","elementsWithDisabledAttribute","updateInputTextEventHandler","value","setAttribute","clickAllCollButtonHandler","confirmDeleteCollectionModal","collectionId","collectionTitle","chk","target","tagName","confirm","listElemToDelete","nextSibling","checked","currentTitle","onblur","handleInputBlur","updateCollectionTitleRqst","updateTitleApi","then","catch","collId","currTitle","newValue","createNewButton","createNewButtonAtHome","clickNewButtonHandler","saveCompositionButton","saveEventListener","getCompCollSuccess","list","replaceChildren","saveEventListenerHandler","e","newCreation","apiMethod","newtitle","privacyLevel","newdescription","collectInput","parentCollection","privacy_level","parent_uuid","description","errorIs","r","statusText","verifyResponse","Error","OVERLAY_ID","OldModule","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","push","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","ws","onmessage","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","message","stack","overlay","createErrorOverlay","appendChild","createElement","stackTrace","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"newcreation.e183c665.js","sourceRoot":"../webapp/src","sourcesContent":["const MODE = 'STAGE' // STAGE\nconst DEVPORT = 7007\n\nconst ENVIRONMENTS = {\n    PROD:{        \n        ENDPOINT:'',\n        UPLOAD_ENDPOINT:''        \n    },\n    STAGE:{        \n        ENDPOINT: window.location.protocol+'//'+window.location.host,\n        UPLOAD_ENDPOINT: window.location.protocol+'//'+window.location.host+'/fileUpload'       \n    },\n    DEV:{        \n        ENDPOINT:window.location.protocol+'//'+window.location.hostname+':'+DEVPORT,\n        UPLOAD_ENDPOINT:window.location.protocol+'//'+window.location.hostname+':'+DEVPORT+'/fileUpload'        \n    }\n}\n\nmodule.exports = {    \n    ENDPOINT: ENVIRONMENTS[MODE].ENDPOINT,\n    UPLOAD_ENDPOINT: ENVIRONMENTS[MODE].UPLOAD_ENDPOINT\n}","import { ENDPOINT } from './config'\n\nexport const LOADER_ELEM_ID = 'loader'\n\nexport const startLoader = (loaderId, loadingMessage) => {    \n    const loaderElement = document.getElementById(loaderId)    \n    loaderElement.nextElementSibling.textContent = loadingMessage\n    loaderElement.classList.add(loaderId)\n}\n\nexport const cancelLoader = (loaderId) => {\n    const loaderElement = document.getElementById(loaderId)\n    loaderElement.classList.remove(loaderId)\n    loaderElement.nextElementSibling.textContent = ''\n}\n\nexport const callJsonApi = async (apimethod, rqstmethod, body) => {\n    const request = {\n        method: rqstmethod || 'GET',\n        headers: {\n            'Content-Type': 'application/json',\n            'Accept': 'application/json',\n        }\n    }\n    if(body){\n        request.body = JSON.stringify(body)\n    }\n    try {\n        startLoader(LOADER_ELEM_ID, 'Loading...')\n        const sendRqst = await fetch(ENDPOINT + apimethod, request)\n        cancelLoader(LOADER_ELEM_ID)\n        const respToJson = await sendRqst.json()\n        if (respToJson && !respToJson.error) {\n            returnÂ respToJson\n        } else {\n            return (respToJson?.error || 'An error occurred')\n        }\n    } catch (error) {\n        cancelLoader(LOADER_ELEM_ID)\n        return(error)\n    }\n}\n\n/* https://stackoverflow.com/a/5166806 */\nexport const looksLikeMail = (str) => {\n    const lastAtPos = str.lastIndexOf('@')\n    const lastDotPos = str.lastIndexOf('.')\n    return (lastAtPos < lastDotPos && lastAtPos > 0 && str.indexOf('@@') == -1 && lastDotPos > 2 && (str.length - lastDotPos) > 2)\n}","import { getRecentCompositions, getMyCompositions, getAllCompositions } from './home'\n\nexport const breadcrumbHandler = (isauth) => {\n    createBreadCrumbNavBar(isauth)   \n    document.querySelectorAll('.breadcrumb-item a').forEach(function (element) {\n        element.addEventListener('click', function (event) {\n            event.preventDefault()\n            document.querySelector('.active-breadcrumb')?.classList.remove('active-breadcrumb')            \n            event.currentTarget.classList.add('active-breadcrumb')\n            let section = event.currentTarget.getAttribute('data-section')\n            navigate(section)\n        })\n    })\n}\n\nconst createBreadCrumbNavBar = (isauth) => {\n    const navBar = document.getElementById('breadcrumbnavbar')\n    let userOptions = ''\n    if(isauth.ok){\n        userOptions = `<li class='breadcrumb-item active-breadcrumb' aria-current='page'><a href='#' data-section='my-comp'>My Music</a></li>\n        <li class='breadcrumb-item'><a href='#' data-section='all-comp'>All</a></li>`\n    } else {\n        userOptions = `<li class='breadcrumb-item active-breadcrumb' aria-current='page'><a href='#' data-section='recent-comp'>Recent</a></li>\n        <li class='breadcrumb-item'><a href='#' data-section='all-comp'>All</a></li>`\n    }\n    navBar.innerHTML = userOptions    \n}\n\nfunction navigate(section) { \n    \n    switch (section) {\n        case 'recent-comp':           \n            getRecentCompositions()   \n            break\n        case 'my-comp':            \n            getMyCompositions()\n            break\n        case 'all-comp':\n            document.getElementById('initialmessage').classList.remove('d-flex')\n            document.getElementById('initialmessage').hidden = true\n            getAllCompositions()\n            break\n        default:\n            console.log('section default')\n    }\n}","import { LOADER_ELEM_ID, cancelLoader, callJsonApi } from './utils'\n\nexport const checkIfTermsAccepted = (userprofile, callback) => {\n    cancelLoader(LOADER_ELEM_ID)\n    callback(userprofile?.terms_accepted)\n}\n\nexport const handleTermsNotAccepted = () => {\n\n    $('#acceptTermsModal').modal({\n        backdrop: 'static',\n        keyboard: false  // to prevent closing with Esc button (if you want this too)\n    })\n    $('#acceptTermsModal').modal('show')\n    document.getElementById('buttonAcceptTerms').onclick = rqstAcceptTerms\n    document.getElementById('buttonRejectTerms').onclick = rqstRejectTerms\n}\n\nconst rqstAcceptTerms = async () => {\n    const data = await callJsonApi('/acceptterms', 'PUT')\n    if (data.ok) {\n        $('#acceptTermsModal').modal('hide')\n    }\n}\nconst rqstRejectTerms = async () => {\n    const data = await callJsonApi('/rejectterms', 'PUT')\n    if (data.ok) {\n        $('#acceptTermsModal').modal('hide')\n        window.location.href = window.location.origin\n    }\n}\n\nexport const generateAcceptTermsModal = (attachToElem) => {\n\n    const isModal = document.getElementById('acceptTermsModal')\n\n    if (!isModal) {\n        const modalDialog = `<div class=\"modal fade\" id=\"acceptTermsModal\" tabindex=\"-1\" role=\"dialog\">\n            <div class=\"modal-dialog\" role=\"document\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Accept Terms</h5>                \n                </div>\n                <div class=\"modal-body\">\n                <p>By clicking on OK you accept the Terms of Use.</p>\n                <p>More information at: <span> <a href=\"${window.location.origin}/static/terms.html\" target=\"_blank\">${window.location.origin}/static/terms.html</a></span></p>\n                </div>\n                <div class=\"modal-footer\">\n                <button id=\"buttonRejectTerms\" type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Reject</button>\n                <button id=\"buttonAcceptTerms\" type=\"button\" class=\"btn btn-primary\">OK</button>\n                </div>\n            </div>\n            </div>\n        </div>`\n        document.getElementsByTagName(attachToElem)[0].insertAdjacentHTML('afterend', modalDialog)\n    }\n    handleTermsNotAccepted()\n}","import COMPOSITION_COVER from '../../../common/img/agp.png'\r\nimport { callJsonApi } from '../../../common/js/utils'\r\nimport {breadcrumbHandler} from './breadcrumbhandler'\r\nimport {checkIfTermsAccepted, generateAcceptTermsModal} from '../../../common/js/acceptterms'\r\n\r\nexport let uriCompositionPage = '/composition.html?compositionId='\r\nlet uriProfilePage = window.location.origin\r\n\r\n\r\ndocument.getElementById('userlogin').innerHTML = `<li class='nav-item'>\r\n  <a class='dropdown-item' href='${window.location.origin}/login.html'>Register / Login</a>\r\n  </li>\r\n  <li class='nav-item'>\r\n    <a class='dropdown-item' href='${uriCompositionPage}demopage'>Test DAW</a>\r\n  </li>`\r\ndocument.getElementById('useroptions').innerHTML = `<li class='nav-item'>\r\n      <a class='nav-link' href='${uriProfilePage + '/profile.html'}'>Profile <i id='display_profile_name'></i></a>\r\n    </li>\r\n    <li class='nav-item'>\r\n          <a class='nav-link' href='#' id='createNewButton' data-toggle='modal' data-target='#newMusicModal'>/ Create new</a>\r\n    </li>\r\n    <li class='nav-item'>\r\n        <a class='nav-link' href='#' id='openMyCollectionsButton' data-toggle='modal' data-target='#editCollectionsModal'>/ My Collections</a>\r\n    </li>`\r\n\r\n\r\nconst homePageTermsAccepted = (termsAccepted) => {    \r\n    if(!termsAccepted){\r\n        generateAcceptTermsModal('header')\r\n    } \r\n}\r\nconst getMyProfile = async (doAfterIfLogged, doAfterIfNotLogged) => {\r\n  \r\n  const isAuthenticated = await callJsonApi('/profile', 'GET')\r\n  if (isAuthenticated.ok) {\r\n    document.getElementById('userlogin').style.display = 'none'\r\n    document.getElementById('useroptions').style.display = ''\r\n    document.getElementById('display_profile_name').innerText = `[${isAuthenticated.name}]`    \r\n    checkIfTermsAccepted(isAuthenticated, homePageTermsAccepted)\r\n    await doAfterIfLogged(isAuthenticated)\r\n  } else {\r\n    await doAfterIfNotLogged(isAuthenticated)\r\n  }\r\n  return isAuthenticated\r\n}\r\n\r\nexport const getMyCompositions = async () => {\r\n  const data = await callJsonApi('/mycompositions', 'GET')\r\n  if(data.compositions){\r\n    return renderHomePage(data.compositions)\r\n  } else {\r\n    alert('invalid return value for compisitions list')\r\n  }  \r\n}\r\nexport const getRecentCompositions = async () => {\r\n  const data = await callJsonApi('/recentcompositions', 'GET')\r\n  if(data.compositions){\r\n    return renderHomePage(data.compositions)\r\n  } else {\r\n    alert('invalid return value for compisitions list')\r\n  }\r\n}\r\n\r\nexport const getAllCompositions = async () => {\r\n  const data = await callJsonApi('/compositions', 'GET')\r\n  if(data.compositions){\r\n    return renderHomePage(data.compositions)\r\n  } else {\r\n    alert('invalid return value for compisitions list')\r\n  }\r\n}\r\n\r\nconst renderHomePage = (compositionsList) => {\r\n\r\n  document.getElementById('loadertext').textContent = ''\r\n  document.getElementById('grid').innerHTML = ''\r\n  paintListOfCompositions(compositionsList)\r\n\r\n}\r\n\r\nconst paintListOfCompositions = (compositionsList) => {\r\n  \r\n  if(!compositionsList.length){\r\n    document.getElementById('initialmessage').hidden = false\r\n    document.getElementById('initialmessage').classList.add('d-flex')\r\n  } else {\r\n    let listElelemts = ''\r\n    compositionsList.forEach((element) => {\r\n      if (element) {\r\n        let collection = ''\r\n        if (element.collection) {\r\n          collection = `<a href='./index.html?collection=${element.collection}' class='card-link green'>${element.collection}</a>`\r\n        }\r\n        const template = `\r\n          <div class='grid-div'>\r\n            <div class='card'>\r\n              ${element.opentocontrib ? '<span class=\"badge badge-info\">OPEN TO CONTRIB</span>' : ''}\r\n              <a href='${uriCompositionPage + element.uuid}'>\r\n                <img src='${element.photo_url || COMPOSITION_COVER}' alt='Card image cap' class='card-img'>\r\n              </a>\r\n              <div class='card-container'>\r\n                <a href='${uriCompositionPage + element.uuid}' class='card-link blue'>${element.title}</a>\r\n                <p>${collection}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        `\r\n        listElelemts += template\r\n      }\r\n    })\r\n    document.getElementById('grid').innerHTML = ''\r\n    document.getElementById('grid').insertAdjacentHTML('afterbegin', listElelemts)\r\n    document.getElementById('searchInput').removeAttribute('disabled')\r\n  }  \r\n}\r\n\r\nconst initHomPage = async () => {\r\n  const isAuth  = await getMyProfile(getMyCompositions,getRecentCompositions)  \r\n  breadcrumbHandler(isAuth)\r\n}\r\n\r\ninitHomPage()","\nimport { ENDPOINT } from './config'\n\nexport const getCollections = async () => {\n   \n    const response = await fetch(ENDPOINT + '/mycollections') \n    let result = null            \n    if(response?.ok){ \n        const respJson = await response.json()\n        result = respJson\n    }\n    return result\n}\n\nexport const getCollectionsError = () => {\n    alert(`Problem getting collections`)\n}\n\nexport const createListCollections = (collections,listId, coll_id) => {\n    const theList = collections.all_collections\n    const listCollContainer  = document.getElementById(listId)\n    let listOptions = `<option value='0'>...</option>`\n    let selected = null\n    theList.forEach((element) => {\n        if (element) {\n            if(element.uuid === coll_id){\n                selected = 'selected>'\n            } else {\n                selected = null\n            }\n            const template = `<option value='${element.uuid}' ${selected?selected:'>'}${element.title}</option>`\n            listOptions += template\n        }\n    })\n    const listElelemts = `<select class='custom-select' id='inputGroupSelectCollect'>${listOptions}</select>`   \n    listCollContainer.insertAdjacentHTML('afterbegin', listElelemts)\n}","import { ENDPOINT } from '../../../common/js/config'\nimport {uriCompositionPage} from './home'\n\nlet EDIT_STATUS = false\n\nconst showAllCollButton = document.getElementById('openMyCollectionsButton')\nconst editButton = document.getElementById('editmycollectionsbutton')\n\nconst fetchCollectionsTree = async () => {\n    const response = await fetch('/mycollectionsastree')\n    const data = await response.json()\n    return data\n}\n\nconst createTreeHTML = (item) => {\n    let html = `\n        <span id='removeCollIcon${item.uuid}' data-uuid='${item.uuid}' data-title='${item.title}' role='button' class='badge badge-pill badge-danger' hidden>-</span>\n        <li id='${item.uuid}' class='list-group-item border-bottom-0 border-right-0 border-top-0 border-warning'>\n            <input type='text' class='form-control border-secondary' id='treecolltitleinput${item.uuid}' data-uuid='${item.uuid}' placeholder='Type a new title'\n            title='collectiontitle' value='${item.title}' disabled>\n        </li>`\n    \n    if (item.compositions.length > 0 || item.collections.length > 0) {\n        html += '<ul>'\n        for (const composition of item.compositions) {\n            html += `<li class='list-group-item border-0'><a href='${uriCompositionPage + composition.uuid}'><u>${composition.title}</u></a></li>`\n        }\n        for (const collection of item.collections) {\n            html += createTreeHTML(collection)\n        }\n        html += '</ul>'\n    }    \n    return html\n}\n\nconst renderTree = async () => {\n    const treeContainer = document.getElementById('listCollContainerAllColl')\n    const data = await fetchCollectionsTree()\n    let html = '<ul>'\n    for (const collection of data) {\n        html += createTreeHTML(collection)\n    }\n    html += '</ul>'\n    treeContainer.innerHTML = html\n}\n\nconst clickEditButtonHandler = () => {\n    \n    if(EDIT_STATUS){\n        EDIT_STATUS = false        \n        editButton.innerText =  'Edit'\n        disableEdition()\n    } else {\n        EDIT_STATUS = true\n        editButton.innerText =  'Done'\n        enableEdition()\n    }   \n}\n\nconst enableEdition = () => {\n    \n    const elementsWithHiddenAttribute = document.querySelectorAll(`[id*='removeCollIcon']`)\n\n    elementsWithHiddenAttribute.forEach(element => {\n        element.removeAttribute('hidden')        \n        removeCollectionClickhHandler(element.getAttribute('data-uuid'), element.getAttribute('data-title'))\n    })   \n    \n    const elementsWithDisabledAttribute = document.querySelectorAll(`[id*='treecolltitleinput']`)\n\n    elementsWithDisabledAttribute.forEach(element => {\n        element.removeAttribute('disabled')\n        updateInputTextEventHandler(element.getAttribute('data-uuid'), element.value)\n    })\n}\n\nconst disableEdition = () => {\n\n    const elementsWithHiddenAttribute = document.querySelectorAll(`[id*='removeCollIcon']`)\n\n    elementsWithHiddenAttribute.forEach(element => {\n        element.setAttribute('hidden', 'true')\n    })\n\n    const elementsWithDisabledAttribute = document.querySelectorAll(`[id*='treecolltitleinput']`)    \n\n    elementsWithDisabledAttribute.forEach(element => {\n        element.setAttribute('disabled', 'true')\n    })\n}\n\nconst clickAllCollButtonHandler = async () => {\n    EDIT_STATUS = false\n    editButton.innerText =  'Edit'\n    await renderTree()\n    editButton.addEventListener('click', clickEditButtonHandler, false)\n}\n\nshowAllCollButton?.addEventListener('click', clickAllCollButtonHandler, false)\n\nconst confirmDeleteCollectionModal = async (event, collectionId, collectionTitle) => {\n\n    const chk = event.target\n\n    if (chk.tagName === 'SPAN') {\n\n        if (confirm(`Are you sure you want remove the collection ${collectionTitle} and all of its content?`) == true) {\n\n            const response = await fetch(ENDPOINT + '/deletecollection/' + collectionId, { method: 'DELETE' })\n            if (response?.ok) {\n                document.getElementById('removeCollIcon'+collectionId).remove()\n                const listElemToDelete = document.getElementById(collectionId)\n                if(listElemToDelete?.nextSibling?.tagName === 'UL'){\n                    listElemToDelete.nextSibling.remove()\n                }\n                listElemToDelete.remove()\n            }\n\n        } else {\n            event.target.checked = false\n        }\n    }\n}\n\nconst removeCollectionClickhHandler = (collectionId, collectionTitle) => {\n    document.getElementById('removeCollIcon' + collectionId).onclick= async (event) => {\n        await confirmDeleteCollectionModal(event, collectionId, collectionTitle)\n    }\n}\n\nconst updateInputTextEventHandler = (collectionId, currentTitle) => {    \n    document.getElementById('treecolltitleinput'+collectionId).onblur = (event) => {\n        handleInputBlur(event, collectionId, currentTitle)\n    }    \n}\n\nconst updateCollectionTitleRqst = (value, uuid) => {\n   \n    const updateTitleApi = ENDPOINT + '/updatecolltitle'\n    const data = { title: value, uuid: uuid }\n    \n    fetch(updateTitleApi, {\n        method: 'PATCH', \n        headers: {\n        'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n    })\n    .then()\n    .catch(error => {\n        console.error('Error updating value:', error)\n    })\n}\n\nconst handleInputBlur = (event, collId, currTitle) => {    \n    const newValue = event.target.value\n    if(currTitle !== newValue){\n        if (!newValue || newValue === '') {\n            event.target.value = currTitle\n            alert('Introduce a valid title, please')\n            return\n        } else {\n            updateCollectionTitleRqst(newValue, collId)\n        }\n    }\n}","\nimport { ENDPOINT } from '../../../common/js/config'\nimport {uriCompositionPage} from './home'\nimport {getCollections, getCollectionsError, createListCollections } from '../../../common/js/collectionshandler.js'\nimport './editcollections'\n\nconst createNewButton  = document.getElementById('createNewButton')\nconst createNewButtonAtHome  = document.getElementById('createNewButtonAtHome')\n\nconst clickNewButtonHandler = () => {\n  document.getElementById('newtitle').value = ''\n  document.getElementById('newdescription').value = ''\n  const saveCompositionButton = document.getElementById('newcreation')\n  saveEventListener(saveCompositionButton)\n  getCollections().then( result => {\n      if(result){\n          getCompCollSuccess(result)\n      } else {\n          getCollectionsError()\n      }\n  })\n}\n\ncreateNewButton?.addEventListener('click', clickNewButtonHandler, false)\ncreateNewButtonAtHome?.addEventListener('click', clickNewButtonHandler, false)\n\nconst getCompCollSuccess = (list) => {\n  document.getElementById('listCollContainer').replaceChildren()                                   \n  createListCollections(list, 'listCollContainer')\n}\n\nconst saveEventListener = (saveCompositionButton) =>{\n  saveCompositionButton?.addEventListener('click', saveEventListenerHandler)\n}\n\nconst saveEventListenerHandler = (e) => {\n  const newCreation = document.getElementById('typeOfNewCreation').value\n  let apiMethod = '/newcomposition'\n  if(newCreation === 'coll'){\n    apiMethod = '/newcollection'\n  }\n  let newtitle = document.getElementById('newtitle').value\n  const privacyLevel = document.querySelector('input[name=\"newMusicPrivacyRadios\"]:checked').value\n  if (!newtitle) {\n    alert('Introduce a valid title, please')\n    return\n  }\n\n  const newdescription = document.getElementById('newdescription').value  \n  const collectInput = document.getElementById('inputGroupSelectCollect')\n  let parentCollection = collectInput?.value || null\n  if(parentCollection === '0'){\n      parentCollection = null\n  }\n\n  let body = JSON.stringify({\n    title: newtitle,\n    privacy_level: privacyLevel,\n    parent_uuid: parentCollection,\n    description: newdescription\n  })\n\n  let errorIs = null\n\n  fetch(ENDPOINT + apiMethod, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Accept': 'application/json',\n    },\n    body: body\n  })\n    .then((r) => {\n      if (!r.ok) {\n        errorIs = r.statusText\n      }\n      return r.json()\n    })\n    .then(data => {\n      if (data) {\n        verifyResponse(data)\n      } else {\n        throw new Error(data)\n      }\n    }).catch((error) => {\n      errorIs = error\n    })\n}\n\nconst verifyResponse = (response)=> {  \n  if(response.composition){\n    window.location.href = uriCompositionPage + response.composition.uuid  \n  } else {\n    $('#newMusicModal').modal('hide')\n    //document.getElementById('openMyCollectionsButton').click()    \n  }\n}","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] â¨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] ð¨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">ð¨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}