!function(){function e(e,n,o,t){Object.defineProperty(e,n,{get:o,set:t,enumerable:!0,configurable:!0})}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},t={},i=n.parcelRequire1e7e;null==i&&((i=function(e){if(e in o)return o[e].exports;if(e in t){var n=t[e];delete t[e];var i={id:e,exports:{}};return o[e]=i,n.call(i.exports,i,i.exports),i.exports}var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,n){t[e]=n},n.parcelRequire1e7e=i);var l=i.register;l("7hG31",function(n,o){e(n.exports,"uriUserPage",function(){return l}),e(n.exports,"uriCollectionPage",function(){return r}),e(n.exports,"UserRole",function(){return d}),e(n.exports,"LevelPrivacy",function(){return a}),e(n.exports,"PRIVACY_BADGE_STYLE",function(){return c}),e(n.exports,"PRIVACY_BADGE_TEXT",function(){return u}),e(n.exports,"startLoader",function(){return s}),e(n.exports,"cancelLoader",function(){return f}),e(n.exports,"callJsonApi",function(){return m}),e(n.exports,"looksLikeMail",function(){return p}),e(n.exports,"activateGoHomeLink",function(){return g}),e(n.exports,"MEDIA_CONSTRAINTS",function(){return E});var t=i("72lX3");let l="/index.html?userid=",r="/index.html?collectionid=",d=Object.freeze({none:0,owner:1,admin:2,member:3,guest:4}),a=Object.freeze({public:1,onlyreg:2,private:3}),c={[a.public]:"badge-public",[a.onlyreg]:"badge-onlyreg",[a.private]:"badge-private"},u={[a.public]:"PUBLIC",[a.onlyreg]:"REG USERS",[a.private]:"PRIVATE"},s=e=>{let n=document.getElementById("loader");n.innerHTML=`<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;${e}`,n.classList.remove("loader-hidden")},f=()=>{document.getElementById("loader").classList.add("loader-hidden")},m=async(e,n,o,i)=>{let l={method:n||"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}};o&&(l.body=JSON.stringify(o));try{i&&s(i);let n=await fetch(t.ENDPOINT+e,l);i&&f();let o=await n.json();if(o&&!o.error)return o;return(null==o?void 0:o.error)||"An error occurred"}catch(e){return i&&f(),e}},p=e=>{let n=e.lastIndexOf("@"),o=e.lastIndexOf(".");return n<o&&n>0&&-1==e.indexOf("@@")&&o>2&&e.length-o>2},g=()=>{let e=document.getElementById("goHome");"localhost:80"===window.location.host||"http://localhost"===window.location.origin?e.href=window.location.origin+"/index.html":e.href=window.location.origin};/^((?!chrome|android).)*safari/i.test(navigator.userAgent);let E={audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,latency:0,channelCount:1}}}),l("72lX3",function(n,o){e(n.exports,"ENDPOINT",function(){return i}),e(n.exports,"UPLOAD_ENDPOINT",function(){return l});let t={PROD:{ENDPOINT:"https://hiaudio.fr",UPLOAD_ENDPOINT:"https://hiaudio.fr/fileUpload"},STAGE:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"},DEV:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"}},i=t.DEV.ENDPOINT,l=t.DEV.UPLOAD_ENDPOINT});var r=i("7hG31");let d=null,a=document.getElementById("sendcodebutton"),c=async()=>{(await (0,r.callJsonApi)("/profile","GET",null,"Loading user...")).ok&&(window.location.href=window.location.origin+"/profile.html")},u=async()=>{let e=document.getElementById("inputloginemail").value;if((0,r.looksLikeMail)(e)){a.disabled=!0;let n=await (0,r.callJsonApi)("/generatelogincode/"+e,"PUT",null,"Sending code...");a.disabled=!1,n.ok?(d=e,document.getElementById("authmethodform").hidden=!0,document.getElementById("validationcodefield").hidden=!1):(document.getElementById("inputloginemail").classList.add("is-invalid"),document.getElementById("validationEmailResult").innerText=n)}else document.getElementById("inputloginemail").classList.add("is-invalid"),document.getElementById("validationEmailResult").innerText="Sorry, invalid email address format."},s=async()=>{let e=document.getElementById("verificationCode").value;if(/\d{6}/.test(e)){let n={email:d,code:e};(await (0,r.callJsonApi)("/logincodevalidation","POST",n,"Verification in process...")).ok?(d=null,window.location.href=window.location.origin):(document.getElementById("verificationCode").classList.add("is-invalid"),document.getElementById("validationCodeResult").innerText="Wrong code, sorry")}else document.getElementById("verificationCode").classList.add("is-invalid"),document.getElementById("validationCodeResult").innerText="Sorry, invalid code format."};(0,r.activateGoHomeLink)(),document.getElementById("googleLoginButton").onclick=()=>{window.location.href="/googlelogin"},a.onclick=u,document.getElementById("inputloginemail").onkeydown=function(e){if("Enter"==e.key)return u()},document.getElementById("validatecodebutton").onclick=s,document.getElementById("verificationCode").onkeydown=function(e){if("Enter"==e.key)return s()},c()}();
//# sourceMappingURL=login.087ce1b8.js.map
