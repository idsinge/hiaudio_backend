parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"bt5Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateTable=exports.openDB=exports.getTracksByCompId=exports.DB=void 0;var e=null;exports.DB=e;var r=function(r){return new Promise(function(o,t){var n=indexedDB.open(r,2);n.onerror=function(e){console.log(e),t(new Error("Error opening database"))},n.onsuccess=function(r){var t=r.target.result;exports.DB=e=t,o(t)},n.onupgradeneeded=function(r){var t=r.target.result;exports.DB=e=t;var n=t.createObjectStore("tracks",{keyPath:"track_id"});n.createIndex("composition_id","composition_id",{unique:!1}),n.transaction.oncomplete=function(e){o(t)}}})};exports.openDB=r;var o=function(e,r){if(e)return new Promise(function(o,t){var n=e.transaction(["tracks"],"readwrite");n.oncomplete=function(e){o()},n.onerror=function(e){console.log("error",e),t(new Error("Error updating database"))},n.objectStore("tracks").put(r)})};exports.updateTable=o;var t=function(e,r){return new Promise(function(o,t){e&&r||t(new Error("No DB or Comp ID"));var n=[],a=e.transaction("tracks").objectStore("tracks").index("composition_id"),s=IDBKeyRange.only(r);a.openCursor(s).onsuccess=function(e){var r=e.target.result;r?(n.push(r.value),r.continue()):o(n)}})};exports.getTracksByCompId=t;
},{}],"FyYm":[function(require,module,exports) {
var o="STAGE",N=7007,i={PROD:{ENDPOINT:"",UPLOAD_ENDPOINT:""},STAGE:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"},DEV:{ENDPOINT:window.location.protocol+"//"+window.location.hostname+":"+N,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.hostname+":"+N+"/fileUpload"}};module.exports={ENDPOINT:i[o].ENDPOINT,UPLOAD_ENDPOINT:i[o].UPLOAD_ENDPOINT};
},{}],"osPO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.uriUserPage=exports.uriCollectionPage=exports.startLoader=exports.looksLikeMail=exports.isSafari=exports.cancelLoader=exports.callJsonApi=exports.activateGoHomeLink=exports.UserRole=exports.PRIVACY_BADGE_TEXT=exports.PRIVACY_BADGE_STYLE=exports.LevelPrivacy=exports.LOADER_ELEM_ID=void 0;var t,e,r=require("./config");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(){o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(k){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),c=new S(n||[]);return i(a,"_invoke",{value:E(t,r,c)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(k){return{type:"throw",arg:k}}}t.wrap=f;var h={};function v(){}function d(){}function y(){}var g={};s(g,c,function(){return this});var m=Object.getPrototypeOf,x=m&&m(m(j([])));x&&x!==e&&r.call(x,c)&&(g=x);var b=y.prototype=v.prototype=Object.create(g);function w(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function L(t,e){var o;i(this,"_invoke",{value:function(i,a){function c(){return new e(function(o,c){!function o(i,a,c,u){var l=p(t[i],t,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==n(f)&&r.call(f,"__await")?e.resolve(f.__await).then(function(t){o("next",t,c,u)},function(t){o("throw",t,c,u)}):e.resolve(f).then(function(t){s.value=t,c(s)},function(t){return o("throw",t,c,u)})}u(l.arg)}(i,a,o,c)})}return o=o?o.then(c,c):c()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return A()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=_(a,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=p(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=p(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function j(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:A}}function A(){return{value:void 0,done:!0}}return d.prototype=y,i(b,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:d,configurable:!0}),d.displayName=s(y,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,s(t,l,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},w(L.prototype),s(L.prototype,u,function(){return this}),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},w(b),s(b,l,"Generator"),s(b,c,function(){return this}),s(b,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function i(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(l){return void r(l)}c.done?e(u):Promise.resolve(u).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function c(t){i(a,n,o,c,u,"next",t)}function u(t){i(a,n,o,c,u,"throw",t)}c(void 0)})}}function c(t,e,r){return(e=u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u(t){var e=l(t,"string");return"symbol"===n(e)?e:String(e)}function l(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var s="loader";exports.LOADER_ELEM_ID=s;var f="/index.html?userid=";exports.uriUserPage=f;var p="/index.html?collectionid=";exports.uriCollectionPage=p;var h=Object.freeze({none:0,owner:1,admin:2,member:3,guest:4});exports.UserRole=h;var v=Object.freeze({public:1,onlyreg:2,private:3});exports.LevelPrivacy=v;var d=(c(t={},v.public,"badge-public"),c(t,v.onlyreg,"badge-onlyreg"),c(t,v.private,"badge-private"),t);exports.PRIVACY_BADGE_STYLE=d;var y=(c(e={},v.public,"PUBLIC"),c(e,v.onlyreg,"REG USERS"),c(e,v.private,"PRIVATE"),e);exports.PRIVACY_BADGE_TEXT=y;var g=function(t,e){var r=document.getElementById(t);r.nextElementSibling.textContent=e,r.classList.add(t)};exports.startLoader=g;var m=function(t){var e=document.getElementById(t);e.classList.remove(t),e.nextElementSibling.textContent=""};exports.cancelLoader=m;var x=function(){var t=a(o().mark(function t(e,n,i){var a,c,u;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={method:n||"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}},i&&(a.body=JSON.stringify(i)),t.prev=2,g(s,"Loading..."),t.next=6,fetch(r.ENDPOINT+e,a);case 6:return c=t.sent,m(s),t.next=10,c.json();case 10:if(!(u=t.sent)||u.error){t.next=15;break}return t.abrupt("return",u);case 15:return t.abrupt("return",(null==u?void 0:u.error)||"An error occurred");case 16:t.next=22;break;case 18:return t.prev=18,t.t0=t.catch(2),m(s),t.abrupt("return",t.t0);case 22:case"end":return t.stop()}},t,null,[[2,18]])}));return function(e,r,n){return t.apply(this,arguments)}}();exports.callJsonApi=x;var b=function(t){var e=t.lastIndexOf("@"),r=t.lastIndexOf(".");return e<r&&e>0&&-1==t.indexOf("@@")&&r>2&&t.length-r>2};exports.looksLikeMail=b;var w=function(){var t=document.getElementById("goHome");"localhost:80"===window.location.host||"http://localhost"===window.location.origin?t.href=window.location.origin+"/index.html":t.href=window.location.origin};exports.activateGoHomeLink=w;var L=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);exports.isSafari=L;
},{"./config":"FyYm"}],"EYak":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCollectionsError=exports.getCollections=exports.createListCollections=void 0;var t=require("./config");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(){r=function(){return t};var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(N){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),c=new S(n||[]);return i(a,"_invoke",{value:E(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(N){return{type:"throw",arg:N}}}t.wrap=f;var p={};function v(){}function y(){}function d(){}var g={};s(g,c,function(){return this});var m=Object.getPrototypeOf,w=m&&m(m(P([])));w&&w!==n&&o.call(w,c)&&(g=w);var x=d.prototype=v.prototype=Object.create(g);function b(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function L(t,r){var n;i(this,"_invoke",{value:function(i,a){function c(){return new r(function(n,c){!function n(i,a,c,u){var l=h(t[i],t,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==e(f)&&o.call(f,"__await")?r.resolve(f.__await).then(function(t){n("next",t,c,u)},function(t){n("throw",t,c,u)}):r.resolve(f).then(function(t){s.value=t,c(s)},function(t){return n("throw",t,c,u)})}u(l.arg)}(i,a,n,c)})}return n=n?n.then(c,c):c()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return k()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=_(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function P(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return y.prototype=d,i(x,"constructor",{value:d,configurable:!0}),i(d,"constructor",{value:y,configurable:!0}),y.displayName=s(d,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},b(L.prototype),s(L.prototype,u,function(){return this}),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},b(x),s(x,l,"Generator"),s(x,c,function(){return this}),s(x,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function n(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(l){return void r(l)}c.done?e(u):Promise.resolve(u).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise(function(o,i){var a=t.apply(e,r);function c(t){n(a,o,i,c,u,"next",t)}function u(t){n(a,o,i,c,u,"throw",t)}c(void 0)})}}var i=function(){var e=o(r().mark(function e(){var n,o,i;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t.ENDPOINT+"/mycollections");case 2:if(n=e.sent,o=null,null==n||!n.ok){e.next=9;break}return e.next=7,n.json();case 7:i=e.sent,o=i;case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();exports.getCollections=i;var a=function(){alert("Problem getting collections")};exports.getCollectionsError=a;var c=function(t,e,r){var n=t.all_collections,o=document.getElementById(e),i="<option value='0'>...</option>",a=null;n.forEach(function(t){if(t){a=t.uuid===r?"selected>":null;var e="<option value='".concat(t.uuid,"' ").concat(a||">").concat(t.title,"</option>");i+=e}});var c="<select class='custom-select' id='inputGroupSelectCollect'>".concat(i,"</select>");o.insertAdjacentHTML("afterbegin",c)};exports.createListCollections=c;
},{"./config":"FyYm"}],"vpSD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.saveParentCollection=exports.openSettingsButtonHandler=void 0;var t=require("../settings"),e=require("../../../../common/js/collectionshandler.js");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(){n=function(){return t};var t={},e=Object.prototype,o=e.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(P){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),c=new O(n||[]);return i(a,"_invoke",{value:E(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(P){return{type:"throw",arg:P}}}t.wrap=f;var p={};function v(){}function y(){}function d(){}var g={};s(g,c,function(){return this});var m=Object.getPrototypeOf,w=m&&m(m(k([])));w&&w!==e&&o.call(w,c)&&(g=w);var x=d.prototype=v.prototype=Object.create(g);function b(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function L(t,e){var n;i(this,"_invoke",{value:function(i,a){function c(){return new e(function(n,c){!function n(i,a,c,u){var l=h(t[i],t,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==r(f)&&o.call(f,"__await")?e.resolve(f.__await).then(function(t){n("next",t,c,u)},function(t){n("throw",t,c,u)}):e.resolve(f).then(function(t){s.value=t,c(s)},function(t){return n("throw",t,c,u)})}u(l.arg)}(i,a,n,c)})}return n=n?n.then(c,c):c()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return C()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=_(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function k(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:C}}function C(){return{value:void 0,done:!0}}return y.prototype=d,i(x,"constructor",{value:d,configurable:!0}),i(d,"constructor",{value:y,configurable:!0}),y.displayName=s(d,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},b(L.prototype),s(L.prototype,u,function(){return this}),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},b(x),s(x,l,"Generator"),s(x,c,function(){return this}),s(x,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function o(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(l){return void r(l)}c.done?e(u):Promise.resolve(u).then(n,o)}function i(t){return function(){var e=this,r=arguments;return new Promise(function(n,i){var a=t.apply(e,r);function c(t){o(a,n,i,c,u,"next",t)}function u(t){o(a,n,i,c,u,"throw",t)}c(void 0)})}}var a=null,c=function(t){(0,e.getCollections)().then(function(r){r?l(r,t):(0,e.getCollectionsError)()})},u=function(t){var e=document.getElementById("openSettingsButton");null==e||e.addEventListener("click",function(){c(t)},!1)};exports.openSettingsButtonHandler=u;var l=function(t,r){document.getElementById("listCollContainerNewColl").replaceChildren(),(0,e.createListCollections)(t,"listCollContainerNewColl",a||r),null!=t&&t.all_collections.length&&r&&(a=r)},s=function(){var t=i(n().mark(function t(e){var r;return n().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=document.getElementById("inputGroupSelectCollect").value,!a&&"0"===r){t.next=5;break}if(r===a){t.next=5;break}return t.next=5,f(e,r);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();exports.saveParentCollection=s;var f=function(){var e=i(n().mark(function e(r,o){var i,c;return n().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={uuid:r,collection_id:"0"===o?null:o},e.next=3,(0,t.updateSettings)("PATCH","/updatecompcollection",i);case 3:null!=(c=e.sent)&&c.ok&&(a=o);case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}();
},{"../settings":"iDjH","../../../../common/js/collectionshandler.js":"EYak"}],"dF8V":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setUITitle=exports.saveTitle=exports.getCurrentTitle=void 0;var t=require("../settings");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(){r=function(){return t};var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(P){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),u=new S(n||[]);return i(a,"_invoke",{value:E(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(P){return{type:"throw",arg:P}}}t.wrap=s;var p={};function v(){}function y(){}function d(){}var g={};f(g,u,function(){return this});var m=Object.getPrototypeOf,w=m&&m(m(T([])));w&&w!==n&&o.call(w,u)&&(g=w);var x=d.prototype=v.prototype=Object.create(g);function b(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function L(t,r){var n;i(this,"_invoke",{value:function(i,a){function u(){return new r(function(n,u){!function n(i,a,u,c){var l=h(t[i],t,a);if("throw"!==l.type){var f=l.arg,s=f.value;return s&&"object"==e(s)&&o.call(s,"__await")?r.resolve(s.__await).then(function(t){n("next",t,u,c)},function(t){n("throw",t,u,c)}):r.resolve(s).then(function(t){f.value=t,u(f)},function(t){return n("throw",t,u,c)})}c(l.arg)}(i,a,n,u)})}return n=n?n.then(u,u):u()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return k()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=_(a,r);if(u){if(u===p)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(t){if(t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return y.prototype=d,i(x,"constructor",{value:d,configurable:!0}),i(d,"constructor",{value:y,configurable:!0}),y.displayName=f(d,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,f(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},b(L.prototype),f(L.prototype,c,function(){return this}),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},b(x),f(x,l,"Generator"),f(x,u,function(){return this}),f(x,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(l){return void r(l)}u.done?e(c):Promise.resolve(c).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise(function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,c,"next",t)}function c(t){n(a,o,i,u,c,"throw",t)}u(void 0)})}}var i=null,a=function(){return i};exports.getCurrentTitle=a;var u=function(t){i=t,document.getElementById("newtitle").value=t};exports.setUITitle=u;var c=function(){var t=o(r().mark(function t(e){var n;return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((n=document.getElementById("newtitle").value)===i){t.next=4;break}return t.next=4,l(e,n);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();exports.saveTitle=c;var l=function(){var e=o(r().mark(function e(n,o){var a;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={uuid:n,title:o},e.next=3,(0,t.updateSettings)("PATCH","/updatecomptitle",a);case 3:e.sent.ok&&(i=o,document.getElementById("comp-title").innerHTML=o);case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}();
},{"../settings":"iDjH"}],"lCtB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setUIDescription=exports.saveDescription=exports.getCurrentDescription=void 0;var t=require("../settings");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e(){e=function(){return t};var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,r,e){t[r]=e.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function f(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{f({},"")}catch(G){f=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var o=r&&r.prototype instanceof v?r:v,a=Object.create(o.prototype),c=new S(n||[]);return i(a,"_invoke",{value:E(t,e,c)}),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(G){return{type:"throw",arg:G}}}t.wrap=l;var p={};function v(){}function y(){}function d(){}var g={};f(g,c,function(){return this});var m=Object.getPrototypeOf,w=m&&m(m(k([])));w&&w!==n&&o.call(w,c)&&(g=w);var x=d.prototype=v.prototype=Object.create(g);function b(t){["next","throw","return"].forEach(function(r){f(t,r,function(t){return this._invoke(r,t)})})}function L(t,e){var n;i(this,"_invoke",{value:function(i,a){function c(){return new e(function(n,c){!function n(i,a,c,u){var s=h(t[i],t,a);if("throw"!==s.type){var f=s.arg,l=f.value;return l&&"object"==r(l)&&o.call(l,"__await")?e.resolve(l.__await).then(function(t){n("next",t,c,u)},function(t){n("throw",t,c,u)}):e.resolve(l).then(function(t){f.value=t,c(f)},function(t){return n("throw",t,c,u)})}u(s.arg)}(i,a,n,c)})}return n=n?n.then(c,c):c()}})}function E(t,r,e){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return P()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var c=_(a,e);if(c){if(c===p)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if("suspendedStart"===n)throw n="completed",e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n="executing";var u=h(t,r,e);if("normal"===u.type){if(n=e.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n="completed",e.method="throw",e.arg=u.arg)}}}function _(t,r){var e=r.method,n=t.iterator[e];if(void 0===n)return r.delegate=null,"throw"===e&&t.iterator.return&&(r.method="return",r.arg=void 0,_(t,r),"throw"===r.method)||"return"!==e&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+e+"' method")),p;var o=h(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,p;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function O(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function j(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function k(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var e=-1,n=function r(){for(;++e<t.length;)if(o.call(t,e))return r.value=t[e],r.done=!1,r;return r.value=void 0,r.done=!0,r};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return y.prototype=d,i(x,"constructor",{value:d,configurable:!0}),i(d,"constructor",{value:y,configurable:!0}),y.displayName=f(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===y||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,f(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},b(L.prototype),f(L.prototype,u,function(){return this}),t.AsyncIterator=L,t.async=function(r,e,n,o,i){void 0===i&&(i=Promise);var a=new L(l(r,e,n,o),i);return t.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},b(x),f(x,s,"Generator"),f(x,c,function(){return this}),f(x,"toString",function(){return"[object Generator]"}),t.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function e(e,n){return a.type="throw",a.arg=t,r.next=e,n&&(r.method="next",r.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),j(e),p}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;j(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,e){return this.delegate={iterator:k(t),resultName:r,nextLoc:e},"next"===this.method&&(this.arg=void 0),p}},t}function n(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(s){return void e(s)}c.done?r(u):Promise.resolve(u).then(n,o)}function o(t){return function(){var r=this,e=arguments;return new Promise(function(o,i){var a=t.apply(r,e);function c(t){n(a,o,i,c,u,"next",t)}function u(t){n(a,o,i,c,u,"throw",t)}c(void 0)})}}var i=null,a=function(){return i};exports.getCurrentDescription=a;var c=function(t){i=t,document.getElementById("newdescription").value=t};exports.setUIDescription=c;var u=function(){var t=o(e().mark(function t(r){var n;return e().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((n=document.getElementById("newdescription").value)===i){t.next=4;break}return t.next=4,s(r,n);case 4:case"end":return t.stop()}},t)}));return function(r){return t.apply(this,arguments)}}();exports.saveDescription=u;var s=function(){var r=o(e().mark(function r(n,o){var a;return e().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a={uuid:n,description:o},r.next=3,(0,t.updateSettings)("PATCH","/updatecompdescription",a);case 3:r.sent.ok&&(i=o,document.getElementById("comp-description").innerHTML=o);case 5:case"end":return r.stop()}},r)}));return function(t,e){return r.apply(this,arguments)}}();
},{"../settings":"iDjH"}],"rZmd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setOpenToContrib=exports.saveOpenToContrib=exports.getOpenToContrib=exports.changeOpenToContrib=void 0;var t=require("../settings");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(){r=function(){return t};var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(P){f=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,a=Object.create(o.prototype),c=new _(n||[]);return i(a,"_invoke",{value:L(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(P){return{type:"throw",arg:P}}}t.wrap=l;var p={};function d(){}function v(){}function y(){}var g={};f(g,c,function(){return this});var m=Object.getPrototypeOf,b=m&&m(m(j([])));b&&b!==n&&o.call(b,c)&&(g=b);var w=y.prototype=d.prototype=Object.create(g);function x(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function E(t,r){var n;i(this,"_invoke",{value:function(i,a){function c(){return new r(function(n,c){!function n(i,a,c,u){var s=h(t[i],t,a);if("throw"!==s.type){var f=s.arg,l=f.value;return l&&"object"==e(l)&&o.call(l,"__await")?r.resolve(l.__await).then(function(t){n("next",t,c,u)},function(t){n("throw",t,c,u)}):r.resolve(l).then(function(t){f.value=t,c(f)},function(t){return n("throw",t,c,u)})}u(s.arg)}(i,a,n,c)})}return n=n?n.then(c,c):c()}})}function L(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return k()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=O(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function j(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return v.prototype=y,i(w,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:v,configurable:!0}),v.displayName=f(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,f(t,s,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},x(E.prototype),f(E.prototype,u,function(){return this}),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},x(w),f(w,s,"Generator"),f(w,c,function(){return this}),f(w,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function n(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(s){return void r(s)}c.done?e(u):Promise.resolve(u).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise(function(o,i){var a=t.apply(e,r);function c(t){n(a,o,i,c,u,"next",t)}function u(t){n(a,o,i,c,u,"throw",t)}c(void 0)})}}var i=null,a=function(){return i};exports.getOpenToContrib=a;var c=function(t){i=t,document.getElementById("opentocontribution").checked=t};exports.setOpenToContrib=c;var u=function(){var t=o(r().mark(function t(e){var n;return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((n=document.getElementById("opentocontribution").checked)===i){t.next=4;break}return t.next=4,f(e,n);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();exports.saveOpenToContrib=u;var s=function(t){var e=document.getElementById("opentocontribution");0===t?(e.checked=!1,e.disabled=!0):e.disabled=!1};exports.changeOpenToContrib=s;var f=function(){var e=o(r().mark(function e(n,o){var a,c,u,s;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={uuid:n,opentocontrib:o},e.next=3,(0,t.updateSettings)("PATCH","/updatecomptocontrib",a);case 3:e.sent.ok&&(i=o,o?(c=document.getElementById("privacybadgetext"),'&nbsp;<span class="badge badge-light">STATUS:&nbsp;</span><span class="badge badge-info">OPEN TO CONTRIB</span>',c.insertAdjacentHTML("afterend",'&nbsp;<span class="badge badge-light">STATUS:&nbsp;</span><span class="badge badge-info">OPEN TO CONTRIB</span>')):document.querySelector(".badge-info")&&(u=document.getElementById("privacybadgetext").nextSibling.nextSibling,s=u.nextSibling,u.remove(),s.remove()));case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}();
},{"../settings":"iDjH"}],"yU0e":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setUIPrivacy=exports.savePrivacyLevel=exports.privateRadioButtonHandler=exports.getPrivacyLevel=void 0;var t=require("../settings"),e=require("./setopentocontrib"),r=require("../../../../common/js/utils");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(){o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(I){f=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),c=new S(n||[]);return i(a,"_invoke",{value:E(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(I){return{type:"throw",arg:I}}}t.wrap=l;var p={};function v(){}function y(){}function d(){}var g={};f(g,c,function(){return this});var m=Object.getPrototypeOf,w=m&&m(m(j([])));w&&w!==e&&r.call(w,c)&&(g=w);var b=d.prototype=v.prototype=Object.create(g);function x(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function L(t,e){var o;i(this,"_invoke",{value:function(i,a){function c(){return new e(function(o,c){!function o(i,a,c,u){var s=h(t[i],t,a);if("throw"!==s.type){var f=s.arg,l=f.value;return l&&"object"==n(l)&&r.call(l,"__await")?e.resolve(l.__await).then(function(t){o("next",t,c,u)},function(t){o("throw",t,c,u)}):e.resolve(l).then(function(t){f.value=t,c(f)},function(t){return o("throw",t,c,u)})}u(s.arg)}(i,a,o,c)})}return o=o?o.then(c,c):c()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return k()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=P(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function P(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,P(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function j(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:k}}function k(){return{value:void 0,done:!0}}return y.prototype=d,i(b,"constructor",{value:d,configurable:!0}),i(d,"constructor",{value:y,configurable:!0}),y.displayName=f(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,f(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},x(L.prototype),f(L.prototype,u,function(){return this}),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},x(b),f(b,s,"Generator"),f(b,c,function(){return this}),f(b,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function i(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(s){return void r(s)}c.done?e(u):Promise.resolve(u).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function c(t){i(a,n,o,c,u,"next",t)}function u(t){i(a,n,o,c,u,"throw",t)}c(void 0)})}}function c(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=u(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function u(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var f=null,l=function(){return f};exports.getPrivacyLevel=l;var h=function(){var t,r=c(document.getElementsByName("settingsPrivacyRadios"));try{for(r.s();!(t=r.n()).done;){t.value.addEventListener("change",function(){this.checked&&(3===parseInt(this.value)?(0,e.changeOpenToContrib)(0):(0,e.changeOpenToContrib)(1))})}}catch(n){r.e(n)}finally{r.f()}};exports.privateRadioButtonHandler=h;var p=function(t){f=t,document.getElementById("settingsPrivacyRadios"+t).checked=!0,t===r.LevelPrivacy.private&&(0,e.changeOpenToContrib)(0)};exports.setUIPrivacy=p;var v=function(){var t=a(o().mark(function t(e){var r,n;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=document.querySelector('input[name="settingsPrivacyRadios"]:checked').value,(n=parseInt(r))===f){t.next=5;break}return t.next=5,y(e,n);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();exports.savePrivacyLevel=v;var y=function(){var e=a(o().mark(function e(n,i){var a,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={uuid:n,privacy:i},e.next=3,(0,t.updateSettings)("PATCH","/updatecompprivacy",a);case 3:e.sent.ok&&(f=i,(c=document.getElementById("privacybadgetext")).className="badge "+r.PRIVACY_BADGE_STYLE[i],c.innerText=r.PRIVACY_BADGE_TEXT[i]);case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}();
},{"../settings":"iDjH","./setopentocontrib":"rZmd","../../../../common/js/utils":"osPO"}],"x1tf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateContributorsAtCompPage=exports.setUIContributors=exports.saveRemoveContributors=exports.saveNewContributors=exports.getCurrentContributors=exports.clearUIContributors=exports.clearAuxContribArrays=exports.addContributorButtonHandler=exports.ROLES=void 0;var t=require("../../../../common/js/config"),e=require("../../../../common/js/utils"),r=require("../settings"),n=require("../composition");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return l(t)||c(t)||u(t)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function c(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function l(t){if(Array.isArray(t))return s(t)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(){f=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(B){l=function(t,e,r){return t[e]=r}}function s(t,e,r,o){var i=e&&e.prototype instanceof v?e:v,a=Object.create(i.prototype),u=new C(o||[]);return n(a,"_invoke",{value:I(t,r,u)}),a}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(B){return{type:"throw",arg:B}}}t.wrap=s;var p={};function v(){}function m(){}function h(){}var y={};l(y,a,function(){return this});var g=Object.getPrototypeOf,b=g&&g(g(_([])));b&&b!==e&&r.call(b,a)&&(y=b);var x=h.prototype=v.prototype=Object.create(y);function w(t){["next","throw","return"].forEach(function(e){l(t,e,function(t){return this._invoke(e,t)})})}function E(t,e){var i;n(this,"_invoke",{value:function(n,a){function u(){return new e(function(i,u){!function n(i,a,u,c){var l=d(t[i],t,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==o(f)&&r.call(f,"__await")?e.resolve(f.__await).then(function(t){n("next",t,u,c)},function(t){n("throw",t,u,c)}):e.resolve(f).then(function(t){s.value=t,u(s)},function(t){return n("throw",t,u,c)})}c(l.arg)}(n,a,i,u)})}return i=i?i.then(u,u):u()}})}function I(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return O()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=L(a,r);if(u){if(u===p)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=d(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=d(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function _(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return m.prototype=h,n(x,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:m,configurable:!0}),m.displayName=l(h,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,l(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(E.prototype),l(E.prototype,u,function(){return this}),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},w(x),l(x,c,"Generator"),l(x,a,function(){return this}),l(x,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function d(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(l){return void r(l)}u.done?e(c):Promise.resolve(c).then(n,o)}function p(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){d(i,n,o,a,u,"next",t)}function u(t){d(i,n,o,a,u,"throw",t)}a(void 0)})}}var v=[],m=[],h=[],y={1:"Owner",2:"Admin",3:"Member",4:"Guest"};exports.ROLES=y;var g=function(){return v};exports.getCurrentContributors=g;var b=function(){document.getElementById("contributorinput").value="",document.getElementById("listOfContributors").innerHTML=""};exports.clearUIContributors=b;var x=function(){m=[],h=[]};exports.clearAuxContribArrays=x;var w=function(t){var e=document.getElementById("listOfContributors");t.length?(v=t,t.flatMap(function(t){return I(e,t)})):(document.getElementById("contributorinput").value="",e.innerHTML="")};exports.setUIContributors=w;var E=function(t){var r=document.getElementById("addContribButton"),n=document.getElementById("contributorinput"),o=document.getElementById("listOfContributors");r.addEventListener("click",function(){var r=document.getElementById("inputGroupSelectRole").value;document.getElementById("contributorinput").classList.remove("is-invalid"),document.getElementById("validationemailresult").innerText="",n.value&&(0,e.looksLikeMail)(n.value)?L(o,n.value.trim(),t,r):(document.getElementById("contributorinput").classList.add("is-invalid"),document.getElementById("validationemailresult").innerText="Sorry, invalid email address format.")})};exports.addContributorButtonHandler=E;var I=function(t,e){var r=y[e.role],n=document.createElement("li");n.className="list-group-item",n.id=e.user_uid,n.textContent=e.email+" ("+r+")";var o="&nbsp;<div class='custom-control custom-switch custom-control-inline float-right'>\n    <input type='checkbox' class='custom-control-input is-invalid' id='removeContSwitch".concat(e.user_uid,"'>\n    <label class='custom-control-label is-invalid' for='removeContSwitch").concat(e.user_uid,"'>Remove</label>\n  </div>");n.innerHTML+=o,t.appendChild(n),_(e)},L=function(){var r=p(f().mark(function r(o,i,a,u){var c,l,s,d,p,y,g;return f().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(c=document.getElementById("inputGroupSelectRole").value,0===parseInt(c)){r.next=29;break}if(l={email:i,user_uid:i,composition_id:a,role:parseInt(u)},s=v.findIndex(function(t){return t.email===i}),d=m.findIndex(function(t){return t.email===i}),(p=h.indexOf(i))>-1&&h.splice(p,1),!1,!(d<0&&s<0||k(l,d,s,o))){r.next=27;break}return r.next=12,fetch(t.ENDPOINT+"/checkuser/"+i);case 12:if(!(null!=(y=r.sent)&&y.ok||404===(null==y?void 0:y.status))){r.next=24;break}if(200!==(null==y?void 0:y.status)){r.next=19;break}return r.next=17,y.json();case 17:g=r.sent,l.user_uid=g.user_uid;case 19:m.push(l),I(o,l),404===(null==y?void 0:y.status)&&alert("An invitation via email will be sent to: "+i+", after clicking on the button Confirm"),r.next=25;break;case 24:alert("User can't be added");case 25:r.next=28;break;case 27:alert("Duplicate user");case 28:e.isSafari&&n.playlist.getEventEmitter().emit("resume");case 29:case"end":return r.stop()}},r)}));return function(t,e,n,o){return r.apply(this,arguments)}}(),k=function(t,e,r,n){var o,i,a=!1,u=(null===(o=v[r])||void 0===o?void 0:o.user_uid)||(null===(i=m[e])||void 0===i?void 0:i.user_uid),c=document.getElementById(u);return c&&(r>=0&&e<0&&v[r].role!==t.role&&(a=!0,c.remove()),e>=0&&r<0&&m[e].role!==t.role&&(a=!0,m.splice(e,1),c.remove()),e>=0&&r>=0&&(v[r].role===t.role&&(m.splice(e,1),c.remove(),I(n,t)),m.length&&m[e].role!==t.role&&(a=!0,m.splice(e,1),c.remove()))),a},S=function(){var t=p(f().mark(function t(){var e,n,o,a,u;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(m.length>0)){t.next=16;break}e=i(m),n=0;case 3:if(!(n<m.length)){t.next=12;break}return o=m[n],t.next=7,(0,r.updateSettings)("POST","/addcontributorbyemail",o);case 7:null!=(a=t.sent)&&a.ok&&(m[n].id=a.contribid,o.email===o.user_uid&&(m[n].user_uid=a.uuid,document.getElementById(o.email).id=a.uuid),e[n]=null);case 9:n++,t.next=3;break;case 12:u=e.filter(function(t){return null!=t}),v=v.concat(m),document.getElementById("contributorinput").value="",m=u;case 16:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();exports.saveNewContributors=S;var C=function(){var t=p(f().mark(function t(e){var n,o,a,u;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(h.length>0)){t.next=11;break}n=i(h),o=f().mark(function t(o){var i,a,u,c;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=v.findIndex(function(t){return t.email===h[o]}),a=v[i].user_uid,u={contrib_uuid:a,comp_uuid:e},t.next=5,(0,r.updateSettings)("DELETE","/deletecontributor",u);case 5:null!=(c=t.sent)&&c.ok?(n[o]=null,v.splice(i,1),document.getElementById(a).remove()):document.getElementById("removeContSwitch"+a).checked=!1;case 7:case"end":return t.stop()}},t)}),a=0;case 4:if(!(a<h.length)){t.next=9;break}return t.delegateYield(o(a),"t0",6);case 6:a++,t.next=4;break;case 9:u=n.filter(function(t){return null!=t}),h=u;case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();exports.saveRemoveContributors=C;var _=function(t){document.getElementById("removeContSwitch"+t.user_uid).addEventListener("change",function(r){var o=r.target;if("INPUT"===o.tagName&&"checkbox"===o.type&&o.checked){var i=confirm("Do you want remove the contributor: ".concat(t.email,"?"));if(e.isSafari&&n.playlist.getEventEmitter().emit("resume"),!0===i){var a=m.findIndex(function(e){return e.email===t.email});if(a>-1)m.splice(a,1),-1===v.findIndex(function(e){return e.email===t.email})?document.getElementById(t.user_uid).remove():h.push(t.email);else h.push(t.email)}else r.target.checked=!1}})},O=function(){var t=document.getElementById("contributorsbadgetext");if(t||v.length){var e=document.getElementById("rolebadgetext");if(t){if(v.length!==parseInt(t.innerText))if(v.length)t.innerText=v.length;else{var r=t.previousSibling;t.remove(),console.log(t.nextSibling),r.remove(),e.nextSibling.remove()}}else if(e){var n='&nbsp;<span class="badge badge-light">COLLABORATORS:&nbsp;</span><span id="contributorsbadgetext" class="badge badge-dark">'.concat(v.length,"</span>");e.insertAdjacentHTML("afterend",n)}}};exports.updateContributorsAtCompPage=O;
},{"../../../../common/js/config":"FyYm","../../../../common/js/utils":"osPO","../settings":"iDjH","../composition":"AYcs"}],"iDjH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateSettings=exports.enableCompositionSettings=void 0;var t=require("../../../common/js/config"),e=require("../../../common/js/utils"),r=require("./settings/setcollection"),n=require("./settings/settitle"),o=require("./settings/setdescription"),i=require("./settings/setopentocontrib"),a=require("./settings/setprivacy"),c=require("./settings/setcontributors"),u=require("./composition");function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(){l=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(T){u=function(t,e,r){return t[e]=r}}function f(t,e,r,o){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),c=new O(o||[]);return n(a,"_invoke",{value:E(t,r,c)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(T){return{type:"throw",arg:T}}}t.wrap=f;var h={};function d(){}function v(){}function y(){}var g={};u(g,i,function(){return this});var m=Object.getPrototypeOf,b=m&&m(m(j([])));b&&b!==e&&r.call(b,i)&&(g=b);var w=y.prototype=d.prototype=Object.create(g);function x(t){["next","throw","return"].forEach(function(e){u(t,e,function(t){return this._invoke(e,t)})})}function L(t,e){var o;n(this,"_invoke",{value:function(n,i){function a(){return new e(function(o,a){!function n(o,i,a,c){var u=p(t[o],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==s(f)&&r.call(f,"__await")?e.resolve(f.__await).then(function(t){n("next",t,a,c)},function(t){n("throw",t,a,c)}):e.resolve(f).then(function(t){l.value=t,a(l)},function(t){return n("throw",t,a,c)})}c(u.arg)}(n,i,o,a)})}return o=o?o.then(a,a):a()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return I()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=C(a,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=p(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function C(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,C(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=p(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function j(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return v.prototype=y,n(w,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:v,configurable:!0}),v.displayName=u(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},x(L.prototype),u(L.prototype,a,function(){return this}),t.AsyncIterator=L,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new L(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},x(w),u(w,c,"Generator"),u(w,i,function(){return this}),u(w,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function f(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(s){return void r(s)}c.done?e(u):Promise.resolve(u).then(n,o)}function p(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){f(i,n,o,a,c,"next",t)}function c(t){f(i,n,o,a,c,"throw",t)}a(void 0)})}}var h=function(t){(0,c.setUIContributors)(t.contributors),(0,c.addContributorButtonHandler)(t.uuid),(0,n.setUITitle)(t.title),(0,o.setUIDescription)(t.description),(0,a.setUIPrivacy)(t.privacy),(0,i.setOpenToContrib)(t.opentocontrib),m(t.uuid),g(t),d(),(0,a.privateRadioButtonHandler)(),(0,r.openSettingsButtonHandler)(null==t?void 0:t.collection_id)};exports.enableCompositionSettings=h;var d=function(){(0,e.cancelLoader)("settingsloader");var t=document.getElementById("useroptions"),r=document.createElement("li");r.innerHTML='<li class="nav-item">\n    <a class="nav-link" href="#" id="openSettingsButton" data-toggle="modal" data-target="#settingsModal">Settings</a>\n  </li>\n   ',t.appendChild(r)},v=function(){var e=p(l().mark(function e(r,n,o){var i,a,c,u,s;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=JSON.stringify(o),a=null,c={method:r,headers:{"Content-Type":"application/json",Accept:"application/json"},body:i},e.prev=3,e.next=6,fetch(t.ENDPOINT+n,c);case 6:return u=e.sent,e.next=9,u.json();case 9:(s=e.sent)&&(a=s),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),alert(e.t0);case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}},e,null,[[3,13]])}));return function(t,r,n){return e.apply(this,arguments)}}();exports.updateSettings=v;var y=function(t){(0,n.setUITitle)((0,n.getCurrentTitle)()||t.title),(0,o.setUIDescription)((0,o.getCurrentDescription)()||t.description),(0,a.setUIPrivacy)((0,a.getPrivacyLevel)()||t.privacy),(0,i.setOpenToContrib)((0,i.getOpenToContrib)()||t.opentocontrib),(0,c.clearUIContributors)(),(0,c.setUIContributors)((0,c.getCurrentContributors)().length?(0,c.getCurrentContributors)():t.contributors),(0,c.clearAuxContribArrays)(),document.getElementById("deleteComposition").checked=!1},g=function(t){var e=document.getElementById("cancelsettingsbutton");null==e||e.addEventListener("click",function(){y(t)})},m=function(){var t=p(l().mark(function t(u){var s;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null==(s=document.getElementById("updatecompositionbutton"))||s.addEventListener("click",function(){var t=p(l().mark(function t(s){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((0,e.startLoader)("settingsloader","Updating Settings..."),!0!==document.getElementById("deleteComposition").checked){t.next=8;break}return t.next=5,b(u);case 5:(0,e.cancelLoader)("settingsloader"),t.next=25;break;case 8:return t.next=10,(0,n.saveTitle)(u);case 10:return t.next=12,(0,o.saveDescription)(u);case 12:return t.next=14,(0,a.savePrivacyLevel)(u);case 14:return t.next=16,(0,i.saveOpenToContrib)(u);case 16:return t.next=18,(0,c.saveNewContributors)();case 18:return t.next=20,(0,c.saveRemoveContributors)(u);case 20:return t.next=22,(0,r.saveParentCollection)(u);case 22:(0,c.updateContributorsAtCompPage)(),$("#settingsModal").modal("hide"),(0,e.cancelLoader)("settingsloader");case 25:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),b=function(){var t=p(l().mark(function t(r){var o;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=confirm("Delete "+(0,n.getCurrentTitle)()+"?"),e.isSafari&&u.playlist.getEventEmitter().emit("resume"),!o){t.next=7;break}return t.next=5,v("DELETE","/deletecomposition/"+r,null);case 5:t.sent.ok&&(window.location.href=window.location.origin);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();
},{"../../../common/js/config":"FyYm","../../../common/js/utils":"osPO","./settings/setcollection":"vpSD","./settings/settitle":"dF8V","./settings/setdescription":"lCtB","./settings/setopentocontrib":"rZmd","./settings/setprivacy":"yU0e","./settings/setcontributors":"x1tf","./composition":"AYcs"}],"mWug":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.trackInfoHandler=exports.createTrackInfoTable=void 0;var t=require("../../../common/js/utils"),e=require("./composition");function r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function n(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){o(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function o(t,e,r){return(e=i(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t){var e=a(t,"string");return"symbol"===u(e)?e:String(e)}function a(t,e){if("object"!==u(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function c(){c=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(_){f=function(t,e,r){return t[e]=r}}function s(t,e,r,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new S(o||[]);return n(a,"_invoke",{value:x(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(_){return{type:"throw",arg:_}}}t.wrap=s;var d={};function p(){}function y(){}function v(){}var m={};f(m,i,function(){return this});var g=Object.getPrototypeOf,b=g&&g(g(P([])));b&&b!==e&&r.call(b,i)&&(m=b);var w=v.prototype=p.prototype=Object.create(m);function E(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function k(t,e){var o;n(this,"_invoke",{value:function(n,i){function a(){return new e(function(o,a){!function n(o,i,a,c){var l=h(t[o],t,i);if("throw"!==l.type){var f=l.arg,s=f.value;return s&&"object"==u(s)&&r.call(s,"__await")?e.resolve(s.__await).then(function(t){n("next",t,a,c)},function(t){n("throw",t,a,c)}):e.resolve(s).then(function(t){f.value=t,a(f)},function(t){return n("throw",t,a,c)})}c(l.arg)}(n,i,o,a)})}return o=o?o.then(a,a):a()}})}function x(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=L(a,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=v,n(w,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:y,configurable:!0}),y.displayName=f(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,f(t,l,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},E(k.prototype),f(k.prototype,a,function(){return this}),t.AsyncIterator=k,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new k(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(w),f(w,l,"Generator"),f(w,i,function(){return this}),f(w,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},t}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(l){return void r(l)}c.done?e(u):Promise.resolve(u).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){l(i,n,o,a,c,"next",t)}function c(t){l(i,n,o,a,c,"throw",t)}a(void 0)})}}var s=!1,h=null,d=null,p=null,y=document.getElementById("edittrackinfobutton"),v=function(){E(),w(),y.addEventListener("click",x,!1)};exports.trackInfoHandler=v;var m=function(){var e=f(c().mark(function e(r,n,o){var i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=!1,d=r,p=o,y.innerText="Edit",(0,t.startLoader)("trackinfoloader","Loading track info..."),e.next=7,(0,t.callJsonApi)("/getinfotrack/"+o,"GET");case 7:"object"===u(i=e.sent)?(h=i,g(i,null)):(alert("Error getting track info"),g(null,n));case 9:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}();exports.createTrackInfoTable=m;var g=function(){var e=f(c().mark(function e(r,n){var o,i,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((0,t.cancelLoader)("trackinfoloader"),o=document.getElementById("trackinfotablebody"),i="",r)for(a in r)i+="<tr><th scope='row'>".concat(a,"</th><td contenteditable='false' data-key=").concat(a,">").concat(r[a],"</td></tr>");else i+="<tr><th scope='row'>title</th><td data-key='title'>".concat(n,"</td></tr>");o.innerHTML=i;case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),b=function(){document.getElementById("trackinfotablebody").innerHTML=""},w=function(){var t=document.getElementById("canceltrackinfobutton");null==t||t.addEventListener("click",function(){b()})},E=function(){var e=f(c().mark(function e(){var r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:null==(r=document.getElementById("updatetrackinfobutton"))||r.addEventListener("click",function(){var e=f(c().mark(function e(r){var o,i,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o={},document.querySelectorAll("td[contenteditable]").forEach(function(t){o[t.getAttribute("data-key")]=t.innerText}),JSON.stringify(h)===JSON.stringify(o)){e.next=10;break}return(0,t.startLoader)("trackinfoloader","Updating track info..."),i={trackid:p},e.next=7,(0,t.callJsonApi)("/updatetrackinfo","PATCH",n(n({},o),i));case 7:a=e.sent,k(a,o),(0,t.cancelLoader)("trackinfoloader");case 10:$("#trackInfoModal").modal("hide");case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),k=function(t,r){if("object"===u(t)&&t.ok){h=r,e.playlist.tracks[d].name=h.title;var n=document.querySelectorAll("[data-track-id='".concat(p,"']"));1===n.length&&(n[0].dataset.name=h.title),e.playlist.getEventEmitter().emit("updateview")}else alert("Error updating track info: "+t)},x=function(){s?(s=!1,y.innerText="Edit",O()):(s=!0,y.innerText="Done",L())},L=function(){document.querySelectorAll("td[contenteditable='false']").forEach(function(t){t.contentEditable=!0,t.classList.add("italic")})},O=function(){document.querySelectorAll("td[contenteditable='true']").forEach(function(t){t.contentEditable=!1,t.classList.remove("italic")})};
},{"../../../common/js/utils":"osPO","./composition":"AYcs"}],"tm8Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getComposition=exports.doAfterCompositionFetched=exports.CURRENT_USER_ID=void 0;var n=require("../../../common/js/config"),t=require("../../../common/js/indexedDB"),e=require("../../../common/js/utils"),i=require("./composition"),o=require("./settings"),a=require("./settings/setcontributors"),s=require("./trackinfo"),c=null;function r(t,e,i,o,a,s,c){this.id=t,this.name=e,this.src=n.ENDPOINT+"/trackfile/"+t,this.muted=i,this.soloed=o,this.gain=a,this.stereoPan=s,this.customClass=c}exports.CURRENT_USER_ID=c;var l=function(t,e,i){var o=null,a={};fetch(n.ENDPOINT+"/composition/"+t,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(function(n){return n.ok||(o=n.statusText),n.json()}).then(function(n){n&&(a=n)}).catch(function(n){o=n}).then(function(){o&&alert(o),e(a,i)})};exports.getComposition=l;var u=function(n){t.DB?d(t.DB,n):(0,t.openDB)(n.viewer_id||"null").then(function(t){d(t,n)})};exports.doAfterCompositionFetched=u;var d=function(n,e){var i=null;(0,t.getTracksByCompId)(n,null==e?void 0:e.uuid).then(function(n){i=n}).catch(function(n){console.log(n)}).finally(function(){f(e,i),C(e)})},p=function(n){var t={};return n.forEach(function(n){t[n.track_id]=n}),t},b=function(n,t,e){var i=!(!e||!e[null==n?void 0:n.uuid])&&e[n.uuid].muted,o=!(!e||!e[null==n?void 0:n.uuid])&&e[n.uuid].soloed,a=e&&e[null==n?void 0:n.uuid]?e[n.uuid].gain:1,s=e&&e[null==n?void 0:n.uuid]?e[n.uuid].stereoPan:0,c=n.title,l={name:c,track_id:n.uuid,user_id:n.user_id,user_uid:n.user_uid,composition_id:t.uuid,viewer_id:t.viewer_id||"null"};return new r(n.uuid,c,i,o,a,s,l)},f=function(n,t){var a=n.owner||1<=n.role&&n.role<=3||!1,s=n.role;exports.CURRENT_USER_ID=c=n.viewer_id;var r=null;if(null!=t&&t.length&&(r=p(t)),a&&(i.playlist.controls.widgets.remove=!1,(0,i.setUserPermission)(!0),i.fileUploader.enableUpload(),1===s&&(0,o.enableCompositionSettings)(n)),n.tracks){var l=[];n.tracks.forEach(function(t){if(t){var e=b(t,n,r);l.push(e)}}),g(l,a,s)}else(0,e.cancelLoader)(e.LOADER_ELEM_ID),i.playlist.initExporter(),i.recorder.init()},g=function(n,t,o){var a=null;i.playlist.load(n).then(function(){i.playlist.initExporter()}).catch(function(n){a=n}).then(function(){(0,e.cancelLoader)(e.LOADER_ELEM_ID),a?alert(a):(i.recorder.init(),t&&((0,s.trackInfoHandler)(),i.trackHandler.detectClickOutsideMenuOpt(),i.trackHandler.displayOptMenuForTracks(o)))})},h=function(n){return'<span class="badge badge-light">OWNER:&nbsp;</span>\n            <i class="fa fa-user"></i>&nbsp;\n            <a href="'.concat(e.uriUserPage+n.user_id,'" class="card-url">').concat(n.username,"&nbsp;</a>")},v=function(n){return"".concat(n.role?'<span class="badge badge-light">YOUR ROLE:&nbsp;</span>\n        <span id="rolebadgetext" class="badge badge-success">\n         '.concat(a.ROLES[n.role],"\n        </span>&nbsp;"):"")},_=function(n){return"".concat(n.contributors.length?'<span class="badge badge-light">COLLABORATORS:&nbsp;</span>\n        <span id="contributorsbadgetext" class="badge badge-dark">\n        '.concat(n.contributors.length,"</span>&nbsp;"):"")},E=function(n){return"".concat(n.opentocontrib?'<span class="badge badge-light">STATUS:&nbsp;</span><span class="badge badge-info">OPEN TO CONTRIB</span>':"")},m=function(n){var t=n.description||"";return'<p>\n                <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseDescription" aria-expanded="false">\n                Description\n                </button>\n            </p>\n            <div class="collapse" id="collapseDescription">\n                <div class="card card-body" id="comp-description">\n                '.concat(t,"\n                </div>\n            </div>")},R=function(n){return'<span class="badge badge-light">PRIVACY:&nbsp;</span>\n            <span id="privacybadgetext" class="badge \n            '.concat(e.PRIVACY_BADGE_STYLE[n.privacy],'">').concat(e.PRIVACY_BADGE_TEXT[n.privacy],"\n            </span>&nbsp;")},T=function(n){return"".concat(n.collection_id?'<span class="badge badge-light">COLLECTION:&nbsp;</span>\n    <i class="fa fa-th-list"></i>&nbsp;\n    <a href="'.concat(e.uriCollectionPage+n.collection_id,'" class="card-url">').concat(n.parent_collection,"&nbsp;</a>"):"")},C=function(n){var t='<h1 class="post-title">Test DAW</h1>';n.title&&(t="<br>",t+=h(n),t+=T(n),t+="<br>",t+=v(n),t+=_(n),t+=R(n),t+=E(n),t+='<p><h2 id="comp-title" class="post-title">'.concat(n.title,"</h2></p>"),t+=m(n)),document.getElementById("post-header").insertAdjacentHTML("afterbegin",t)};
},{"../../../common/js/config":"FyYm","../../../common/js/indexedDB":"bt5Z","../../../common/js/utils":"osPO","./composition":"AYcs","./settings":"iDjH","./settings/setcontributors":"x1tf","./trackinfo":"mWug"}],"x6rf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TrackHandler=void 0;var e=require("../../../common/js/config"),t=require("../../../common/js/utils"),n=require("./composition_helper"),o=require("./composition"),r=require("./trackinfo");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,u(o.key),o)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var t=s(e,"string");return"symbol"===a(t)?t:String(t)}function s(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var d=function(){function a(){i(this,a)}return c(a,[{key:"displayOptMenuForNewTrack",value:function(e){var t,n,r=e.result,a=(null==r?void 0:null===(t=r.message)||void 0===t?void 0:t.audio)||(null==r?void 0:null===(n=r.message)||void 0===n?void 0:n.voice),i=a.title||r.message.date,l=a.file_unique_id,c=document.getElementsByClassName("controls"),u=c.length-1;if(u>=0){var s={name:i,track_id:l,user_id:a.user_id,user_uid:a.user_uid,composition_id:a.composition_id};o.playlist.tracks[u].customClass=s,this.createMenuOptButton(c,u,i,l)}}},{key:"displayOptMenuForTracks",value:function(e){document.querySelectorAll(".menuoptbtn").length&&document.querySelectorAll(".menuoptbtn").forEach(function(e){return e.remove()});for(var t=document.getElementsByClassName("controls"),r=o.playlist.getInfo().tracks,a=0;a<r.length;a++){var i;if(null!==(i=r[a])&&void 0!==i&&i.customClass&&(1===e||2===e||3===e&&r[a].customClass.user_uid===n.CURRENT_USER_ID)){var l=r[a].customClass.name,c=r[a].customClass.track_id;this.createMenuOptButton(t,a,l,c)}}}},{key:"createMenuOptButton",value:function(e,t,n,o){var r="menuoptbtn-"+t,a="menuDropdown"+t,i=document.createElement("button"),l=document.createTextNode("...");i.className="menuoptbtn",i.onclick=function(){document.getElementById(a).classList.toggle("show")},i.id=r,i.appendChild(l),e[t].appendChild(i);var c=this.createListMenuOpt(a,t,n,o);document.getElementById(r).appendChild(c),e[t].getElementsByClassName("track-header")[0].getElementsByTagName("span")[0].style["margin-left"]="3em"}},{key:"createListMenuOpt",value:function(e,t,n,o){var r=document.createElement("ul");r.id=e,r.className="dropdown-menu";var a=this.createDeleteMenuOpt(t,n,o),i=this.createTrackInfoMenuOpt(t,n,o);return r.appendChild(a),r.appendChild(i),r}},{key:"createDeleteMenuOpt",value:function(e,t,n){var o=this,r=document.createElement("li");return r.className="dropdown-item btn-light",r.dataset.pos=e,r.dataset.name=t,r.dataset.trackId=n,r.onclick=function(e){o.deleteTrackConfirmDialog(e,o.sendDeleteRequest,o.doAfterDeleted)},r.appendChild(document.createTextNode("Delete")),r}},{key:"createTrackInfoMenuOpt",value:function(e,t,n){var o=document.createElement("li");return o.className="dropdown-item btn-light",o.dataset.target="#trackInfoModal",o.dataset.toggle="modal",o.onclick=function(o){(0,r.createTrackInfoTable)(e,t,n)},o.appendChild(document.createTextNode("Track Info")),o}},{key:"detectClickOutsideMenuOpt",value:function(){window.onclick=function(e){var t=document.getElementsByClassName("dropdown-menu show");t.length>0&&"menuoptbtn"!==e.target.className?Array.from(t).forEach(function(e){e.className="dropdown-menu"}):t.length>1&&Array.from(t).forEach(function(t){e.target.contains(t)||(t.className="dropdown-menu")})}}},{key:"deleteTrackConfirmDialog",value:function(e,n,r){var a=confirm("Delete "+e.target.dataset.name+"?");t.isSafari&&o.playlist.getEventEmitter().emit("resume"),a&&n(e.target.dataset.pos,e.target.dataset.trackId,r)}},{key:"sendDeleteRequest",value:function(n,o,r){(0,t.startLoader)(t.LOADER_ELEM_ID,"Deleting track..."),fetch(e.ENDPOINT+"/deletetrack/"+o,{method:"DELETE"}).then(function(e){return e.json()}).then(function(e){r(e,n)}).catch(function(e){console.log(e),(0,t.cancelLoader)(t.LOADER_ELEM_ID)})}},{key:"doAfterDeleted",value:function(e,n){if((0,t.cancelLoader)(t.LOADER_ELEM_ID),e.ok){var r=e.role,i=o.playlist.tracks;o.playlist.getEventEmitter().emit("removeTrack",i[n]),(new a).displayOptMenuForTracks(r)}}}]),a}();exports.TrackHandler=d;
},{"../../../common/js/config":"FyYm","../../../common/js/utils":"osPO","./composition_helper":"tm8Q","./composition":"AYcs","./trackinfo":"mWug"}],"yKjk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FileUploader=void 0;var e=require("../../../common/js/config"),t=require("../../../common/js/utils"),n=require("./composition");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=s(e,"string");return"symbol"===r(t)?t:String(t)}function s(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var u=function(){function r(e,t){o(this,r),this.compositionId=e,this.trackhandler=t}return a(r,[{key:"enableUpload",value:function(){var e=this,t=this;document.getElementById("fileInput").addEventListener("change",function(e){e.preventDefault(),t.fileReader(this.files[0])},!1),dropContainer.ondragover=dropContainer.ondragenter=function(e){e.preventDefault()},dropContainer.ondrop=function(t){fileInput.files=t.dataTransfer.files,e.fileReader(fileInput.files[0]),t.preventDefault()}}},{key:"fileReader",value:function(e){var t=this,n={dom:document.getElementById("fileInput"),binary:null},r=new FileReader;r.addEventListener("load",function(){n.binary=r.result}),r.addEventListener("loadend",function(){t.sendData(n)}),e&&r.readAsBinaryString(e)}},{key:"sendData",value:function(r,o){if(!o&&!r.binary&&r.dom.files.length>0)setTimeout(this.sendData,10);else{var i=new XMLHttpRequest,a=new FormData,l=o?r:r.dom.files[0],s=o?r.fileName:r.dom.files[0].name;a.append("composition_id",this.compositionId),a.append("audio",l,s),i.addEventListener("load",function(e){if((0,t.cancelLoader)(t.LOADER_ELEM_ID),e.srcElement&&e.srcElement.response){var r=JSON.parse(e.srcElement.response);r.ok?(fileInput.value="","blob"===o?n.trackHandler.displayOptMenuForNewTrack(r):n.playlist.getEventEmitter().emit("audiosourcesrendered",r)):alert("Oops! Something went wrong.")}else alert("Oops! Something went wrong.")}),i.addEventListener("error",function(e){(0,t.cancelLoader)(t.LOADER_ELEM_ID),alert("Oops! Something went wrong.")}),i.open("POST",e.UPLOAD_ENDPOINT),i.send(a),(0,t.startLoader)(t.LOADER_ELEM_ID,"Uploading track...")}}}]),r}();exports.FileUploader=u;
},{"../../../common/js/config":"FyYm","../../../common/js/utils":"osPO","./composition":"AYcs"}],"pBGv":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"yh9p":[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){var n,o,a=h(r),u=a[0],i=a[1],f=new e(c(r,u,i)),A=0,d=i>0?u-4:u;for(o=0;o<d;o+=4)n=t[r.charCodeAt(o)]<<18|t[r.charCodeAt(o+1)]<<12|t[r.charCodeAt(o+2)]<<6|t[r.charCodeAt(o+3)],f[A++]=n>>16&255,f[A++]=n>>8&255,f[A++]=255&n;return 2===i&&(n=t[r.charCodeAt(o)]<<2|t[r.charCodeAt(o+1)]>>4,f[A++]=255&n),1===i&&(n=t[r.charCodeAt(o)]<<10|t[r.charCodeAt(o+1)]<<4|t[r.charCodeAt(o+2)]>>2,f[A++]=n>>8&255,f[A++]=255&n),f}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],"JgNJ":[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],"REa7":[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],"dskh":[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":"yh9p","ieee754":"JgNJ","isarray":"REa7","buffer":"dskh"}],"OgXH":[function(require,module,exports) {
var define;
var process = require("process");
var Buffer = require("buffer").Buffer;
var t,e=require("process"),n=require("buffer").Buffer;function r(){"use strict";r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(j){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,a=Object.create(o.prototype),s=new _(r||[]);return i(a,"_invoke",{value:P(t,n,s)}),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(j){return{type:"throw",arg:j}}}t.wrap=l;var f={};function d(){}function p(){}function v(){}var y={};c(y,a,function(){return this});var m=Object.getPrototypeOf,g=m&&m(m(E([])));g&&g!==e&&n.call(g,a)&&(y=g);var k=v.prototype=d.prototype=Object.create(y);function w(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function x(t,e){var r;i(this,"_invoke",{value:function(i,o){function a(){return new e(function(r,a){!function r(i,o,a,s){var u=h(t[i],t,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==b(l)&&n.call(l,"__await")?e.resolve(l.__await).then(function(t){r("next",t,a,s)},function(t){r("throw",t,a,s)}):e.resolve(l).then(function(t){c.value=t,a(c)},function(t){return r("throw",t,a,s)})}s(u.arg)}(i,o,r,a)})}return r=r?r.then(a,a):a()}})}function P(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return R()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=h(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function S(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function E(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return p.prototype=v,i(k,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:p,configurable:!0}),p.displayName=c(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},w(x.prototype),c(x.prototype,s,function(){return this}),t.AsyncIterator=x,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new x(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},w(k),c(k,u,"Generator"),c(k,a,function(){return this}),c(k,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=E,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function i(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function s(t){i(a,r,o,s,u,"next",t)}function u(t){i(a,r,o,s,u,"throw",t)}s(void 0)})}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=s(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(this,arguments)}function s(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=d();return function(){var n,r=p(t);if(e){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,g(r.key),r)}}function m(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function g(t){var e=k(t,"string");return"symbol"===b(e)?e:String(e)}function k(t,e){if("object"!==b(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(e,n){"object"===("undefined"==typeof exports?"undefined":b(exports))&&"object"===("undefined"==typeof module?"undefined":b(module))?module.exports=n():"function"==typeof t&&t.amd?t("WaveformPlaylist",[],n):"object"===("undefined"==typeof exports?"undefined":b(exports))?exports.WaveformPlaylist=n():e.WaveformPlaylist=n()}(this,function(){return function(){var t={6824:function(t){var e,n,r;t.exports=(n=String.prototype.split,r=/()??/.exec("")[1]===e,function(t,i,o){if("[object RegExp]"!==Object.prototype.toString.call(i))return n.call(t,i,o);var a,s,u,c,l=[],h=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.extended?"x":"")+(i.sticky?"y":""),f=0;for(i=new RegExp(i.source,h+"g"),t+="",r||(a=new RegExp("^"+i.source+"$(?!\\s)",h)),o=o===e?-1>>>0:o>>>0;(s=i.exec(t))&&!((u=s.index+s[0].length)>f&&(l.push(t.slice(f,s.index)),!r&&s.length>1&&s[0].replace(a,function(){for(var t=1;t<arguments.length-2;t++)arguments[t]===e&&(s[t]=e)}),s.length>1&&s.index<t.length&&Array.prototype.push.apply(l,s.slice(1)),c=s[0].length,f=u,l.length>=o));)i.lastIndex===s.index&&i.lastIndex++;return f===t.length?!c&&i.test("")||l.push(""):l.push(t.slice(f)),l.length>o?l.slice(0,o):l})},1804:function(t,e,n){"use strict";var r=n(5618),i=n(7205),o=n(7191),a=n(5516),s=n(9981);(t.exports=function(t,e){var n,i,u,c,l;return arguments.length<2||"string"!=typeof t?(c=e,e=t,t=null):c=arguments[2],r(t)?(n=s.call(t,"c"),i=s.call(t,"e"),u=s.call(t,"w")):(n=u=!0,i=!1),l={value:e,configurable:n,enumerable:i,writable:u},c?o(a(c),l):l}).gs=function(t,e,n){var u,c,l,h;return"string"!=typeof t?(l=n,n=e,e=t,t=null):l=arguments[3],r(e)?i(e)?r(n)?i(n)||(l=n,n=void 0):n=void 0:(l=e,e=n=void 0):e=void 0,r(t)?(u=s.call(t,"c"),c=s.call(t,"e")):(u=!0,c=!1),h={get:e,set:n,configurable:u,enumerable:c},l?o(a(l),h):h}},430:function(t){"use strict";t.exports=function(){}},7191:function(t,e,n){"use strict";t.exports=n(6560)()?Object.assign:n(7346)},6560:function(t){"use strict";t.exports=function(){var t,e=Object.assign;return"function"==typeof e&&(e(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},7346:function(t,e,n){"use strict";var r=n(5103),i=n(2745),o=Math.max;t.exports=function(t,e){var n,a,s,u=o(arguments.length,2);for(t=Object(i(t)),s=function(r){try{t[r]=e[r]}catch(i){n||(n=i)}},a=1;a<u;++a)e=arguments[a],r(e).forEach(s);if(void 0!==n)throw n;return t}},6914:function(t,e,n){"use strict";var r=n(430)();t.exports=function(t){return t!==r&&null!==t}},5103:function(t,e,n){"use strict";t.exports=n(7446)()?Object.keys:n(6137)},7446:function(t){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},6137:function(t,e,n){"use strict";var r=n(6914),i=Object.keys;t.exports=function(t){return i(r(t)?Object(t):t)}},5516:function(t,e,n){"use strict";var r=n(6914),i=Array.prototype.forEach,o=Object.create;t.exports=function(t){var e=o(null);return i.call(arguments,function(t){r(t)&&function(t,e){var n;for(n in t)e[n]=t[n]}(Object(t),e)}),e}},1290:function(t){"use strict";t.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},2745:function(t,e,n){"use strict";var r=n(6914);t.exports=function(t){if(!r(t))throw new TypeError("Cannot use null or undefined");return t}},9981:function(t,e,n){"use strict";t.exports=n(3591)()?String.prototype.contains:n(6042)},3591:function(t){"use strict";var e="razdwatrzy";t.exports=function(){return"function"==typeof e.contains&&(!0===e.contains("dwa")&&!1===e.contains("foo"))}},6042:function(t){"use strict";var e=String.prototype.indexOf;t.exports=function(t){return e.call(this,t,arguments[1])>-1}},8832:function(t,e,n){"use strict";n(4167)("ev-store","7");var r="__EV_STORE_KEY@7";t.exports=function(t){var e=t[r];e||(e=t[r]={});return e}},8370:function(t,e,n){"use strict";var r,i,o,a,s,u,c,l=n(1804),h=n(1290),f=Function.prototype.apply,d=Function.prototype.call,p=Object.create,v=Object.defineProperty,y=Object.defineProperties,m=Object.prototype.hasOwnProperty,g={configurable:!0,enumerable:!1,writable:!0};i=function(t,e){var n,i;return h(e),i=this,r.call(this,t,n=function(){o.call(i,t,n),f.call(e,this,arguments)}),n.__eeOnceListener__=e,this},s={on:r=function(t,e){var n;return h(e),m.call(this,"__ee__")?n=this.__ee__:(n=g.value=p(null),v(this,"__ee__",g),g.value=null),n[t]?"object"===b(n[t])?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},once:i,off:o=function(t,e){var n,r,i,o;if(h(e),!m.call(this,"__ee__"))return this;if(!(n=this.__ee__)[t])return this;if("object"===b(r=n[t]))for(o=0;i=r[o];++o)i!==e&&i.__eeOnceListener__!==e||(2===r.length?n[t]=r[o?0:1]:r.splice(o,1));else r!==e&&r.__eeOnceListener__!==e||delete n[t];return this},emit:a=function(t){var e,n,r,i,o;if(m.call(this,"__ee__")&&(i=this.__ee__[t]))if("object"===b(i)){for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];for(i=i.slice(),e=0;r=i[e];++e)f.call(r,this,o)}else switch(arguments.length){case 1:d.call(i,this);break;case 2:d.call(i,this,arguments[1]);break;case 3:d.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];f.call(i,this,o)}}},u={on:l(r),once:l(i),off:l(o),emit:l(a)},c=y({},u),t.exports=e=function(t){return null==t?p(c):y(Object(t),u)},e.methods=s},6226:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.linear=function(t,e){var n,r,i=new Float32Array(t),o=t-1;for(n=0;n<t;n++)r=n/o,i[n]=e>0?r:1-r;return i},e.exponential=function(t,e){var n,r,i=new Float32Array(t),o=t-1;for(n=0;n<t;n++)r=n/o,i[e>0?n:t-1-n]=Math.exp(2*r-1)/Math.exp(1);return i},e.sCurve=function(t,e){var n,r=new Float32Array(t),i=e>0?Math.PI/2:-Math.PI/2;for(n=0;n<t;++n)r[n]=Math.sin(Math.PI*n/t-i)/2+.5;return r},e.logarithmic=function(t,e,n){var r,i=new Float32Array(t),o=0;for(r=0;r<t;r++)o=r/t,i[n>0?r:t-1-r]=Math.log(1+e*o)/Math.log(1+e);return i}},1114:function(t,e,n){"use strict";e.h7=e.Y1=e.Hp=e.Jl=e.t$=e._h=void 0,e.L7=function(t,e,n,u){switch(e){case i:(function(t,e){var n=(0,r.sCurve)(1e4,1);this.setValueCurveAtTime(n,t,e)}).call(t,n,u);break;case o:(function(t,e){this.linearRampToValueAtTime(0,t),this.linearRampToValueAtTime(1,t+e)}).call(t,n,u);break;case a:(function(t,e){this.exponentialRampToValueAtTime(.01,t),this.exponentialRampToValueAtTime(1,t+e)}).call(t,n,u);break;case s:(function(t,e){var n=(0,r.logarithmic)(1e4,10,1);this.setValueCurveAtTime(n,t,e)}).call(t,n,u);break;default:throw new Error("Unsupported Fade type")}},e.Mt=function(t,e,n,u){switch(e){case i:(function(t,e){var n=(0,r.sCurve)(1e4,-1);this.setValueCurveAtTime(n,t,e)}).call(t,n,u);break;case o:(function(t,e){this.linearRampToValueAtTime(1,t),this.linearRampToValueAtTime(0,t+e)}).call(t,n,u);break;case a:(function(t,e){this.exponentialRampToValueAtTime(1,t),this.exponentialRampToValueAtTime(.01,t+e)}).call(t,n,u);break;case s:(function(t,e){var n=(0,r.logarithmic)(1e4,10,-1);this.setValueCurveAtTime(n,t,e)}).call(t,n,u);break;default:throw new Error("Unsupported Fade type")}};var r=n(6226),i=e._h="sCurve",o=e.t$="linear",a=e.Jl="exponential",s=e.Hp="logarithmic";e.Y1="FadeIn",e.h7="FadeOut"},9144:function(t,e,n){var r,i=void 0!==n.g?n.g:"undefined"!=typeof window?window:{},o=n(5893);"undefined"!=typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"])||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=o),t.exports=r},8070:function(t,e,n){"use strict";var r="undefined"!=typeof window?window:void 0!==n.g?n.g:{};t.exports=function(t,e){if(t in r)return r[t];return r[t]=e,e}},4167:function(t,e,n){"use strict";var r=n(8070);t.exports=function(t,e,n){var i="__INDIVIDUAL_ONE_VERSION_"+t,o=r(i+"_ENFORCE_SINGLETON",e);if(o!==e)throw new Error("Can only have one copy of "+t+".\nYou already have version "+o+" installed.\nThis means you cannot install version "+e);return r(i,n)}},849:function(t,e,n){var r=!!(n.g===n.g.window&&n.g.URL&&n.g.Blob&&n.g.Worker);function i(t,e){var i,o=this;if(e=e||{},r)return i=t.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1],new n.g.Worker(n.g.URL.createObjectURL(new n.g.Blob([i],{type:"text/javascript"})));this.self=e,this.self.postMessage=function(t){setTimeout(function(){o.onmessage({data:t})},0)},setTimeout(t.bind(e,e),0)}i.prototype.postMessage=function(t){var e=this;setTimeout(function(){e.self.onmessage({data:t})},0)},t.exports=i},6240:function(t){"use strict";t.exports=function(t){return"object"===b(t)&&null!==t}},1730:function(t){var e=9007199254740991,n="[object Arguments]",r="[object Function]",i="[object GeneratorFunction]",o=/^(?:0|[1-9]\d*)$/;var a,s,u=Object.prototype,c=u.hasOwnProperty,l=u.toString,h=u.propertyIsEnumerable,f=(a=Object.keys,s=Object,function(t){return a(s(t))}),d=Math.max,p=!h.call({valueOf:1},"valueOf");function v(t,e){var r=w(t)||function(t){return function(t){return function(t){return!!t&&"object"==b(t)}(t)&&x(t)}(t)&&c.call(t,"callee")&&(!h.call(t,"callee")||l.call(t)==n)}(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],i=r.length,o=!!i;for(var a in t)!e&&!c.call(t,a)||o&&("length"==a||m(a,i))||r.push(a);return r}function y(t,e,n){var r=t[e];c.call(t,e)&&k(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function m(t,n){return!!(n=null==n?e:n)&&("number"==typeof t||o.test(t))&&t>-1&&t%1==0&&t<n}function g(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||u)}function k(t,e){return t===e||t!=t&&e!=e}var w=Array.isArray;function x(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=e}(t.length)&&!function(t){var e=P(t)?l.call(t):"";return e==r||e==i}(t)}function P(t){var e=b(t);return!!t&&("object"==e||"function"==e)}var S=function(t){return e=function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,a&&function(t,e,n){if(!P(n))return!1;var r=b(e);return!!("number"==r?x(n)&&m(e,n.length):"string"==r&&e in n)&&k(n[e],t)}(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var s=n[r];s&&t(e,s,r,o)}return e},n=d(void 0===n?e.length-1:n,0),function(){for(var t=arguments,r=-1,i=d(t.length-n,0),o=Array(i);++r<i;)o[r]=t[n+r];r=-1;for(var a=Array(n+1);++r<n;)a[r]=t[r];return a[n]=o,function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(e,this,a)};var e,n}(function(t,e){if(p||g(e)||x(e))!function(t,e,n,r){n||(n={});for(var i=-1,o=e.length;++i<o;){var a=e[i],s=r?r(n[a],t[a],a,n,t):void 0;y(n,a,void 0===s?t[a]:s)}}(e,function(t){return x(t)?v(t):function(t){if(!g(t))return f(t);var e=[];for(var n in Object(t))c.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}(e),t);else for(var n in e)c.call(e,n)&&y(t,n,e[n])});t.exports=S},2098:function(t,e,n){t=n.nmd(t);var r=200,i="__lodash_hash_undefined__",o=800,a=16,s=9007199254740991,u="[object Arguments]",c="[object AsyncFunction]",l="[object Function]",h="[object GeneratorFunction]",f="[object Null]",d="[object Object]",p="[object Proxy]",v="[object Undefined]",y=/^\[object .+?Constructor\]$/,m=/^(?:0|[1-9]\d*)$/,g={};g["[object Float32Array]"]=g["[object Float64Array]"]=g["[object Int8Array]"]=g["[object Int16Array]"]=g["[object Int32Array]"]=g["[object Uint8Array]"]=g["[object Uint8ClampedArray]"]=g["[object Uint16Array]"]=g["[object Uint32Array]"]=!0,g[u]=g["[object Array]"]=g["[object ArrayBuffer]"]=g["[object Boolean]"]=g["[object DataView]"]=g["[object Date]"]=g["[object Error]"]=g[l]=g["[object Map]"]=g["[object Number]"]=g[d]=g["[object RegExp]"]=g["[object Set]"]=g["[object String]"]=g["[object WeakMap]"]=!1;var k="object"==b(n.g)&&n.g&&n.g.Object===Object&&n.g,w="object"==("undefined"==typeof self?"undefined":b(self))&&self&&self.Object===Object&&self,x=k||w||Function("return this")(),P=e&&!e.nodeType&&e,S=P&&t&&!t.nodeType&&t,T=S&&S.exports===P,O=T&&k.process,_=function(){try{var t=S&&S.require&&S.require("util").types;return t||O&&O.binding&&O.binding("util")}catch(e){}}(),E=_&&_.isTypedArray;function R(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var j,A,C,L=Array.prototype,G=Function.prototype,M=Object.prototype,I=x["__core-js_shared__"],F=G.toString,D=M.hasOwnProperty,N=(j=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"",z=M.toString,V=F.call(Object),W=RegExp("^"+F.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),U=T?x.Buffer:void 0,q=x.Symbol,B=x.Uint8Array,H=U?U.allocUnsafe:void 0,X=(A=Object.getPrototypeOf,C=Object,function(t){return A(C(t))}),$=Object.create,Y=M.propertyIsEnumerable,Z=L.splice,J=q?q.toStringTag:void 0,K=function(){try{var t=St(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),Q=U?U.isBuffer:void 0,tt=Math.max,et=Date.now,nt=St(x,"Map"),rt=St(Object,"create"),it=function(){function t(){}return function(e){if(!It(e))return{};if($)return $(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function ot(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function at(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function st(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function ut(t){var e=this.__data__=new at(t);this.size=e.size}function ct(t,e){var n=At(t),r=!n&&jt(t),i=!n&&!r&&Lt(t),o=!n&&!r&&!i&&Dt(t),a=n||r||i||o,s=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],u=s.length;for(var c in t)!e&&!D.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Tt(c,u))||s.push(c);return s}function lt(t,e,n){(void 0===n||Rt(t[e],n))&&(void 0!==n||e in t)||dt(t,e,n)}function ht(t,e,n){var r=t[e];D.call(t,e)&&Rt(r,n)&&(void 0!==n||e in t)||dt(t,e,n)}function ft(t,e){for(var n=t.length;n--;)if(Rt(t[n][0],e))return n;return-1}function dt(t,e,n){"__proto__"==e&&K?K(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}ot.prototype.clear=function(){this.__data__=rt?rt(null):{},this.size=0},ot.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ot.prototype.get=function(t){var e=this.__data__;if(rt){var n=e[t];return n===i?void 0:n}return D.call(e,t)?e[t]:void 0},ot.prototype.has=function(t){var e=this.__data__;return rt?void 0!==e[t]:D.call(e,t)},ot.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=rt&&void 0===e?i:e,this},at.prototype.clear=function(){this.__data__=[],this.size=0},at.prototype.delete=function(t){var e=this.__data__,n=ft(e,t);return!(n<0||(n==e.length-1?e.pop():Z.call(e,n,1),--this.size,0))},at.prototype.get=function(t){var e=this.__data__,n=ft(e,t);return n<0?void 0:e[n][1]},at.prototype.has=function(t){return ft(this.__data__,t)>-1},at.prototype.set=function(t,e){var n=this.__data__,r=ft(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},st.prototype.clear=function(){this.size=0,this.__data__={hash:new ot,map:new(nt||at),string:new ot}},st.prototype.delete=function(t){var e=Pt(this,t).delete(t);return this.size-=e?1:0,e},st.prototype.get=function(t){return Pt(this,t).get(t)},st.prototype.has=function(t){return Pt(this,t).has(t)},st.prototype.set=function(t,e){var n=Pt(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},ut.prototype.clear=function(){this.__data__=new at,this.size=0},ut.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},ut.prototype.get=function(t){return this.__data__.get(t)},ut.prototype.has=function(t){return this.__data__.has(t)},ut.prototype.set=function(t,e){var n=this.__data__;if(n instanceof at){var i=n.__data__;if(!nt||i.length<r-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new st(i)}return n.set(t,e),this.size=n.size,this};var pt,vt=function(t,e,n){for(var r=-1,i=Object(t),o=n(t),a=o.length;a--;){var s=o[pt?a:++r];if(!1===e(i[s],s,i))break}return t};function yt(t){return null==t?void 0===t?v:f:J&&J in Object(t)?function(t){var e=D.call(t,J),n=t[J];try{t[J]=void 0;var r=!0}catch(o){}var i=z.call(t);r&&(e?t[J]=n:delete t[J]);return i}(t):function(t){return z.call(t)}(t)}function mt(t){return Ft(t)&&yt(t)==u}function gt(t){return!(!It(t)||(e=t,N&&N in e))&&(Gt(t)?W:y).test(function(t){if(null!=t){try{return F.call(t)}catch(e){}try{return t+""}catch(e){}}return""}(t));var e}function kt(t){if(!It(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=Ot(t),n=[];for(var r in t)("constructor"!=r||!e&&D.call(t,r))&&n.push(r);return n}function bt(t,e,n,r,i){t!==e&&vt(e,function(o,a){if(i||(i=new ut),It(o))!function(t,e,n,r,i,o,a){var s=_t(t,n),u=_t(e,n),c=a.get(u);if(c)return void lt(t,n,c);var l=o?o(s,u,n+"",t,e,a):void 0,h=void 0===l;if(h){var f=At(u),p=!f&&Lt(u),v=!f&&!p&&Dt(u);l=u,f||p||v?At(s)?l=s:Ft(b=s)&&Ct(b)?l=function(t,e){var n=-1,r=t.length;e||(e=Array(r));for(;++n<r;)e[n]=t[n];return e}(s):p?(h=!1,l=function(t,e){if(e)return t.slice();var n=t.length,r=H?H(n):new t.constructor(n);return t.copy(r),r}(u,!0)):v?(h=!1,y=u,m=!0?(g=y.buffer,k=new g.constructor(g.byteLength),new B(k).set(new B(g)),k):y.buffer,l=new y.constructor(m,y.byteOffset,y.length)):l=[]:function(t){if(!Ft(t)||yt(t)!=d)return!1;var e=X(t);if(null===e)return!0;var n=D.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&F.call(n)==V}(u)||jt(u)?(l=s,jt(s)?l=function(t){return function(t,e,n,r){var i=!n;n||(n={});var o=-1,a=e.length;for(;++o<a;){var s=e[o],u=r?r(n[s],t[s],s,n,t):void 0;void 0===u&&(u=t[s]),i?dt(n,s,u):ht(n,s,u)}return n}(t,zt(t))}(s):It(s)&&!Gt(s)||(l=function(t){return"function"!=typeof t.constructor||Ot(t)?{}:it(X(t))}(u))):h=!1}var y,m,g,k;var b;h&&(a.set(u,l),i(l,u,r,o,a),a.delete(u));lt(t,n,l)}(t,e,a,n,bt,r,i);else{var s=r?r(_t(t,a),o,a+"",t,e,i):void 0;void 0===s&&(s=o),lt(t,a,s)}},zt)}function wt(t,e){return Et(function(t,e,n){return e=tt(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=tt(r.length-e,0),a=Array(o);++i<o;)a[i]=r[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=r[i];return s[e]=n(a),R(t,this,s)}}(t,e,Ut),t+"")}function xt(t,e,n,r,i,o){return It(t)&&It(e)&&(o.set(e,t),bt(t,e,void 0,xt,o),o.delete(e)),t}function Pt(t,e){var n,r,i=t.__data__;return("string"==(r=b(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function St(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return gt(n)?n:void 0}function Tt(t,e){var n=b(t);return!!(e=null==e?s:e)&&("number"==n||"symbol"!=n&&m.test(t))&&t>-1&&t%1==0&&t<e}function Ot(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||M)}function _t(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Et=function(t){var e=0,n=0;return function(){var r=et(),i=a-(r-n);if(n=r,i>0){if(++e>=o)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(K?function(t,e){return K(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:Ut);function Rt(t,e){return t===e||t!=t&&e!=e}var jt=mt(function(){return arguments}())?mt:function(t){return Ft(t)&&D.call(t,"callee")&&!Y.call(t,"callee")},At=Array.isArray;function Ct(t){return null!=t&&Mt(t.length)&&!Gt(t)}var Lt=Q||function(){return!1};function Gt(t){if(!It(t))return!1;var e=yt(t);return e==l||e==h||e==c||e==p}function Mt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=s}function It(t){var e=b(t);return null!=t&&("object"==e||"function"==e)}function Ft(t){return null!=t&&"object"==b(t)}var Dt=E?function(t){return function(e){return t(e)}}(E):function(t){return Ft(t)&&Mt(t.length)&&!!g[yt(t)]};var Nt=wt(function(t){return t.push(void 0,xt),R(Wt,void 0,t)});function zt(t){return Ct(t)?ct(t,!0):kt(t)}var Vt,Wt=(Vt=function(t,e,n,r){bt(t,e,n,r)},wt(function(t,e){var n=-1,r=e.length,i=r>1?e[r-1]:void 0,o=r>2?e[2]:void 0;for(i=Vt.length>3&&"function"==typeof i?(r--,i):void 0,o&&function(t,e,n){if(!It(n))return!1;var r=b(e);return!!("number"==r?Ct(n)&&Tt(e,n.length):"string"==r&&e in n)&&Rt(n[e],t)}(e[0],e[1],o)&&(i=r<3?void 0:i,r=1),t=Object(t);++n<r;){var a=e[n];a&&Vt(t,a,n,i)}return t}));function Ut(t){return t}t.exports=Nt},3520:function(t){var e=9007199254740991,n="[object Arguments]",r="[object Function]",i="[object GeneratorFunction]",o=/^(?:0|[1-9]\d*)$/;var a,s,u=Object.prototype,c=u.hasOwnProperty,l=u.toString,h=u.propertyIsEnumerable,f=(a=Object.keys,s=Object,function(t){return a(s(t))});function d(t,e){var r=g(t)||function(t){return function(t){return function(t){return!!t&&"object"==b(t)}(t)&&k(t)}(t)&&c.call(t,"callee")&&(!h.call(t,"callee")||l.call(t)==n)}(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],i=r.length,o=!!i;for(var a in t)!e&&!c.call(t,a)||o&&("length"==a||m(a,i))||r.push(a);return r}var p,v=function(t,e,n){for(var r=-1,i=Object(t),o=n(t),a=o.length;a--;){var s=o[p?a:++r];if(!1===e(i[s],s,i))break}return t};function y(t){if(n=(e=t)&&e.constructor,r="function"==typeof n&&n.prototype||u,e!==r)return f(t);var e,n,r,i=[];for(var o in Object(t))c.call(t,o)&&"constructor"!=o&&i.push(o);return i}function m(t,n){return!!(n=null==n?e:n)&&("number"==typeof t||o.test(t))&&t>-1&&t%1==0&&t<n}var g=Array.isArray;function k(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=e}(t.length)&&!function(t){var e=function(t){var e=b(t);return!!t&&("object"==e||"function"==e)}(t)?l.call(t):"";return e==r||e==i}(t)}function w(t){return k(t)?d(t):y(t)}function x(t){return t}t.exports=function(t,e){return t&&function(t,e){return t&&v(t,e,w)}(t,"function"==typeof e?e:x)}},372:function(t,e,n){"use strict";var r=n(6060);t.exports=function(t){if("function"!=typeof t)return!1;if(!hasOwnProperty.call(t,"length"))return!1;try{if("number"!=typeof t.length)return!1;if("function"!=typeof t.call)return!1;if("function"!=typeof t.apply)return!1}catch(e){return!1}return!r(t)}},3940:function(t,e,n){"use strict";var r=n(5618),i={object:!0,function:!0,undefined:!0};t.exports=function(t){return!!r(t)&&hasOwnProperty.call(i,b(t))}},7205:function(t,e,n){"use strict";var r=n(372),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;t.exports=function(t){return!!r(t)&&!i.test(o.call(t))}},6060:function(t,e,n){"use strict";var r=n(3940);t.exports=function(t){if(!r(t))return!1;try{return!!t.constructor&&t.constructor.prototype===t}catch(e){return!1}}},5618:function(t){"use strict";t.exports=function(t){return null!=t}},4935:function(t,e,n){var r=n(3513);t.exports=r},7921:function(t,e,n){var r=n(3072);t.exports=r},347:function(t,e,n){var r=n(8744);t.exports=r},9720:function(t,e,n){var r=n(6943);t.exports=r},6672:function(t,e,n){var r=n(6240),i=n(7265);function o(t,e,n,r){if(r){var o=r[e];if(i(o))o.unhook&&o.unhook(t,e,n);else if("attributes"===e)for(var a in o)t.removeAttribute(a);else if("style"===e)for(var s in o)t.style[s]="";else t[e]="string"==typeof o?"":null}}function a(t,e,n,i,o){var a=n?n[i]:void 0;if("attributes"!==i)if(a&&r(a)&&s(a)!==s(o))t[i]=o;else{r(t[i])||(t[i]={});var u="style"===i?"":void 0;for(var c in o){var l=o[c];t[i][c]=void 0===l?u:l}}else for(var h in o){var f=o[h];void 0===f?t.removeAttribute(h):t.setAttribute(h,f)}}function s(t){return Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__?t.__proto__:t.constructor?t.constructor.prototype:void 0}t.exports=function(t,e,n){for(var s in e){var u=e[s];void 0===u?o(t,s,u,n):i(u)?(o(t,s,u,n),u.hook&&u.hook(t,s,n?n[s]:void 0)):r(u)?a(t,e,n,s,u):t[s]=u}}},3513:function(t,e,n){var r=n(9144),i=n(6672),o=n(5170),a=n(6221),s=n(4097),u=n(6078);t.exports=function t(e,n){var c=n&&n.document||r;var l=n?n.warn:null;e=u(e).a;if(s(e))return e.init();if(a(e))return c.createTextNode(e.text);if(!o(e))return l&&l("Item is not a valid virtual dom node",e),null;var h=null===e.namespace?c.createElement(e.tagName):c.createElementNS(e.namespace,e.tagName);var f=e.properties;i(h,f);var d=e.children;for(var p=0;p<d.length;p++){var v=t(d[p],n);v&&h.appendChild(v)}return h}},8992:function(t){var e={};function n(t,e,n){if(0===t.length)return!1;for(var r,i,o=0,a=t.length-1;o<=a;){if(i=t[r=(a+o)/2>>0],o===a)return i>=e&&i<=n;if(i<e)o=r+1;else{if(!(i>n))return!0;a=r-1}}return!1}function r(t,e){return t>e?1:-1}t.exports=function(t,i,o,a){return o&&0!==o.length?(o.sort(r),function t(r,i,o,a,s){a=a||{};if(r){n(o,s,s)&&(a[s]=r);var u=i.children;if(u)for(var c=r.childNodes,l=0;l<i.children.length;l++){s+=1;var h=u[l]||e,f=s+(h.count||0);n(o,s,f)&&t(c[l],h,o,a,s),s=f}}return a}(t,i,o,a,0)):{}}},9120:function(t,e,n){var r=n(6672),i=n(4097),o=n(8057),a=n(6670);function s(t,e){"function"==typeof e.destroy&&i(e)&&e.destroy(t)}t.exports=function(t,e,n){var i=t.type,u=t.vNode,c=t.patch;switch(i){case o.REMOVE:return function(t,e){var n=t.parentNode;n&&n.removeChild(t);return s(t,e),null}(e,u);case o.INSERT:return function(t,e,n){var r=n.render(e,n);t&&t.appendChild(r);return t}(e,c,n);case o.VTEXT:return function(t,e,n,r){var i;if(3===t.nodeType)t.replaceData(0,t.length,n.text),i=t;else{var o=t.parentNode;i=r.render(n,r),o&&i!==t&&o.replaceChild(i,t)}return i}(e,0,c,n);case o.WIDGET:return function(t,e,n,r){var i,o=a(e,n);i=o?n.update(e,t)||t:r.render(n,r);var u=t.parentNode;u&&i!==t&&u.replaceChild(i,t);o||s(t,e);return i}(e,u,c,n);case o.VNODE:return function(t,e,n,r){var i=t.parentNode,o=r.render(n,r);i&&o!==t&&i.replaceChild(o,t);return o}(e,0,c,n);case o.ORDER:return function(t,e){for(var n,r,i,o=t.childNodes,a={},s=0;s<e.removes.length;s++)r=e.removes[s],n=o[r.from],r.key&&(a[r.key]=n),t.removeChild(n);for(var u=o.length,c=0;c<e.inserts.length;c++)i=e.inserts[c],n=a[i.key],t.insertBefore(n,i.to>=u++?null:o[i.to])}(e,c),e;case o.PROPS:return r(e,c,u.properties),e;case o.THUNK:return function(t,e){t&&e&&t!==e&&t.parentNode&&t.parentNode.replaceChild(e,t);return e}(e,n.patch(e,c,n));default:return e}}},6943:function(t,e,n){var r=n(9144),i=n(7362),o=n(3513),a=n(8992),s=n(9120);function u(t,e,n){var i=function(t){var e=[];for(var n in t)"a"!==n&&e.push(Number(n));return e}(e);if(0===i.length)return t;var o=a(t,e.a,i),s=t.ownerDocument;n.document||s===r||(n.document=s);for(var u=0;u<i.length;u++){var l=i[u];t=c(t,o[l],e[l],n)}return t}function c(t,e,n,r){if(!e)return t;var o;if(i(n))for(var a=0;a<n.length;a++)o=s(n[a],e,r),e===t&&(t=o);else o=s(n,e,r),e===t&&(t=o);return t}t.exports=function t(e,n,r){r=r||{};r.patch=r.patch&&r.patch!==t?r.patch:u;r.render=r.render||o;return r.patch(e,n,r)}},6670:function(t,e,n){var r=n(4097);t.exports=function(t,e){if(r(t)&&r(e))return"name"in t&&"name"in e?t.id===e.id:t.init===e.init;return!1}},6505:function(t,e,n){"use strict";var r=n(8832);function i(t){if(!(this instanceof i))return new i(t);this.value=t}t.exports=i,i.prototype.hook=function(t,e){r(t)[e.substr(3)]=this.value},i.prototype.unhook=function(t,e){r(t)[e.substr(3)]=void 0}},7199:function(t){"use strict";function e(t){if(!(this instanceof e))return new e(t);this.value=t}t.exports=e,e.prototype.hook=function(t,e){t[e]!==this.value&&(t[e]=this.value)}},8744:function(t,e,n){"use strict";var r=n(7362),i=n(4282),o=n(4268),a=n(5170),s=n(6221),u=n(4097),c=n(7265),l=n(6741),h=n(1948),f=n(7199),d=n(6505);function p(t){return a(t)||s(t)||u(t)||l(t)}function v(t){try{return JSON.stringify(t,null,"    ")}catch(e){return String(t)}}t.exports=function(t,e,n){var a,s,u,l,y=[];!n&&(m=e,"string"==typeof m||r(m)||p(m))&&(n=e,s={});var m;a=h(t,s=s||e||{}),s.hasOwnProperty("key")&&(u=s.key,s.key=void 0);s.hasOwnProperty("namespace")&&(l=s.namespace,s.namespace=void 0);"INPUT"!==a||l||!s.hasOwnProperty("value")||void 0===s.value||c(s.value)||(s.value=f(s.value));(function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];if(c(n))continue;"ev-"===e.substr(0,3)&&(t[e]=d(n))}})(s),null!=n&&function t(e,n,i,a){if("string"==typeof e)n.push(new o(e));else if("number"==typeof e)n.push(new o(String(e)));else if(p(e))n.push(e);else{if(!r(e)){if(null==e)return;throw u={foreignObject:e,parentVnode:{tagName:i,properties:a}},(c=new Error).type="virtual-hyperscript.unexpected.virtual-element",c.message="Unexpected virtual child passed to h().\nExpected a VNode / Vthunk / VWidget / string but:\ngot:\n"+v(u.foreignObject)+".\nThe parent vnode is:\n"+v(u.parentVnode),c.foreignObject=u.foreignObject,c.parentVnode=u.parentVnode,c}for(var s=0;s<e.length;s++)t(e[s],n,i,a)}var u,c}(n,y,a,s);return new i(a,s,y,u,l)}},1948:function(t,e,n){"use strict";var r=n(6824),i=/([\.#]?[a-zA-Z0-9\u007F-\uFFFF_:-]+)/,o=/^\.|#/;t.exports=function(t,e){if(!t)return"DIV";var n,a,s,u,c=!e.hasOwnProperty("id"),l=r(t,i),h=null;o.test(l[1])&&(h="DIV");for(u=0;u<l.length;u++)(a=l[u])&&(s=a.charAt(0),h?"."===s?(n=n||[]).push(a.substring(1,a.length)):"#"===s&&c&&(e.id=a.substring(1,a.length)):h=a);n&&(e.className&&n.push(e.className),e.className=n.join(" "));return e.namespace?h:h.toUpperCase()}},6078:function(t,e,n){var r=n(5170),i=n(6221),o=n(4097),a=n(6741);function s(t,e){var n=t.vnode;if(n||(n=t.vnode=t.render(e)),!(r(n)||i(n)||o(n)))throw new Error("thunk did not return a valid node");return n}t.exports=function(t,e){var n=t,r=e;a(e)&&(r=s(e,t));a(t)&&(n=s(t,null));return{a:n,b:r}}},6741:function(t){t.exports=function(t){return t&&"Thunk"===t.type}},7265:function(t){t.exports=function(t){return t&&("function"==typeof t.hook&&!t.hasOwnProperty("hook")||"function"==typeof t.unhook&&!t.hasOwnProperty("unhook"))}},5170:function(t,e,n){var r=n(9962);t.exports=function(t){return t&&"VirtualNode"===t.type&&t.version===r}},6221:function(t,e,n){var r=n(9962);t.exports=function(t){return t&&"VirtualText"===t.type&&t.version===r}},4097:function(t){t.exports=function(t){return t&&"Widget"===t.type}},9962:function(t){t.exports="2"},4282:function(t,e,n){var r=n(9962),i=n(5170),o=n(4097),a=n(6741),s=n(7265);t.exports=l;var u={},c=[];function l(t,e,n,r,l){this.tagName=t,this.properties=e||u,this.children=n||c,this.key=null!=r?String(r):void 0,this.namespace="string"==typeof l?l:null;var h,f=n&&n.length||0,d=0,p=!1,v=!1,y=!1;for(var m in e)if(e.hasOwnProperty(m)){var g=e[m];s(g)&&g.unhook&&(h||(h={}),h[m]=g)}for(var k=0;k<f;k++){var b=n[k];i(b)?(d+=b.count||0,!p&&b.hasWidgets&&(p=!0),!v&&b.hasThunks&&(v=!0),y||!b.hooks&&!b.descendantHooks||(y=!0)):!p&&o(b)?"function"==typeof b.destroy&&(p=!0):!v&&a(b)&&(v=!0)}this.count=f+d,this.hasWidgets=p,this.hasThunks=v,this.hooks=h,this.descendantHooks=y}l.prototype.version=r,l.prototype.type="VirtualNode"},8057:function(t,e,n){var r=n(9962);function i(t,e,n){this.type=Number(t),this.vNode=e,this.patch=n}i.NONE=0,i.VTEXT=1,i.VNODE=2,i.WIDGET=3,i.PROPS=4,i.ORDER=5,i.INSERT=6,i.REMOVE=7,i.THUNK=8,t.exports=i,i.prototype.version=r,i.prototype.type="VirtualPatch"},4268:function(t,e,n){var r=n(9962);function i(t){this.text=String(t)}t.exports=i,i.prototype.version=r,i.prototype.type="VirtualText"},9973:function(t,e,n){var r=n(6240),i=n(7265);function o(t){return Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__?t.__proto__:t.constructor?t.constructor.prototype:void 0}t.exports=function t(e,n){var a;for(var s in e){s in n||((a=a||{})[s]=void 0);var u=e[s],c=n[s];if(u!==c)if(r(u)&&r(c))if(o(c)!==o(u))(a=a||{})[s]=c;else if(i(c))(a=a||{})[s]=c;else{var l=t(u,c);l&&((a=a||{})[s]=l)}else(a=a||{})[s]=c}for(var h in n)h in e||((a=a||{})[h]=n[h]);return a}},3072:function(t,e,n){var r=n(7362),i=n(8057),o=n(5170),a=n(6221),s=n(4097),u=n(6741),c=n(6078),l=n(9973);function h(t,e){var n={a:t};return f(t,e,n,0),n}function f(t,e,n,r){if(t!==e){var c=n[r],h=!1;if(u(t)||u(e))p(t,e,n,r);else if(null==e)s(t)||(d(t,n,r),c=n[r]),c=m(c,new i(i.REMOVE,t,e));else if(o(e))if(o(t))if(t.tagName===e.tagName&&t.namespace===e.namespace&&t.key===e.key){var g=l(t.properties,e.properties);g&&(c=m(c,new i(i.PROPS,t,g))),c=function(t,e,n,r,a){for(var s=t.children,u=function(t,e){var n=y(e),r=n.keys,i=n.free;if(i.length===e.length)return{children:e,moves:null};var o=y(t),a=o.keys;if(o.free.length===t.length)return{children:e,moves:null};for(var s=[],u=0,c=i.length,l=0,h=0;h<t.length;h++){var f,d=t[h];d.key?r.hasOwnProperty(d.key)?(f=r[d.key],s.push(e[f])):(f=h-l++,s.push(null)):u<c?(f=i[u++],s.push(e[f])):(f=h-l++,s.push(null))}for(var p=u>=i.length?e.length:i[u],m=0;m<e.length;m++){var g=e[m];g.key?a.hasOwnProperty(g.key)||s.push(g):m>=p&&s.push(g)}for(var k,b=s.slice(),w=0,x=[],P=[],S=0;S<e.length;){var T=e[S];for(k=b[w];null===k&&b.length;)x.push(v(b,w,null)),k=b[w];k&&k.key===T.key?(w++,S++):T.key?(k&&k.key&&r[k.key]!==S+1?(x.push(v(b,w,k.key)),(k=b[w])&&k.key===T.key?w++:P.push({key:T.key,to:S})):P.push({key:T.key,to:S}),S++):k&&k.key&&x.push(v(b,w,k.key))}for(;w<b.length;)k=b[w],x.push(v(b,w,k&&k.key));if(x.length===l&&!P.length)return{children:s,moves:null};return{children:s,moves:{removes:x,inserts:P}}}(s,e.children),c=u.children,l=s.length,h=c.length,d=l>h?l:h,p=0;p<d;p++){var g=s[p],k=c[p];a+=1,g?f(g,k,n,a):k&&(r=m(r,new i(i.INSERT,null,k))),o(g)&&g.count&&(a+=g.count)}u.moves&&(r=m(r,new i(i.ORDER,t,u.moves)));return r}(t,e,n,c,r)}else c=m(c,new i(i.VNODE,t,e)),h=!0;else c=m(c,new i(i.VNODE,t,e)),h=!0;else a(e)?a(t)?t.text!==e.text&&(c=m(c,new i(i.VTEXT,t,e))):(c=m(c,new i(i.VTEXT,t,e)),h=!0):s(e)&&(s(t)||(h=!0),c=m(c,new i(i.WIDGET,t,e)));c&&(n[r]=c),h&&d(t,n,r)}}function d(t,e,n){!function t(e,n,r){if(o(e)){if(e.hooks&&(n[r]=m(n[r],new i(i.PROPS,e,function(t){var e={};for(var n in t)e[n]=void 0;return e}(e.hooks)))),e.descendantHooks||e.hasThunks)for(var a=e.children,s=a.length,c=0;c<s;c++){var l=a[c];t(l,n,r+=1),o(l)&&l.count&&(r+=l.count)}}else u(e)&&p(e,null,n,r)}(t,e,n),function t(e,n,r){if(s(e))"function"==typeof e.destroy&&(n[r]=m(n[r],new i(i.REMOVE,e,null)));else if(o(e)&&(e.hasWidgets||e.hasThunks))for(var a=e.children,c=a.length,l=0;l<c;l++){var h=a[l];t(h,n,r+=1),o(h)&&h.count&&(r+=h.count)}else u(e)&&p(e,null,n,r)}(t,e,n)}function p(t,e,n,r){var o=c(t,e),a=h(o.a,o.b);(function(t){for(var e in t)if("a"!==e)return!0;return!1})(a)&&(n[r]=new i(i.THUNK,null,a))}function v(t,e,n){return t.splice(e,1),{from:e,key:n}}function y(t){for(var e={},n=[],r=t.length,i=0;i<r;i++){var o=t[i];o.key?e[o.key]=i:n.push(i)}return{keys:e,free:n}}function m(t,e){return t?(r(t)?t.push(e):t=[t,e],t):e}t.exports=h},4991:function(t){"use strict";function e(t){for(var e,n=1/0,r=-1/0,i=0,o=t.length;i<o;i++)n>(e=t[i])&&(n=e),r<e&&(r=e);return{min:n,max:r}}function n(t,e){var n=Math.pow(2,e-1),r=t<0?t*n:t*(n-1);return Math.max(-n,Math.min(n-1,r))}function r(t,r,o){var a,s,u,c,l,h,f=t.length,d=Math.ceil(f/r),p=i(o,2*d);for(a=0;a<d;a++)s=a*r,u=(a+1)*r>f?f:(a+1)*r,l=n((h=e(t.subarray(s,u))).min,o),c=n(h.max,o),p[2*a]=l,p[2*a+1]=c;return p}function i(t,e){return new(new Function("return Int".concat(t,"Array"))())(e)}function o(t,e){return"number"==typeof t?t:e}t.exports=function(t,e,n,a,s,u){if(e=o(e,1e3),u=o(u,16),null==n&&(n=!0),[8,16,32].indexOf(u)<0)throw new Error("Invalid number of bits specified for peaks.");var c,l,h=t.numberOfChannels,f=[];if(a=o(a,0),s=o(s,t.length),void 0===t.subarray)for(c=0;c<h;c++)l=t.getChannelData(c).subarray(a,s),f.push(r(l,e,u));else f.push(r(t.subarray(a,s),e,u));return n&&f.length>1&&(f=function(t,e){var n,r,o=t.length,a=1/o,s=t[0].length/2,u=0,c=0,l=i(e,2*s);for(c=0;c<s;c++){for(n=0,r=0,u=0;u<o;u++)n+=a*t[u][2*c],r+=a*t[u][2*c+1];l[2*c]=n,l[2*c+1]=r}return[l]}(f,u)),{length:f[0].length/2,data:f,bits:u}}},7362:function(t){var e=Array.isArray,n=Object.prototype.toString;t.exports=e||function(t){return"[object Array]"===n.call(t)}},5893:function(){}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r](o,o.exports,n),o.loaded=!0,o.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"===("undefined"==typeof globalThis?"undefined":b(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===("undefined"==typeof window?"undefined":b(window)))return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t};var i={};return function(){"use strict";n.r(i),n.d(i,{default:function(){return pt},init:function(){return dt}});var t=n(2098),e=n.n(t),s=n(4935),c=n.n(s),h=n(8370),f=n.n(h),d=n(347),y=n.n(d),g=n(7921),k=n.n(g),b=n(9720),w=n.n(b),x=n(849),P=n.n(x);function S(t,e){return Math.ceil(t*e)}function T(t,e,n){return t*e/n}function O(t,e,n){return Math.ceil(t*n/e)}var _,E=0,R=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f()();v(this,t),this.src=e,this.ac=n,this.audioRequestState=E,this.ee=r}return m(t,[{key:"setStateChange",value:function(t){this.audioRequestState=t,this.ee.emit("audiorequeststatechange",this.audioRequestState,this.src)}},{key:"fileProgress",value:function(t){var e=0;this.audioRequestState===E&&this.setStateChange(1),t.lengthComputable&&(e=t.loaded/t.total*100),this.ee.emit("loadprogress",e,this.src)}},{key:"fileLoad",value:function(t){var e=this,n=t.target.response||t.target.result;return this.setStateChange(2),new Promise(function(t,r){e.ac.decodeAudioData(n,function(n){e.audioBuffer=n,e.setStateChange(3),t(n)},function(t){r(null===t?Error("MediaDecodeAudioDataUnknownContentType"):t)})})}}]),t}(),j=function(t){u(n,R);var e=l(n);function n(){return v(this,n),e.apply(this,arguments)}return m(n,[{key:"load",value:function(){var t=this;return new Promise(function(e,r){if(t.src.type.match(/audio.*/)||t.src.type.match(/video\/ogg/)){var i=new FileReader;i.readAsArrayBuffer(t.src),i.addEventListener("progress",function(e){a(p(n.prototype),"fileProgress",t).call(t,e)}),i.addEventListener("load",function(i){a(p(n.prototype),"fileLoad",t).call(t,i).then(function(t){e(t)}).catch(r)}),i.addEventListener("error",r)}else r(Error("Unsupported file type ".concat(t.src.type)))})}}]),n}(),A=function(t){u(n,R);var e=l(n);function n(){return v(this,n),e.apply(this,arguments)}return m(n,[{key:"load",value:function(){return Promise.resolve(this.src)}}]),n}(),C=function(t){u(n,R);var e=l(n);function n(){return v(this,n),e.apply(this,arguments)}return m(n,[{key:"load",value:function(){var t=this;return new Promise(function(e,r){var i=new XMLHttpRequest;i.open("GET",t.src,!0),i.responseType="arraybuffer",i.send(),i.addEventListener("progress",function(e){a(p(n.prototype),"fileProgress",t).call(t,e)}),i.addEventListener("load",function(i){a(p(n.prototype),"fileLoad",t).call(t,i).then(function(t){e(t)}).catch(r)}),i.addEventListener("error",function(){r(Error("Track ".concat(t.src," failed to load")))})})}}]),n}(),L=function(){function t(){v(this,t)}return m(t,null,[{key:"createLoader",value:function(t,e,n){if(t instanceof Blob)return new j(t,e,n);if(t instanceof AudioBuffer)return new A(t,e,n);if("string"==typeof t)return new C(t,e,n);throw new Error("Unsupported src type")}}]),t}(),G=function(){function t(e){v(this,t),this.playlist=e}return m(t,[{key:"hook",value:function(t){var e=this.playlist;if(!e.isScrolling){var n=t;if(e.isAutomaticScroll){var r=t.getBoundingClientRect(),i=e.controls.show?e.controls.width:0,o=T(r.width-i,e.samplesPerPixel,e.sampleRate),a=e.isPlaying()?e.playbackSeconds:e.getTimeSelection().start;(a<e.scrollLeft||a>=e.scrollLeft+o)&&(e.scrollLeft=Math.min(a,e.duration-o))}var s=O(e.scrollLeft,e.samplesPerPixel,e.sampleRate);n.scrollLeft=s}}}]),t}(),M=function(){function t(e,n,r,i,o){v(this,t),this.tickInfo=e,this.offset=n,this.samplesPerPixel=r,this.duration=i,this.colors=o}return m(t,[{key:"hook",value:function(t,e,n){var r=this;if(void 0===n||n.offset!==this.offset||n.duration!==this.duration||n.samplesPerPixel!==this.samplesPerPixel){var i=t.width,o=t.height,a=t.getContext("2d");a.clearRect(0,0,i,o),a.fillStyle=this.colors.timeColor,Object.keys(this.tickInfo).forEach(function(t){var e=r.tickInfo[t],n=o-e;a.fillRect(t,n,1,e)})}}}]),t}(),I=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0;v(this,t),this.duration=e,this.offset=n,this.samplesPerPixel=r,this.sampleRate=i,this.marginLeft=o,this.colors=a,this.timeinfo={20000:{marker:3e4,bigStep:1e4,smallStep:5e3,secondStep:5},12000:{marker:15e3,bigStep:5e3,smallStep:1e3,secondStep:1},10000:{marker:1e4,bigStep:5e3,smallStep:1e3,secondStep:1},5000:{marker:5e3,bigStep:1e3,smallStep:500,secondStep:.5},2500:{marker:2e3,bigStep:1e3,smallStep:500,secondStep:.5},1500:{marker:2e3,bigStep:1e3,smallStep:200,secondStep:.2},700:{marker:1e3,bigStep:500,smallStep:100,secondStep:.1}}}return m(t,[{key:"getScaleInfo",value:function(t){var e=Object.keys(this.timeinfo).map(function(t){return parseInt(t,10)});e=e.sort(function(t,e){return t-e});for(var n=0;n<e.length;n+=1)if(t<=e[n])return this.timeinfo[e[n]];return this.timeinfo[e[0]]}},{key:"render",value:function(){for(var e=O(this.duration,this.samplesPerPixel,this.sampleRate),n=this.sampleRate/this.samplesPerPixel,r=O(this.offset,this.samplesPerPixel,this.sampleRate),i=this.getScaleInfo(this.samplesPerPixel),o={},a=[],s=e+r,u=0,c=0;c<s;c+=n*i.secondStep){var l=Math.floor(c),h=l-r;l>=r&&(i.marker&&u%i.marker==0?(a.push(y()("div.time",{attributes:{style:"position: absolute; left: ".concat(h,"px;")}},[t.formatTime(u)])),o[h]=10):i.bigStep&&u%i.bigStep==0?o[h]=5:i.smallStep&&u%i.smallStep==0&&(o[h]=2)),u+=1e3*i.secondStep}return y()("div.playlist-time-scale",{attributes:{style:"position: relative; left: 0; right: 0; margin-left: ".concat(this.marginLeft,"px;")}},[a,y()("canvas",{attributes:{width:e,height:30,style:"position: absolute; left: 0; right: 0; top: 0; bottom: 0;"},hook:new M(o,this.offset,this.samplesPerPixel,this.duration,this.colors)})])}}],[{key:"formatTime",value:function(t){var e=t/1e3,n=e%60,r=(e-n)/60;return n<10&&(n="0".concat(n)),"".concat(r,":").concat(n)}}]),t}(),F=n(1730),D=n.n(F),N=n(3520),z=n.n(N),V=new Uint8Array(16);var W=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var U=function(t){return"string"==typeof t&&W.test(t)},q=[],B=0;B<256;++B)q.push((B+256).toString(16).substr(1));var H=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(q[t[e+0]]+q[t[e+1]]+q[t[e+2]]+q[t[e+3]]+"-"+q[t[e+4]]+q[t[e+5]]+"-"+q[t[e+6]]+q[t[e+7]]+"-"+q[t[e+8]]+q[t[e+9]]+"-"+q[t[e+10]]+q[t[e+11]]+q[t[e+12]]+q[t[e+13]]+q[t[e+14]]+q[t[e+15]]).toLowerCase();if(!U(n))throw TypeError("Stringified UUID is invalid");return n};var X=function(t,e,n){var r=(t=t||{}).random||(t.rng||function(){if(!_&&!(_="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return _(V)})();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return H(r)},$=n(4991),Y=n.n($),Z=n(1114),J={cursor:function(){function t(e){v(this,t),this.track=e}return m(t,[{key:"setup",value:function(t,e){this.samplesPerPixel=t,this.sampleRate=e}},{key:"click",value:function(t){t.preventDefault();var e=T(t.offsetX,this.samplesPerPixel,this.sampleRate);this.track.ee.emit("select",e,e,this.track)}}],[{key:"getClass",value:function(){return".state-cursor"}},{key:"getEvents",value:function(){return["click"]}}]),t}(),select:function(){function t(e){v(this,t),this.track=e,this.active=!1}return m(t,[{key:"setup",value:function(t,e){this.samplesPerPixel=t,this.sampleRate=e}},{key:"emitSelection",value:function(t){var e=Math.min(t,this.startX),n=Math.max(t,this.startX),r=T(e,this.samplesPerPixel,this.sampleRate),i=T(n,this.samplesPerPixel,this.sampleRate);this.track.ee.emit("select",r,i,this.track)}},{key:"complete",value:function(t){this.emitSelection(t),this.active=!1}},{key:"mousedown",value:function(t){t.preventDefault(),this.active=!0,this.startX=t.offsetX;var e=T(this.startX,this.samplesPerPixel,this.sampleRate);this.track.ee.emit("select",e,e,this.track)}},{key:"mousemove",value:function(t){this.active&&(t.preventDefault(),this.emitSelection(t.offsetX))}},{key:"mouseup",value:function(t){this.active&&(t.preventDefault(),this.complete(t.offsetX))}},{key:"mouseleave",value:function(t){this.active&&(t.preventDefault(),this.complete(t.offsetX))}}],[{key:"getClass",value:function(){return".state-select"}},{key:"getEvents",value:function(){return["mousedown","mousemove","mouseup","mouseleave"]}}]),t}(),shift:function(){function t(e){v(this,t),this.track=e,this.active=!1}return m(t,[{key:"setup",value:function(t,e){this.samplesPerPixel=t,this.sampleRate=e}},{key:"emitShift",value:function(t){var e=T(t-this.prevX,this.samplesPerPixel,this.sampleRate);this.prevX=t,this.track.ee.emit("shift",e,this.track)}},{key:"complete",value:function(t){this.emitShift(t),this.active=!1}},{key:"mousedown",value:function(t){t.preventDefault(),this.active=!0,this.el=t.target,this.prevX=t.offsetX}},{key:"mousemove",value:function(t){this.active&&(t.preventDefault(),this.emitShift(t.offsetX))}},{key:"mouseup",value:function(t){this.active&&(t.preventDefault(),this.complete(t.offsetX))}},{key:"mouseleave",value:function(t){this.active&&(t.preventDefault(),this.complete(t.offsetX))}}],[{key:"getClass",value:function(){return".state-shift"}},{key:"getEvents",value:function(){return["mousedown","mousemove","mouseup","mouseleave"]}}]),t}(),fadein:function(){function t(e){v(this,t),this.track=e}return m(t,[{key:"setup",value:function(t,e){this.samplesPerPixel=t,this.sampleRate=e}},{key:"click",value:function(t){var e=T(t.offsetX,this.samplesPerPixel,this.sampleRate);e>this.track.getStartTime()&&e<this.track.getEndTime()&&this.track.ee.emit("fadein",e-this.track.getStartTime(),this.track)}}],[{key:"getClass",value:function(){return".state-fadein"}},{key:"getEvents",value:function(){return["click"]}}]),t}(),fadeout:function(){function t(e){v(this,t),this.track=e}return m(t,[{key:"setup",value:function(t,e){this.samplesPerPixel=t,this.sampleRate=e}},{key:"click",value:function(t){var e=T(t.offsetX,this.samplesPerPixel,this.sampleRate);e>this.track.getStartTime()&&e<this.track.getEndTime()&&this.track.ee.emit("fadeout",this.track.getEndTime()-e,this.track)}}],[{key:"getClass",value:function(){return".state-fadeout"}},{key:"getEvents",value:function(){return["click"]}}]),t}()},K=function(){function t(e,n,r,i,o,a,s,u){v(this,t),this.peaks=e,this.offset=n,this.color=i,this.bits=r,this.scale=o,this.height=a,this.barWidth=s,this.barGap=u}return m(t,[{key:"hook",value:function(e,n,r){if(void 0===r||r.peaks!==this.peaks||r.scale!==this.scale||r.height!==this.height){var i=this.scale,o=e.width/i,a=e.getContext("2d"),s=e.height/i/2,u=Math.pow(2,this.bits-1),c=this.barWidth,l=this.barGap,h=c+l;a.clearRect(0,0,e.width,e.height),a.save(),a.fillStyle=this.color,a.scale(i,i);for(var f=0;f<o;f+=h){var d=this.peaks[2*(f+this.offset)]/u,p=this.peaks[2*(f+this.offset)+1]/u;t.drawFrame(a,s,f,d,p,c,l)}a.restore()}}}],[{key:"drawFrame",value:function(t,e,n,r,i,o,a){var s=Math.abs(r*e),u=Math.abs(i*e);t.fillRect(n,0,o,e-u),t.fillRect(n,e+s,o,e-s),0!==a&&t.fillRect(n+o,0,a,2*e)}}]),t}(),Q=n(6226),tt=function(){function t(e,n,r,i){v(this,t),this.type=e,this.shape=n,this.duration=r,this.samplesPerPixel=i}return m(t,[{key:"hook",value:function(e,n,r){if(void 0===r||r.shape!==this.shape||r.type!==this.type||r.duration!==this.duration||r.samplesPerPixel!==this.samplesPerPixel){var i=e.getContext("2d"),o=e.width,a=e.height,s=t.createCurve(this.shape,this.type,o),u=s.length,c=a-s[0]*a;i.clearRect(0,0,e.width,e.height),i.save(),i.strokeStyle="black",i.beginPath(),i.moveTo(0,c);for(var l=1;l<u;l+=1)c=a-s[l]*a,i.lineTo(l,c);i.stroke(),i.restore()}}}],[{key:"createCurve",value:function(t,e,n){var r,i;switch(e){case Z.Y1:r=1;break;case Z.h7:r=-1;break;default:throw new Error("Unsupported fade type.")}switch(t){case Z._h:i=(0,Q.sCurve)(n,r);break;case Z.t$:i=(0,Q.linear)(n,r);break;case Z.Jl:i=(0,Q.exponential)(n,r);break;case Z.Hp:i=(0,Q.logarithmic)(n,10,r);break;default:throw new Error("Unsupported fade shape")}return i}}]),t}(),et=function(){function t(e){v(this,t),this.gain=e}return m(t,[{key:"hook",value:function(t){t.value=100*this.gain,t.title="".concat(Math.round(100*this.gain),"% volume")}}]),t}(),nt=function(){function t(e){v(this,t),this.stereoPan=e}return m(t,[{key:"hook",value:function(t){var e;t.value=100*this.stereoPan,e=0===this.stereoPan?"Center":this.stereoPan<0?"Left":"Right";var n="".concat(Math.abs(Math.round(100*this.stereoPan)),"% ");t.title="Pan: ".concat(0!==this.stereoPan?n:"").concat(e)}}]),t}(),rt=function(){function t(){v(this,t),this.name="Untitled",this.customClass=void 0,this.waveOutlineColor=void 0,this.gain=1,this.muted=!1,this.soloed=!1,this.fades={},this.peakData={type:"WebAudio",mono:!1},this.cueIn=0,this.cueOut=0,this.duration=0,this.startTime=0,this.endTime=0,this.stereoPan=0}return m(t,[{key:"setEventEmitter",value:function(t){this.ee=t}},{key:"setName",value:function(t){this.name=t}},{key:"setCustomClass",value:function(t){this.customClass=t}},{key:"setWaveOutlineColor",value:function(t){this.waveOutlineColor=t}},{key:"setCues",value:function(t,e){if(e<t)throw new Error("cue out cannot be less than cue in");this.cueIn=t,this.cueOut=e,this.duration=this.cueOut-this.cueIn,this.endTime=this.startTime+this.duration}},{key:"trim",value:function(t,e){var n=this.getStartTime(),r=this.getEndTime(),i=this.cueIn-n;if(n<=t&&r>=t||n<=e&&r>=e){var o=t<n?n:t,a=e>r?r:e;this.setCues(o+i,a+i),t>n&&this.setStartTime(t)}}},{key:"setStartTime",value:function(t){this.startTime=t,this.endTime=t+this.duration}},{key:"setPlayout",value:function(t){this.playout=t}},{key:"setOfflinePlayout",value:function(t){this.offlinePlayout=t}},{key:"setEnabledStates",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.enabledStates=D()({},{cursor:!0,fadein:!0,fadeout:!0,select:!0,shift:!0},t)}},{key:"setFadeIn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"logarithmic";if(t>this.duration)throw new Error("Invalid Fade In");var n={shape:e,start:0,end:t};this.fadeIn&&(this.removeFade(this.fadeIn),this.fadeIn=void 0),this.fadeIn=this.saveFade(Z.Y1,n.shape,n.start,n.end)}},{key:"setFadeOut",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"logarithmic";if(t>this.duration)throw new Error("Invalid Fade Out");var n={shape:e,start:this.duration-t,end:this.duration};this.fadeOut&&(this.removeFade(this.fadeOut),this.fadeOut=void 0),this.fadeOut=this.saveFade(Z.h7,n.shape,n.start,n.end)}},{key:"saveFade",value:function(t,e,n,r){var i=X();return this.fades[i]={type:t,shape:e,start:n,end:r},i}},{key:"removeFade",value:function(t){delete this.fades[t]}},{key:"setBuffer",value:function(t){this.buffer=t}},{key:"setPeakData",value:function(t){this.peakData=t}},{key:"calculatePeaks",value:function(t,e){var n=S(this.cueIn,e),r=S(this.cueOut,e);this.setPeaks(Y()(this.buffer,t,this.peakData.mono,n,r))}},{key:"setPeaks",value:function(t){this.peaks=t}},{key:"setState",value:function(t){if(this.state=t,this.state&&this.enabledStates[this.state]){var e=J[this.state];this.stateObj=new e(this)}else this.stateObj=void 0}},{key:"getStartTime",value:function(){return this.startTime}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getDuration",value:function(){return this.duration}},{key:"isPlaying",value:function(){return this.playout.isPlaying()}},{key:"setShouldPlay",value:function(t){this.playout.setShouldPlay(t)}},{key:"setGainLevel",value:function(t){this.gain=t,this.playout.setVolumeGainLevel(t)}},{key:"setMasterGainLevel",value:function(t){this.playout.setMasterGainLevel(t)}},{key:"setStereoPanValue",value:function(t){this.stereoPan=t,this.playout.setStereoPanValue(t)}},{key:"setEffects",value:function(t){this.effectsGraph=t,this.playout.setEffects(t)}},{key:"schedulePlay",value:function(t,e,n,r){var i,o,a=t,s=n?n-e:void 0,u=D()({},{shouldPlay:!0,masterGain:1,isOffline:!1},r),c=u.isOffline?this.offlinePlayout:this.playout;if(this.endTime<=e||s&&e+s<this.startTime)return Promise.resolve();this.startTime>=e?(i=0,a+=this.startTime-e,n?(s-=this.startTime-e,o=Math.min(s,this.duration)):o=this.duration):(i=e-this.startTime,o=n?Math.min(s,this.duration-i):this.duration-i),i+=this.cueIn;var l=e-this.startTime,h=c.setUpSource();return z()(this.fades,function(e){var n,r;if(l<e.end)switch(l<=e.start?(n=t+(e.start-l),r=e.end-e.start):l>e.start&&l<e.end&&(n=t-(l-e.start),r=e.end-e.start),e.type){case Z.Y1:c.applyFadeIn(n,r,e.shape);break;case Z.h7:c.applyFadeOut(n,r,e.shape);break;default:throw new Error("Invalid fade type saved on track.")}}),c.setVolumeGainLevel(this.gain),c.setShouldPlay(u.shouldPlay),c.setMasterGainLevel(u.masterGain),c.setStereoPanValue(this.stereoPan),c.play(a,i,o),h}},{key:"scheduleStop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.playout.stop(t)}},{key:"renderOverlay",value:function(t){var e=this,n=O(t.playlistLength,t.resolution,t.sampleRate),r={attributes:{style:"position: absolute; top: 0; right: 0; bottom: 0; left: 0; width: ".concat(n,"px; z-index: 9;")}},i="";if(this.stateObj){this.stateObj.setup(t.resolution,t.sampleRate);var o=J[this.state];o.getEvents().forEach(function(t){r["on".concat(t)]=e.stateObj[t].bind(e.stateObj)}),i=o.getClass()}return y()("div.playlist-overlay".concat(i),r)}},{key:"renderControls",value:function(t){var e=this,n=t.muted?".active":"",r=t.soloed?".active":"",i=t.collapsed,o=this.peaks.data.length,a=t.controls.widgets,s=y()("button.btn.btn-danger.btn-xs.track-remove",{attributes:{type:"button",title:"Remove track"},onclick:function(){e.ee.emit("removeTrack",e)}},[y()("i.fas.fa-times")]),u=y()("span",[this.name]),c=y()("button.btn.btn-info.btn-xs.track-collapse",{attributes:{type:"button",title:i?"Expand track":"Collapse track"},onclick:function(){e.ee.emit("changeTrackView",e,{collapsed:!i})}},[y()("i.fas.".concat(i?"fa-caret-down":"fa-caret-up"))]),l=[];a.remove&&l.push(s),l.push(u),a.collapse&&l.push(c);var h=[y()("div.track-header",l)];return i||(a.muteOrSolo&&h.push(y()("div.btn-group",[y()("button.btn.btn-outline-dark.btn-xs.btn-mute".concat(n),{attributes:{type:"button"},onclick:function(){e.ee.emit("mute",e)}},["Mute"]),y()("button.btn.btn-outline-dark.btn-xs.btn-solo".concat(r),{onclick:function(){e.ee.emit("solo",e)}},["Solo"])])),a.volume&&h.push(y()("label.volume",[y()("input.volume-slider",{attributes:{"aria-label":"Track volume control",type:"range",min:0,max:100,value:100},hook:new et(this.gain),oninput:function(t){e.ee.emit("volumechange",t.target.value,e)}})])),a.stereoPan&&h.push(y()("label.stereopan",[y()("input.stereopan-slider",{attributes:{"aria-label":"Track stereo pan control",type:"range",min:-100,max:100,value:100},hook:new nt(this.stereoPan),oninput:function(t){e.ee.emit("stereopan",t.target.value/100,e)}})]))),y()("div.controls",{attributes:{style:"height: ".concat(o*t.height,"px; width: ").concat(t.controls.width,"px; position: absolute; left: 0; z-index: 10;")}},h)}},{key:"render",value:function(t){var e=this,n=this.peaks.length,r=O(t.playbackSeconds,t.resolution,t.sampleRate),i=O(this.startTime,t.resolution,t.sampleRate),o=O(this.endTime,t.resolution,t.sampleRate),a=0,s=this.peaks.data.length,u=Math.ceil(window.devicePixelRatio);r>0&&r>i&&(a=r<o?r-i:n);var c=[y()("div.cursor",{attributes:{style:"position: absolute; width: 1px; margin: 0; padding: 0; top: 0; left: ".concat(r,"px; bottom: 0; z-index: 5;")}})],l=Object.keys(this.peaks.data).map(function(r){for(var o=[y()("div.channel-progress",{attributes:{style:"position: absolute; width: ".concat(a,"px; height: ").concat(t.height,"px; z-index: 2;")}})],s=0,c=n,l=e.peaks.data[r];c>0;){var h=Math.min(c,1e3),f=e.waveOutlineColor?e.waveOutlineColor:t.colors.waveOutlineColor;o.push(y()("canvas",{attributes:{width:h*u,height:t.height*u,style:"float: left; position: relative; margin: 0; padding: 0; z-index: 3; width: ".concat(h,"px; height: ").concat(t.height,"px;")},hook:new K(l,s,e.peaks.bits,f,u,t.height,t.barWidth,t.barGap)})),c-=h,s+=1e3}if(e.fadeIn){var d=e.fades[e.fadeIn],p=O(d.end-d.start,t.resolution,t.sampleRate);o.push(y()("div.wp-fade.wp-fadein",{attributes:{style:"position: absolute; height: ".concat(t.height,"px; width: ").concat(p,"px; top: 0; left: 0; z-index: 4;")}},[y()("canvas",{attributes:{width:p,height:t.height},hook:new tt(d.type,d.shape,d.end-d.start,t.resolution)})]))}if(e.fadeOut){var v=e.fades[e.fadeOut],m=O(v.end-v.start,t.resolution,t.sampleRate);o.push(y()("div.wp-fade.wp-fadeout",{attributes:{style:"position: absolute; height: ".concat(t.height,"px; width: ").concat(m,"px; top: 0; right: 0; z-index: 4;")}},[y()("canvas",{attributes:{width:m,height:t.height},hook:new tt(v.type,v.shape,v.end-v.start,t.resolution)})]))}return y()("div.channel.channel-".concat(r),{attributes:{style:"height: ".concat(t.height,"px; width: ").concat(n,"px; top: ").concat(r*t.height,"px; left: ").concat(i,"px; position: absolute; margin: 0; padding: 0; z-index: 1;")}},o)});if(c.push(l),c.push(this.renderOverlay(t)),!0===t.isActive){var h=O(t.timeSelection.start,t.resolution,t.sampleRate),f=O(t.timeSelection.end,t.resolution,t.sampleRate)-h+1,d=f>1?".segment":".point";c.push(y()("div.selection".concat(d),{attributes:{style:"position: absolute; width: ".concat(f,"px; bottom: 0; top: 0; left: ").concat(h,"px; z-index: 4;")}}))}var p=y()("div.waveform",{attributes:{style:"height: ".concat(s*t.height,"px; position: relative;")}},c),v=[],m=0;t.controls.show&&(v.push(this.renderControls(t)),m=t.controls.width),v.push(p);var g=t.shouldPlay?"":".silent",k=void 0===this.customClass?"":".".concat(this.customClass);return y()("div.channel-wrapper".concat(g).concat(k),{attributes:{style:"margin-left: ".concat(m,"px; height: ").concat(t.height*s,"px;")}},v)}},{key:"getTrackDetails",value:function(){var t={src:this.src,start:this.startTime,end:this.endTime,name:this.name,muted:this.muted,soloed:this.soloed,customClass:this.customClass,cuein:this.cueIn,cueout:this.cueOut,stereoPan:this.stereoPan,gain:this.gain,effects:this.effectsGraph};if(this.fadeIn){var e=this.fades[this.fadeIn];t.fadeIn={shape:e.shape,duration:e.end-e.start}}if(this.fadeOut){var n=this.fades[this.fadeOut];t.fadeOut={shape:n.shape,duration:n.end-n.start}}return t}}]),t}();function it(t,e){t.connect(e)}var ot=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.createGain();v(this,t),this.ac=e,this.gain=1,this.effectsGraph=it,this.masterEffectsGraph=it,this.buffer=n,this.masterGain=r,this.destination=this.ac.destination}return m(t,[{key:"applyFade",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"logarithmic";if(t===Z.Y1)(0,Z.L7)(this.fadeGain.gain,r,e,n);else{if(t!==Z.h7)throw new Error("Unsupported fade type");(0,Z.Mt)(this.fadeGain.gain,r,e,n)}}},{key:"applyFadeIn",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"logarithmic";this.applyFade(Z.Y1,t,e,n)}},{key:"applyFadeOut",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"logarithmic";this.applyFade(Z.h7,t,e,n)}},{key:"isPlaying",value:function(){return void 0!==this.source}},{key:"getDuration",value:function(){return this.buffer.duration}},{key:"setAudioContext",value:function(t){this.ac=t,this.destination=this.ac.destination}},{key:"createStereoPanner",value:function(){return this.ac.createStereoPanner?this.ac.createStereoPanner():this.ac.createPanner()}},{key:"setUpSource",value:function(){var t,e,n=this;this.source=this.ac.createBufferSource(),this.source.buffer=this.buffer;var r=new Promise(function(r){n.source.onended=function(){n.source.disconnect(),n.fadeGain.disconnect(),n.volumeGain.disconnect(),n.shouldPlayGain.disconnect(),n.panner.disconnect(),t&&t(),e&&e(),n.source=void 0,n.fadeGain=void 0,n.volumeGain=void 0,n.shouldPlayGain=void 0,n.panner=void 0,r()}});return this.fadeGain=this.ac.createGain(),this.volumeGain=this.ac.createGain(),this.shouldPlayGain=this.ac.createGain(),this.panner=this.createStereoPanner(),this.source.connect(this.fadeGain),this.fadeGain.connect(this.volumeGain),this.volumeGain.connect(this.shouldPlayGain),this.shouldPlayGain.connect(this.panner),t=this.effectsGraph(this.panner,this.masterGain,this.ac instanceof OfflineAudioContext),e=this.masterEffectsGraph(this.masterGain,this.destination,this.ac instanceof OfflineAudioContext),r}},{key:"setVolumeGainLevel",value:function(t){this.volumeGain&&(this.volumeGain.gain.value=t)}},{key:"setShouldPlay",value:function(t){this.shouldPlayGain&&(this.shouldPlayGain.gain.value=t?1:0)}},{key:"setMasterGainLevel",value:function(t){this.masterGain&&(this.masterGain.gain.value=t)}},{key:"setStereoPanValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.panner&&(void 0!==this.panner.pan?this.panner.pan.value=t:(this.panner.panningModel="equalpower",this.panner.setPosition(t,0,1-Math.abs(t))))}},{key:"setEffects",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it;this.effectsGraph=t}},{key:"setMasterEffects",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it;this.masterEffectsGraph=t}},{key:"play",value:function(t,e,n){this.source.start(t,e,n)}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.source&&this.source.stop(t)}}]),t}();var at=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,t),this.playlist=e,this.data=r,this.active=!1,this.ondragover=function(t){n.active&&(t.preventDefault(),n.emitDrag(t.clientX))}}return m(t,[{key:"emitDrag",value:function(t){var e=t-this.prevX;if(e){var n=T(e,this.playlist.samplesPerPixel,this.playlist.sampleRate);this.prevX=t,this.playlist.ee.emit("dragged",n,this.data)}}},{key:"complete",value:function(){this.active=!1,document.removeEventListener("dragover",this.ondragover)}},{key:"dragstart",value:function(t){var e=t;this.active=!0,this.prevX=t.clientX,e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",""),document.addEventListener("dragover",this.ondragover)}},{key:"dragend",value:function(t){this.active&&(t.preventDefault(),this.complete())}}],[{key:"getClass",value:function(){return".shift"}},{key:"getEvents",value:function(){return["dragstart","dragend"]}}]),t}(),st=function(){};st.prototype.hook=function(t){var e=t.querySelector(".current");if(e){var n=t.getBoundingClientRect(),r=e.getBoundingClientRect().top-n.top;t.scrollTop+=r}};var ut=st;var ct=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;v(this,t),this.playlist=e,this.marginLeft=s,this.resizeHandlers=[],this.editable=i,this.annotations=n.map(function(t){return function(t){return{id:t.id||X(),start:Number(t.begin)||0,end:Number(t.end)||0,lines:t.lines||[""],lang:t.language||"en"}}(t)}),this.setupInteractions(),this.controls=r,this.setupEE(e.ee),this.playlist.isContinuousPlay=a,this.playlist.linkEndpoints=o,this.length=this.annotations.length}return m(t,[{key:"setupInteractions",value:function(){var t=this;this.annotations.forEach(function(e,n){var r=new at(t.playlist,{direction:"left",index:n}),i=new at(t.playlist,{direction:"right",index:n});t.resizeHandlers.push(r),t.resizeHandlers.push(i)})}},{key:"setupEE",value:function(t){var e=this;return t.on("dragged",function(t,n){var r=n.index,i=e.annotations,o=i[r];if("left"===n.direction){var a=o.start;o.start+=t,o.start<0&&(o.start=0),r&&i[r-1].end>o.start&&(i[r-1].end=o.start),e.playlist.linkEndpoints&&r&&i[r-1].end===a&&(i[r-1].end=o.start)}else{var s=o.end;o.end+=t,o.end>e.playlist.duration&&(o.end=e.playlist.duration),r<i.length-1&&i[r+1].start<o.end&&(i[r+1].start=o.end),e.playlist.linkEndpoints&&r<i.length-1&&i[r+1].start===s&&(i[r+1].start=o.end)}e.playlist.drawRequest()}),t.on("continuousplay",function(t){e.playlist.isContinuousPlay=t}),t.on("linkendpoints",function(t){e.playlist.linkEndpoints=t}),t.on("annotationsrequest",function(){e.export()}),t}},{key:"export",value:function(){var t=this.annotations.map(function(t){return e=t,{begin:String(e.start.toFixed(3)),end:String(e.end.toFixed(3)),id:String(e.id),language:e.lang,lines:e.lines};var e}),e="data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(t))),n=document.createElement("a");document.body.appendChild(n),n.href=e,n.download="annotations.json",n.click(),document.body.removeChild(n)}},{key:"renderResizeLeft",value:function(t){var e=at.getEvents(),n={attributes:{style:"position: absolute; height: 30px; width: 10px; top: 0; left: -2px",draggable:!0}},r=this.resizeHandlers[2*t];return e.forEach(function(t){n["on".concat(t)]=r[t].bind(r)}),y()("div.resize-handle.resize-w",n)}},{key:"renderResizeRight",value:function(t){var e=at.getEvents(),n={attributes:{style:"position: absolute; height: 30px; width: 10px; top: 0; right: -2px",draggable:!0}},r=this.resizeHandlers[2*t+1];return e.forEach(function(t){n["on".concat(t)]=r[t].bind(r)}),y()("div.resize-handle.resize-e",n)}},{key:"renderControls",value:function(t,e){var n=this,r=this;return this.controls.map(function(i){return y()("i.".concat(i.class),{attributes:{title:i.title},onclick:function(){i.action(t,e,r.annotations,{linkEndpoints:r.playlist.linkEndpoints}),n.setupInteractions(),r.playlist.drawRequest()}})})}},{key:"render",value:function(){var t=this,e=y()("div.annotations-boxes",{attributes:{style:"height: 30px; position: relative; margin-left: ".concat(this.marginLeft,"px;")}},this.annotations.map(function(e,n){var r=t.playlist.samplesPerPixel,i=t.playlist.sampleRate,o=i/r,a=O(t.playlist.scrollLeft,r,i),s=Math.floor(e.start*o-a),u=Math.ceil(e.end*o-e.start*o);return y()("div.annotation-box",{attributes:{style:"position: absolute; height: 30px; width: ".concat(u,"px; left: ").concat(s,"px"),"data-id":e.id}},[t.renderResizeLeft(n),y()("span.id",{onclick:function(){var e=t.annotations[n].start,r=t.annotations[n].end;t.playlist.isContinuousPlay?(t.playlist.seek(e,e),t.playlist.ee.emit("play",e)):(t.playlist.seek(e,r),t.playlist.ee.emit("play",e,r))}},[e.id]),t.renderResizeRight(n)])})),n=y()("div.annotations-boxes-wrapper",{attributes:{style:"overflow: hidden;"}},[e]),r=y()("div.annotations-text",{hook:new ut},this.annotations.map(function(e,n){var r=function(t){function e(t,e){var n=parseInt(t/3600,10)%24,r=parseInt(t/60,10)%60,i=(t%60).toFixed(e),o=n<10?"0".concat(n):n,a=r<10?"0".concat(r):r,s=i<10?"0".concat(i):i;return"".concat(o,":").concat(a,":").concat(s)}return{seconds:function(t){return t.toFixed(0)},thousandths:function(t){return t.toFixed(3)},"hh:mm:ss":function(t){return e(t,0)},"hh:mm:ss.u":function(t){return e(t,1)},"hh:mm:ss.uu":function(t){return e(t,2)},"hh:mm:ss.uuu":function(t){return e(t,3)}}[t]}(t.playlist.durationFormat),i=r(e.start),o=r(e.end),a="";t.playlist.isPlaying()&&t.playlist.playbackSeconds>=e.start&&t.playlist.playbackSeconds<=e.end&&(a=".current");var s={attributes:{contenteditable:!0},oninput:function(t){e.lines=[t.target.innerText]},onkeypress:function(t){13!==t.which&&13!==t.keyCode||(t.target.blur(),t.preventDefault())}},u=t.editable?s:{};return y()("div.annotation".concat(a),[y()("span.annotation-id",[e.id]),y()("span.annotation-start",[i]),y()("span.annotation-end",[o]),y()("span.annotation-lines",u,[e.lines]),y()("span.annotation-actions",t.renderControls(e,n))])}));return y()("div.annotations",[n,r])}}]),t}();function lt(){function t(t){for(var e,n=1/0,r=-1/0,i=0;i<t.length;i+=1)n>(e=t[i])&&(n=e),r<e&&(r=e);return{min:n,max:r}}function e(t,e){var n=Math.pow(2,e-1),r=t<0?t*n:t*n-1;return Math.max(-n,Math.min(n-1,r))}function n(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;if([8,16,32].indexOf(i)<0)throw new Error("Invalid number of bits specified for peaks.");var o=[],a=n.length;return o.push(function(n,r,i){for(var o,a,s,u,c,l=n.length,h=Math.ceil(l/r),f=new(self["Int".concat(i,"Array")])(2*h),d=0;d<h;d+=1)o=d*r,a=(d+1)*r>l?l:(d+1)*r,u=e((c=t(n.subarray(o,a))).min,i),s=e(c.max,i),f[2*d]=u,f[2*d+1]=s;return f}(n.subarray(0,a),r,i)),{bits:i,length:o[0].length/2,data:o}}onmessage=function(t){var e=n(t.data.samples,t.data.samplesPerPixel);postMessage(e)}}function ht(){var t,e=0,n=[],r=[];function i(t,e,n){for(var r=0;r<n.length;r+=1)t.setUint8(e+r,n.charCodeAt(r))}function o(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new ArrayBuffer(44+2*e.length),o=new DataView(r);return i(o,0,"RIFF"),o.setUint32(4,32+2*e.length,!0),i(o,8,"WAVE"),i(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,n?1:2,!0),o.setUint32(24,t,!0),o.setUint32(28,4*t,!0),o.setUint16(32,4,!0),o.setUint16(34,16,!0),i(o,36,"data"),o.setUint32(40,2*e.length,!0),function(t,e,n){for(var r=e,i=0;i<n.length;i+=1,r+=2){var o=Math.max(-1,Math.min(1,n[i]));t.setInt16(r,o<0?32768*o:32767*o,!0)}}(o,44,e),o}function a(t,e){for(var n=new Float32Array(e),r=0,i=0;i<t.length;i+=1)n.set(t[i],r),r+=t[i].length;return n}function s(t){var i=o(function(t,e){for(var n=t.length+e.length,r=new Float32Array(n),i=0,o=0;i<n;)r[i+=1]=t[o],r[i+=1]=e[o],o+=1;return r}(a(n,e),a(r,e))),s=new Blob([i],{type:t});postMessage(s)}onmessage=function(i){switch(i.data.command){case"init":a=i.data.config,t=a.sampleRate;break;case"record":o=i.data.buffer,n.push(o[0]),r.push(o[1]),e+=o[0].length;break;case"exportWAV":s(i.data.type);break;case"clear":e=0,n=[],r=[];break;default:throw new Error("Unknown export worker command")}var o,a}}var ft=function(){function t(){v(this,t),this.tracks=[],this.soloedTracks=[],this.mutedTracks=[],this.collapsedTracks=[],this.playoutPromises=[],this.cursor=0,this.playbackSeconds=0,this.duration=0,this.scrollLeft=0,this.scrollTimer=void 0,this.showTimescale=!1,this.isScrolling=!1,this.fadeType="logarithmic",this.masterGain=1,this.annotations=[],this.durationFormat="hh:mm:ss.uuu",this.isAutomaticScroll=!1,this.resetDrawTimer=void 0}return m(t,[{key:"initExporter",value:function(){this.exportWorker=new(P())(ht)}},{key:"trimAudioBuffer",value:function(t,e){var n=t.sampleRate,r=Math.floor(e*n);if(r>=t.length)return this.ac.createBuffer(1,1,n);for(var i=this.ac.createBuffer(t.numberOfChannels,t.length-r,n),o=0;o<t.numberOfChannels;o++)for(var a=t.getChannelData(o),s=i.getChannelData(o),u=0;u<i.length;u++)s[u]=a[u+r];return i}},{key:"initRecorder",value:function(t){var e=this;this.mediaRecorder=new MediaRecorder(t),this.mediaRecorder.onstart=function(){var t=new rt;t.setName("Recording"),t.setEnabledStates(),t.setEventEmitter(e.ee),e.recordingTrack=t,e.tracks.push(t),e.chunks=[],e.working=!1},this.mediaRecorder.ondataavailable=function(t){if(e.chunks.push(t.data),!e.working){var n=new Blob(e.chunks,{type:"audio/ogg; codecs=opus"});L.createLoader(n,e.ac).load().then(function(t){e.latency>0&&(t=e.trimAudioBuffer(t,e.latency)),e.recorderWorker.postMessage({samples:t.getChannelData(0),samplesPerPixel:e.samplesPerPixel}),e.recordingTrack.setCues(0,t.duration),e.recordingTrack.setBuffer(t),e.recordingTrack.setPlayout(new ot(e.ac,t,e.masterGainNode)),e.adjustDuration()}).catch(function(){e.working=!1}),e.working=!0}},this.mediaRecorder.onstop=function(){e.chunks=[],e.working=!1},this.recorderWorker=new(P())(lt),this.recorderWorker.onmessage=function(t){e.recordingTrack.setPeaks(t.data),e.working=!1,e.drawRequest()}}},{key:"setShowTimeScale",value:function(t){this.showTimescale=t}},{key:"setMono",value:function(t){this.mono=t}},{key:"setExclSolo",value:function(t){this.exclSolo=t}},{key:"setSeekStyle",value:function(t){this.seekStyle=t}},{key:"getSeekStyle",value:function(){return this.seekStyle}},{key:"setSampleRate",value:function(t){this.sampleRate=t}},{key:"setSamplesPerPixel",value:function(t){this.samplesPerPixel=t}},{key:"setAudioContext",value:function(t){this.ac=t,this.masterGainNode=t.createGain()}},{key:"getAudioContext",value:function(){return this.ac}},{key:"setControlOptions",value:function(t){this.controls=t}},{key:"setWaveHeight",value:function(t){this.waveHeight=t}},{key:"setCollapsedWaveHeight",value:function(t){this.collapsedWaveHeight=t}},{key:"setColors",value:function(t){this.colors=t}},{key:"setBarWidth",value:function(t){this.barWidth=t}},{key:"setBarGap",value:function(t){this.barGap=t}},{key:"setAnnotations",value:function(t){var e=this.controls.show?this.controls.width:0;this.annotationList=new ct(this,t.annotations,t.controls,t.editable,t.linkEndpoints,t.isContinuousPlay,e)}},{key:"setEffects",value:function(t){this.effectsGraph=t}},{key:"setEventEmitter",value:function(t){this.ee=t}},{key:"getEventEmitter",value:function(){return this.ee}},{key:"setUpEventEmitter",value:function(){var t=this,e=this.ee;e.on("automaticscroll",function(e){t.isAutomaticScroll=e}),e.on("durationformat",function(e){t.durationFormat=e,t.drawRequest()}),e.on("select",function(e,n,r){t.isPlaying()?(t.lastSeeked=e,t.pausedAt=void 0,t.restartPlayFrom(e)):(t.seek(e,n,r),t.ee.emit("timeupdate",e),t.drawRequest())}),e.on("startaudiorendering",function(e,n){t.startOfflineRender(e,n)}),e.on("statechange",function(e){t.setState(e),t.drawRequest()}),e.on("shift",function(e,n){n.setStartTime(n.getStartTime()+e),t.adjustDuration(),t.drawRequest()}),e.on("record",function(e){t.latency=e,t.record()}),e.on("updateview",function(){t.drawRequest()}),e.on("resume",o(r().mark(function e(){return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Audio context state change: ".concat(t.getAudioContext().state)),"running"!==t.getAudioContext().state){e.next=4;break}return e.next=4,t.getAudioContext().resume();case 4:case"end":return e.stop()}},e)}))),e.on("play",function(e,n){t.play(e,n)}),e.on("pause",function(){t.pause()}),e.on("stop",function(){t.stop()}),e.on("rewind",function(){t.rewind()}),e.on("fastforward",function(){t.fastForward()}),e.on("clear",function(){t.clear().then(function(){t.drawRequest()})}),e.on("solo",function(e){t.soloTrack(e),t.adjustTrackPlayout(),t.drawRequest()}),e.on("mute",function(e){t.muteTrack(e),t.adjustTrackPlayout(),t.drawRequest()}),e.on("removeTrack",function(e){t.removeTrack(e),t.adjustTrackPlayout(),t.drawRequest()}),e.on("changeTrackView",function(e,n){t.collapseTrack(e,n),t.drawRequest()}),e.on("volumechange",function(e,n){n.setGainLevel(e/100),t.drawRequest()}),e.on("mastervolumechange",function(e){t.masterGain=e/100,t.tracks.forEach(function(e){e.setMasterGainLevel(t.masterGain)})}),e.on("fadein",function(e,n){n.setFadeIn(e,t.fadeType),t.drawRequest()}),e.on("fadeout",function(e,n){n.setFadeOut(e,t.fadeType),t.drawRequest()}),e.on("stereopan",function(e,n){n.setStereoPanValue(e),t.drawRequest()}),e.on("fadetype",function(e){t.fadeType=e}),e.on("newtrack",function(e){t.load([{src:e,name:e.name}])}),e.on("trim",function(){var e=t.getActiveTrack(),n=t.getTimeSelection();e.trim(n.start,n.end),e.calculatePeaks(t.samplesPerPixel,t.sampleRate),t.setTimeSelection(0,0),t.drawRequest()}),e.on("zoomin",function(){var e=Math.max(0,t.zoomIndex-1),n=t.zoomLevels[e];n!==t.samplesPerPixel&&(t.setZoom(n),t.drawRequest())}),e.on("zoomout",function(){var e=Math.min(t.zoomLevels.length-1,t.zoomIndex+1),n=t.zoomLevels[e];n!==t.samplesPerPixel&&(t.setZoom(n),t.drawRequest())}),e.on("scroll",function(){t.isScrolling=!0,t.drawRequest(),clearTimeout(t.scrollTimer),t.scrollTimer=setTimeout(function(){t.isScrolling=!1},200)})}},{key:"load",value:function(t){var e=this,n=t.map(function(t){return L.createLoader(t.src,e.ac,e.ee).load().then(function(t){return t.sampleRate===e.sampleRate?t:function(t,e){var n=Math.ceil(t.duration*e),r=new OfflineAudioContext(t.numberOfChannels,n,e),i=r.createBufferSource();return i.buffer=t,i.connect(r.destination),i.start(),r.startRendering()}(t,e.sampleRate)})});return Promise.all(n).then(function(n){e.ee.emit("audiosourcesloaded");var r=n.map(function(n,r){var i=t[r],o=i.name||"Untitled",a=i.start||0,s=i.states||{},u=i.fadeIn,c=i.fadeOut,l=i.cuein||0,h=i.cueout||n.duration,f=i.gain||1,d=i.muted||!1,p=i.soloed||!1,v=i.selected,y=i.peaks||{type:"WebAudio",mono:e.mono},m=i.customClass||void 0,g=i.waveOutlineColor||void 0,k=i.stereoPan||0,b=i.effects||null,w=new ot(e.ac,n,e.masterGainNode),x=new rt;return x.src=i.src,x.setBuffer(n),x.setName(o),x.setEventEmitter(e.ee),x.setEnabledStates(s),x.setCues(l,h),x.setCustomClass(m),x.setWaveOutlineColor(g),void 0!==u&&x.setFadeIn(u.duration,u.shape),void 0!==c&&x.setFadeOut(c.duration,c.shape),void 0!==v&&(e.setActiveTrack(x),e.setTimeSelection(v.start,v.end)),void 0!==y&&x.setPeakData(y),x.setState(e.getState()),x.setStartTime(a),x.setPlayout(w),x.setGainLevel(f),x.setStereoPanValue(k),b&&x.setEffects(b),d&&e.muteTrack(x),p&&e.soloTrack(x),x.calculatePeaks(e.samplesPerPixel,e.sampleRate),x});e.tracks=e.tracks.concat(r),e.adjustDuration(),e.draw(e.render()),e.ee.emit("audiosourcesrendered")}).catch(function(t){e.ee.emit("audiosourceserror",t)})}},{key:"setActiveTrack",value:function(t){this.activeTrack=t}},{key:"getActiveTrack",value:function(){return this.activeTrack}},{key:"isSegmentSelection",value:function(){return this.timeSelection.start!==this.timeSelection.end}},{key:"setTimeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;this.timeSelection={start:t,end:void 0===e?t:e},this.cursor=t}},{key:"startOfflineRender",value:function(){var t=o(r().mark(function t(e,n){var i,o,a,s,u=this;return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isRendering){t.next=2;break}return t.abrupt("return");case 2:return this.isRendering=!0,this.offlineAudioContext=new OfflineAudioContext(2,44100*this.duration,44100),i=[],this.ee.emit("audiorenderingstarting",this.offlineAudioContext,i),o=this.offlineAudioContext.currentTime,a=this.offlineAudioContext.createGain(),this.tracks.forEach(function(t,e){var r=u.shouldTrackPlay(t);n>=0&&(r=e===n);var i=new ot(u.offlineAudioContext,t.buffer,a);i.setEffects(t.effectsGraph),i.setMasterEffects(u.effectsGraph),t.setOfflinePlayout(i),t.schedulePlay(o,0,0,{shouldPlay:r,masterGain:1,isOffline:!0})}),t.next=11,Promise.all(i);case 11:return t.next=13,this.offlineAudioContext.startRendering();case 13:s=t.sent,"buffer"===e?(this.ee.emit("audiorenderingfinished",e,s),this.isRendering=!1):"wav"===e&&(this.exportWorker.postMessage({command:"init",config:{sampleRate:44100}}),this.exportWorker.onmessage=function(t){u.ee.emit("audiorenderingfinished",e,t.data,n),u.isRendering=!1,u.exportWorker.postMessage({command:"clear"})},this.exportWorker.postMessage({command:"record",buffer:[s.getChannelData(0),s.getChannelData(1)]}),this.exportWorker.postMessage({command:"exportWAV",type:"audio/wav"}));case 15:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"getTimeSelection",value:function(){return this.timeSelection}},{key:"setState",value:function(t){this.state=t,this.tracks.forEach(function(e){e.setState(t)})}},{key:"getState",value:function(){return this.state}},{key:"setZoomIndex",value:function(t){this.zoomIndex=t}},{key:"setZoomLevels",value:function(t){this.zoomLevels=t}},{key:"setZoom",value:function(t){var e=this;this.samplesPerPixel=t,this.zoomIndex=this.zoomLevels.indexOf(t),this.tracks.forEach(function(n){n.calculatePeaks(t,e.sampleRate)})}},{key:"muteTrack",value:function(t){var e=this.mutedTracks.indexOf(t);e>-1?(t.muted=!1,this.mutedTracks.splice(e,1)):(t.muted=!0,this.mutedTracks.push(t))}},{key:"soloTrack",value:function(t){var e=this.soloedTracks.indexOf(t);e>-1?(t.soloed=!1,this.soloedTracks.splice(e,1)):this.exclSolo?(t.soloed=!0,this.soloedTracks=[t]):(t.soloed=!0,this.soloedTracks.push(t))}},{key:"collapseTrack",value:function(t,e){if(e.collapsed)this.collapsedTracks.push(t);else{var n=this.collapsedTracks.indexOf(t);n>-1&&this.collapsedTracks.splice(n,1)}}},{key:"removeTrack",value:function(t){t.isPlaying()&&t.scheduleStop(),[this.mutedTracks,this.soloedTracks,this.collapsedTracks,this.tracks].forEach(function(e){var n=e.indexOf(t);n>-1&&e.splice(n,1)})}},{key:"adjustTrackPlayout",value:function(){var t=this;this.tracks.forEach(function(e){e.setShouldPlay(t.shouldTrackPlay(e))})}},{key:"adjustDuration",value:function(){this.duration=this.tracks.reduce(function(t,e){return Math.max(t,e.getEndTime())},0)}},{key:"shouldTrackPlay",value:function(t){var e;return this.soloedTracks.length>0?(e=!1,this.soloedTracks.indexOf(t)>-1&&(e=!0)):(e=!0,this.mutedTracks.indexOf(t)>-1&&(e=!1)),e}},{key:"isPlaying",value:function(){return this.tracks.reduce(function(t,e){return t||e.isPlaying()},!1)}},{key:"getCurrentTime",value:function(){return(this.lastSeeked||this.pausedAt||this.cursor)+this.getElapsedTime()}},{key:"getElapsedTime",value:function(){return this.ac.currentTime-this.lastPlay}},{key:"setMasterGain",value:function(t){this.ee.emit("mastervolumechange",t)}},{key:"restartPlayFrom",value:function(t,e){return this.stopAnimation(),this.tracks.forEach(function(t){t.scheduleStop()}),Promise.all(this.playoutPromises).then(this.play.bind(this,t,e))}},{key:"play",value:function(t,e){var n=this;clearTimeout(this.resetDrawTimer);var r=this.ac.currentTime,i=this.getTimeSelection(),o=[],a=t||this.pausedAt||this.cursor,s=e;return!s&&i.end!==i.start&&i.end>a&&(s=i.end),this.isPlaying()?this.restartPlayFrom(a,s):(this.effectsGraph&&this.tracks&&this.tracks[0].playout.setMasterEffects(this.effectsGraph),this.tracks.forEach(function(t){t.setState("cursor"),o.push(t.schedulePlay(r,a,s,{shouldPlay:n.shouldTrackPlay(t),masterGain:n.masterGain}))}),this.lastPlay=r,this.playoutPromises=o,this.startAnimation(a),Promise.all(this.playoutPromises))}},{key:"pause",value:function(){return this.isPlaying()?(this.pausedAt=this.getCurrentTime(),this.playbackReset()):Promise.all(this.playoutPromises)}},{key:"stop",value:function(){return this.mediaRecorder&&"recording"===this.mediaRecorder.state&&this.mediaRecorder.stop(),this.pausedAt=void 0,this.playbackSeconds=0,this.playbackReset()}},{key:"playbackReset",value:function(){var t=this;return this.lastSeeked=void 0,this.stopAnimation(),this.tracks.forEach(function(e){e.scheduleStop(),e.setState(t.getState())}),this.drawRequest(),Promise.all(this.playoutPromises)}},{key:"rewind",value:function(){var t=this;return this.stop().then(function(){t.scrollLeft=0,t.ee.emit("select",0,0)})}},{key:"fastForward",value:function(){var t=this;return this.stop().then(function(){t.viewDuration<t.duration?t.scrollLeft=t.duration-t.viewDuration:t.scrollLeft=0,t.ee.emit("select",t.duration,t.duration)})}},{key:"clear",value:function(t){var e=this;return this.stop().then(function(){var n=[];(t||0===t)&&(e.tracks.splice(t,1),n=e.tracks),e.tracks=n,e.soloedTracks=[],e.mutedTracks=[],e.playoutPromises=[],e.cursor=0,e.playbackSeconds=0,e.duration=0,e.scrollLeft=0,e.seek(0,0,void 0)})}},{key:"record",value:function(){var t=this,e=[];this.mediaRecorder.start(300),this.tracks.forEach(function(n){n.setState("none"),e.push(n.schedulePlay(t.ac.currentTime,0,void 0,{shouldPlay:t.shouldTrackPlay(n)}))}),this.playoutPromises=e}},{key:"startAnimation",value:function(t){var e=this;this.lastDraw=this.ac.currentTime,this.animationRequest=window.requestAnimationFrame(function(){e.updateEditor(t)})}},{key:"stopAnimation",value:function(){window.cancelAnimationFrame(this.animationRequest),this.lastDraw=void 0}},{key:"seek",value:function(t,e,n){this.isPlaying()?(this.lastSeeked=t,this.pausedAt=void 0,this.restartPlayFrom(t)):(this.setActiveTrack(n||this.tracks[0]),this.pausedAt=t,this.setTimeSelection(t,e),"fill"===this.getSeekStyle()&&(this.playbackSeconds=t))}},{key:"updateEditor",value:function(t){var e=this,n=this.ac.currentTime,r=this.getTimeSelection(),i=t||this.cursor,o=n-this.lastDraw;if(this.isPlaying()){var a=i+o;this.ee.emit("timeupdate",a),this.animationRequest=window.requestAnimationFrame(function(){e.updateEditor(a)}),this.playbackSeconds=a,this.draw(this.render()),this.lastDraw=n}else i+o>=(this.isSegmentSelection()?r.end:this.duration)&&this.ee.emit("finished"),this.stopAnimation(),this.resetDrawTimer=setTimeout(function(){e.pausedAt=void 0,e.lastSeeked=void 0,e.setState(e.getState()),e.playbackSeconds=0,e.draw(e.render())},0)}},{key:"drawRequest",value:function(){var t=this;window.requestAnimationFrame(function(){t.draw(t.render())})}},{key:"draw",value:function(t){var e=k()(this.tree,t);this.rootNode=w()(this.rootNode,e),this.tree=t,this.viewDuration=T(this.rootNode.clientWidth-this.controls.width,this.samplesPerPixel,this.sampleRate)}},{key:"getTrackRenderData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={height:this.waveHeight,resolution:this.samplesPerPixel,sampleRate:this.sampleRate,controls:this.controls,isActive:!1,timeSelection:this.getTimeSelection(),playlistLength:this.duration,playbackSeconds:this.playbackSeconds,colors:this.colors,barWidth:this.barWidth,barGap:this.barGap};return e()({},t,n)}},{key:"isActiveTrack",value:function(t){var e=this.getActiveTrack();return!this.isSegmentSelection()||e===t}},{key:"renderAnnotations",value:function(){return this.annotationList.render()}},{key:"renderTimeScale",value:function(){var t=this.controls.show?this.controls.width:0;return new I(this.duration,this.scrollLeft,this.samplesPerPixel,this.sampleRate,t,this.colors).render()}},{key:"renderTrackSection",value:function(){var t=this,e=this.tracks.map(function(e){var n=t.collapsedTracks.indexOf(e)>-1;return e.render(t.getTrackRenderData({isActive:t.isActiveTrack(e),shouldPlay:t.shouldTrackPlay(e),soloed:t.soloedTracks.indexOf(e)>-1,muted:t.mutedTracks.indexOf(e)>-1,collapsed:n,height:n?t.collapsedWaveHeight:t.waveHeight,barGap:t.barGap,barWidth:t.barWidth}))});return y()("div.playlist-tracks",{attributes:{style:"overflow: auto;"},onscroll:function(e){t.scrollLeft=T(e.target.scrollLeft,t.samplesPerPixel,t.sampleRate),t.ee.emit("scroll")},hook:new G(this)},e)}},{key:"render",value:function(){var t=[];return this.showTimescale&&t.push(this.renderTimeScale()),t.push(this.renderTrackSection()),this.annotationList.length&&t.push(this.renderAnnotations()),y()("div.playlist",{attributes:{style:"overflow: hidden; position: relative;"}},t)}},{key:"getInfo",value:function(){var t=[];return this.tracks.forEach(function(e){t.push(e.getTrackDetails())}),{tracks:t,effects:this.effectsGraph}}}]),t}();function dt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f()();if(void 0===t.container)throw new Error("DOM element container must be given.");var r=e()({},t,{samplesPerPixel:4096,mono:!0,fadeType:"logarithmic",exclSolo:!1,timescale:!1,controls:{show:!1,width:150,widgets:{muteOrSolo:!0,volume:!0,stereoPan:!0,collapse:!0,remove:!0}},colors:{waveOutlineColor:"white",timeColor:"grey",fadeColor:"black"},seekStyle:"line",waveHeight:128,collapsedWaveHeight:30,barWidth:1,barGap:0,state:"cursor",zoomLevels:[512,1024,2048,4096],annotationList:{annotations:[],controls:[],editable:!1,linkEndpoints:!1,isContinuousPlay:!1},isAutomaticScroll:!1}),i=r.zoomLevels.indexOf(r.samplesPerPixel);if(-1===i)throw new Error("initial samplesPerPixel must be included in array zoomLevels");var o=new ft,a=r.ac||new AudioContext;o.setAudioContext(a),o.setSampleRate(r.sampleRate||a.sampleRate),o.setSamplesPerPixel(r.samplesPerPixel),o.setEventEmitter(n),o.setUpEventEmitter(),o.setTimeSelection(0,0),o.setState(r.state),o.setControlOptions(r.controls),o.setWaveHeight(r.waveHeight),o.setCollapsedWaveHeight(r.collapsedWaveHeight),o.setColors(r.colors),o.setZoomLevels(r.zoomLevels),o.setZoomIndex(i),o.setMono(r.mono),o.setExclSolo(r.exclSolo),o.setShowTimeScale(r.timescale),o.setSeekStyle(r.seekStyle),o.setAnnotations(r.annotationList),o.setBarGap(r.barGap),o.setBarWidth(r.barWidth),o.isAutomaticScroll=r.isAutomaticScroll,o.isContinuousPlay=r.isContinuousPlay,o.linkedEndpoints=r.linkedEndpoints,r.effects&&o.setEffects(r.effects);var s=o.render(),u=c()(s);return r.container.appendChild(u),o.tree=s,o.rootNode=u,o}function pt(){return dt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:f()())}}(),i}()});
},{"process":"pBGv","buffer":"dskh"}],"lKJn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Recorder=void 0;var e=require("./composition"),r=require("../../../common/js/utils");function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,a(o.key),o)}}function n(e,r,t){return r&&i(e.prototype,r),t&&i(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var r=u(e,"string");return"symbol"===t(r)?r:String(r)}function u(e,r){if("object"!==t(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,r||"default");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var s=function(){function t(){o(this,t)}return n(t,[{key:"init",value:function(){var t,o={audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1}};if(r.isSafari){var i=navigator.userAgent.indexOf("Version/"),n=navigator.userAgent.substring(i+8),a=parseFloat(n);console.log("Safari version:",a),a>16&&(o.audio.echoCancellation=!0)}navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var u=function(r){t=r,e.playlist.initRecorder(t),$(".btn-record").removeClass("disabled")},s=function(e){console.error(e)};navigator.mediaDevices?navigator.mediaDevices.getUserMedia(o).then(u).catch(s):navigator.getUserMedia&&"MediaRecorder"in window&&navigator.getUserMedia(o,u,s)}}]),t}();exports.Recorder=s;
},{"./composition":"AYcs","../../../common/js/utils":"osPO"}],"qv8c":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.latencyMeasurer=void 0;var e=require("./testlatency");function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}function i(e,t,s){return t&&a(e.prototype,t),s&&a(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){var s=n(e,"string");return"symbol"===t(s)?s:String(s)}function n(e,s){if("object"!==t(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,s||"default");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(e)}var h={measure_average_loudness_for_1_sec:0,playing_and_listening:1,waiting:2,passthrough:3,idle:4};function u(e,t,s){for(var a=0,i=0;i<s;i++)a+=Math.abs(e[i])+Math.abs(t[i]);return a}var l=function(){function t(){s(this,t),this.measurementState=this.nextMeasurementState=h.idle,this.samplesElapsed=this.sineWave=this.sum=this.threshold=this.state=this.samplerate=this.latencyMs=this.buffersize=0,this.roundTripLatencyMs=new Array(e.NUMBER_TRIALS).fill(0)}return i(t,[{key:"toggle",value:function(){-1==this.state||this.state>0&&this.state<11?(this.state=0,this.nextMeasurementState=h.idle):(this.state=1,this.samplerate=this.latencyMs=this.buffersize=0,this.nextMeasurementState=h.measure_average_loudness_for_1_sec)}},{key:"processInput",value:function(t,s,a,i){switch(this.rampdec=-1,this.samplerate=a,this.buffersize=i,this.nextMeasurementState!=this.measurementState&&(this.nextMeasurementState==h.measure_average_loudness_for_1_sec&&(this.samplesElapsed=0),this.measurementState=this.nextMeasurementState),this.measurementState){case h.measure_average_loudness_for_1_sec:if(this.sum+=u(t,s,i),this.samplesElapsed+=i,this.samplesElapsed>=this.samplerate){var r=this.sum/(this.samplesElapsed>>1),n=20*Math.log10(r)+24;this.threshold=Math.pow(10,n/20),this.measurementState=this.nextMeasurementState=h.playing_and_listening,this.sineWave=0,this.samplesElapsed=0,this.sum=0}break;case h.playing_and_listening:var l=u(t,s,i)/i;if(this.rampdec=0,l>this.threshold){for(var o=0,m=0;o<i&&!(t[m]>this.threshold)&&!(s[m++]>this.threshold);)o++;if(this.samplesElapsed+=o,this.samplesElapsed>i){this.roundTripLatencyMs[this.state-1]=1e3*this.samplesElapsed/this.samplerate;var p=0,c=1e5;for(o=0;o<this.state;o++)this.roundTripLatencyMs[o]>p&&(p=this.roundTripLatencyMs[o]),this.roundTripLatencyMs[o]<c&&(c=this.roundTripLatencyMs[o]),this.sum+=this.roundTripLatencyMs[o];p/c>2?(this.latencyMs=0,this.state=e.NUMBER_TRIALS,this.measurementState=this.nextMeasurementState=h.idle):this.state==e.NUMBER_TRIALS?(this.latencyMs=parseInt(.1*this.sum),this.measurementState=this.nextMeasurementState=h.idle):(this.latencyMs=parseInt(this.roundTripLatencyMs[this.state-1]),this.measurementState=this.nextMeasurementState=h.waiting),this.state++}else this.measurementState=this.nextMeasurementState=h.waiting;this.rampdec=1/i}else this.samplesElapsed+=i,this.samplesElapsed>this.samplerate&&(this.rampdec=1/i,this.measurementState=this.nextMeasurementState=h.waiting,this.latencyMs=-1);break;case h.passthrough:case h.idle:break;default:this.samplesElapsed+=i,this.sum=0,this.samplesElapsed>this.samplerate&&(this.samplesElapsed=0,this.measurementState=this.nextMeasurementState=h.measure_average_loudness_for_1_sec)}}},{key:"processOutput",value:function(e,t){if(this.measurementState!=h.passthrough)if(this.rampdec<0)for(var s=2*this.buffersize,a=0;s--;)e[a]=t[a++]=0;else for(var i=1,r=2*Math.PI*1e3/this.samplerate,n=this.buffersize,u=0;n--;)e[u]=t[u++]=Math.sin(r*this.sineWave)*i,i-=this.rampdec,this.sineWave+=1}}]),t}();exports.latencyMeasurer=l;
},{"./testlatency":"jGnR"}],"jGnR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TestLatency=exports.NUMBER_TRIALS=void 0;var t=require("./latencyMeasurer.js"),e=require("../../../../common/js/utils"),n=require("../composition");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){l=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function r(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,d(o.key),o)}}function s(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t,e,n){return(e=d(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t){var e=y(t,"string");return"symbol"===o(e)?e:String(e)}function y(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var f=3;exports.NUMBER_TRIALS=f;var p="Please Make sure you are in a quiet place (so the browser can hear itself). Set both input and output audio volume to near maximum. This may be LOUD. Note: not all browsers on all devices will allow the browser permission to the speakers and microphone. If they don't, the test will not function.",m=function(){function o(){u(this,o),c(this,"currentlatency",null)}return s(o,null,[{key:"setCurrentLatency",value:function(t){localStorage.setItem("latency",t),o.currentlatency=t}},{key:"getCurrentLatency",value:function(){return o.currentlatency}},{key:"initialize",value:function(t){var e=localStorage.getItem("latency");o.currentlatency=e?parseInt(e):null,o.audioContext=o.audioNode=null,o.content=document.getElementById("testlatency");var n="function"==typeof AudioWorkletNode?1:0;o.data={buffersize:n?128:512,samplerate:"?",audioWorklet:n},o.runningon="?",o.displayStart()}},{key:"displayStart",value:function(){null!=o.audioContext&&o.audioContext.close(),o.audioContext=o.audioNode=null,o.content.innerHTML="",o.startbutton=document.createElement("a"),o.startbutton.innerText="TEST LATENCY",o.startbutton.classList.add("btn-outline-success"),o.startbutton.onclick=o.start,o.content.appendChild(o.startbutton)}},{key:"onAudioInputPermissionDenied",value:function(t){console.log(t)}},{key:"onMessageFromAudioScope",value:function(t){var e=null;t.latencyMs<0?(e="The environment is too loud! Please try it again in a quieter environment.",o.displayResult(e)):t.state==f&&(t.latency<1?(e="The variance is too big. Please try it again in a quieter environment.",o.displayResult(e)):(o.data.ms=t.latency,e="Result: "+t.latency+" ms",o.setCurrentLatency(t.latency),o.displayResult(e)))}},{key:"onAudioSetupFinished",value:function(){o.audioContext.createMediaStreamSource(o.inputStream).connect(o.audioNode),o.audioNode.connect(o.audioContext.destination),o.startbutton.innerText="CANCEL",o.startbutton.classList.remove("btn-outline-success"),o.startbutton.classList.add("btn-outline-danger"),o.startbutton.onclick=o.displayStart}},{key:"displayResult",value:function(t){null!=o.audioContext&&o.audioContext.close(),o.audioContext=o.audioNode=null,o.startbutton.innerText="TEST AGAIN",o.startbutton.classList.remove("btn-outline-danger"),o.startbutton.classList.add("btn-outline-primary"),o.startbutton.onclick=o.displayStart,alert(t),e.isSafari&&n.playlist.getEventEmitter().emit("resume")}},{key:"onAudioPermissionGranted",value:function(e){o.inputStream=e;var n,r=a(e.getAudioTracks());try{for(r.s();!(n=r.n()).done;){n.value.applyConstraints({autoGainControl:!1,echoCancellation:!1,noiseSuppression:!1})}}catch(i){r.e(i)}finally{r.f()}o.latencyMeasurer=new t.latencyMeasurer,o.latencyMeasurer.toggle(),o.lastState=0,o.audioNode=o.audioContext.createScriptProcessor(256,2,2),o.audioNode.onaudioprocess=function(t){o.latencyMeasurer.processInput(t.inputBuffer.getChannelData(0),t.inputBuffer.getChannelData(1),o.data.samplerate,t.inputBuffer.length),o.latencyMeasurer.processOutput(t.outputBuffer.getChannelData(0),t.outputBuffer.getChannelData(1)),o.lastState!=o.latencyMeasurer.state&&(o.lastState=o.latencyMeasurer.state,o.onMessageFromAudioScope({state:o.lastState,latency:o.latencyMeasurer.latencyMs}))},o.onAudioSetupFinished()}},{key:"start",value:function(t){if(!o.getCurrentLatency()){var a=window.confirm("".concat(p));if(e.isSafari&&n.playlist.getEventEmitter().emit("resume"),!a)return}var r=window.AudioContext||window.webkitAudioContext||!1;o.audioContext=new r({latencyHint:0}),o.data.samplerate=o.audioContext.sampleRate;navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({echoCancellation:!1,disableLocalEcho:!1,autoGainControl:!1,audio:{mandatory:{googAutoGainControl:!1,googAutoGainControl2:!1,googEchoCancellation:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googEchoCancellation2:!1,googNoiseSuppression2:!1,googDAEchoCancellation:!1,googNoiseReduction:!1}},video:!1}).then(o.onAudioPermissionGranted).catch(o.onAudioInputPermissionDenied):o.onAudioInputPermissionDenied("Can't access getUserMedia.")}}]),o}();exports.TestLatency=m;
},{"./latencyMeasurer.js":"qv8c","../../../../common/js/utils":"osPO","../composition":"AYcs"}],"AYcs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.trackHandler=exports.setUserPermission=exports.recorder=exports.playlist=exports.fileUploader=exports.USER_PERMISSION=exports.COMPOSITION_ID=void 0;var e=require("./track_handler"),r=require("./fileuploader"),t=l(require("./waveform-playlist.umd")),o=require("./composition_helper"),s=require("./record"),a=require("./latencymeasure/testlatency"),i=require("../../../common/js/utils");function l(e){return e&&e.__esModule?e:{default:e}}var n=window.location.search,c=n.split("compositionId=")[1];exports.COMPOSITION_ID=c;var d=!1;exports.USER_PERMISSION=d;var p=function(e){exports.USER_PERMISSION=d=e};exports.setUserPermission=p;var u=(0,t.default)({samplesPerPixel:3e3,waveHeight:100,container:document.getElementById("playlist"),state:"cursor",colors:{waveOutlineColor:"#E0EFF1",timeColor:"grey",fadeColor:"black"},controls:{show:!0,width:200,widgets:{stereoPan:!0,collapse:!1,remove:!0}},zoomLevels:[500,1e3,3e3,5e3],isAutomaticScroll:!0,timescale:!0});exports.playlist=u;var m=new e.TrackHandler;exports.trackHandler=m;var v=new r.FileUploader(c,m);exports.fileUploader=v;var x=new s.Recorder;exports.recorder=x;var y=c,I=function(){document.getElementById("useroptions").innerHTML='<li class="nav-item">\n  <a class="nav-link" href="#" id="testlatency" data-toggle="modal">Test Latency</a>\n</li>\n '};(0,i.activateGoHomeLink)(),I(),a.TestLatency.initialize(),"demopage"===y&&alert("WARNING: Be careful, the music you record or upload won't be saved, as you are not a registered user and this is only a test feature!"),(0,o.getComposition)(y,o.doAfterCompositionFetched);
},{"./track_handler":"x6rf","./fileuploader":"yKjk","./waveform-playlist.umd":"OgXH","./composition_helper":"tm8Q","./record":"lKJn","./latencymeasure/testlatency":"jGnR","../../../common/js/utils":"osPO"}],"l74b":[function(require,module,exports) {
"use strict";var n,t=require("../../../common/js/indexedDB"),e=require("./composition"),o=require("./composition_helper"),i=require("./latencymeasure/testlatency"),a=e.playlist.getEventEmitter(),c=$("body"),r=c.find(".time-format"),s=c.find(".audio-start"),l=c.find(".audio-end"),u=c.find(".audio-pos"),d="hh:mm:ss.uuu",f=0,m=0,h=0,p=void 0,v=!1,g=!1;function k(n){for(var t=n.parentNode.querySelectorAll(".active"),e=0,o=t.length;e<o;e++)t[e].classList.remove("active");n.classList.toggle("active")}function b(n){function t(n,t){var e,o,i;return((e=parseInt(n/3600,10)%24)<10?"0"+e:e)+":"+((o=parseInt(n/60,10)%60)<10?"0"+o:o)+":"+((i=(i=n%60).toFixed(t))<10?"0"+i:i)}return{seconds:function(n){return n.toFixed(0)},thousandths:function(n){return n.toFixed(3)},"hh:mm:ss":function(n){return t(n,0)},"hh:mm:ss.u":function(n){return t(n,1)},"hh:mm:ss.uu":function(n){return t(n,2)},"hh:mm:ss.uuu":function(n){return t(n,3)}}[n]}function y(n,t){n<t?($(".btn-trim-audio").removeClass("disabled"),$(".btn-loop").removeClass("disabled")):($(".btn-trim-audio").addClass("disabled"),$(".btn-loop").addClass("disabled")),s.val(b(d)(n)),l.val(b(d)(t)),f=n,m=t}function w(n){u.html(b(d)(n)),h=n}y(f,m),w(h),c.on("click",".btn-annotations-download",function(){a.emit("annotationsrequest")}),c.on("click",".btn-loop",function(){v=!0,n=e.playlist.play(f,m)}),c.on("click",".btn-play",function(){a.emit("play")}),c.on("click",".btn-pause",function(){v=!1,a.emit("pause")}),c.on("click",".btn-stop",function(){if(v=!1,g&&(g=!1,e.USER_PERMISSION)){var n=e.playlist.getInfo().tracks.length-1;a.emit("startaudiorendering","wav",n)}a.emit("stop")}),c.on("click",".btn-rewind",function(){v=!1,a.emit("rewind")}),c.on("click",".btn-fast-forward",function(){v=!1,a.emit("fastforward")}),c.on("click",".btn-clear",function(){v=!1,a.emit("clear")});var T=function(){$("#testLatencyModal").modal("show"),document.getElementById("buttonOkTestLatency").onclick=function(){$("#testLatencyModal").modal("hide"),i.TestLatency.start()},document.getElementById("buttonNoTestLatency").onclick=function(){$("#testLatencyModal").modal("hide"),i.TestLatency.setCurrentLatency(0),L(0)}},L=function(n){if(!g){g=!0;var t=n/1e3;a.emit("record",t)}};function I(n){if(null!=n&&n.customClass){var e={muted:(a=n).muted,gain:a.gain,soloed:a.soloed,stereoPan:a.stereoPan};e.track_id=n.customClass.track_id,e.composition_id=n.customClass.composition_id;var i=n.customClass.viewer_id||o.CURRENT_USER_ID;t.DB?(0,t.updateTable)(t.DB,e):(0,t.openDB)(i).then(function(n){(0,t.updateTable)(n,e)})}var a}function S(n,t){I(t),$(".sound-status").html(n)}function E(n){var t=$("<div/>").append(n);$(".loading-data").append(t)}function C(n){var t=(new Date).toISOString(),e=$("<a/>",{href:n,download:"waveformplaylist"+t+".wav",text:"Download mix "+t,class:"btn btn-small btn-download-link"});$(".btn-download-link").remove(),$(".btn-download").after(e)}c.on("click",".btn-record",function(){var n=i.TestLatency.getCurrentLatency();n||0===n?L(n):T()}),c.on("click",".btn-cursor",function(){a.emit("statechange","cursor"),k(this)}),c.on("click",".btn-select",function(){a.emit("statechange","select"),k(this)}),c.on("click",".btn-shift",function(){a.emit("statechange","shift"),k(this)}),c.on("click",".btn-fadein",function(){a.emit("statechange","fadein"),k(this)}),c.on("click",".btn-fadeout",function(){a.emit("statechange","fadeout"),k(this)}),c.on("click",".btn-logarithmic",function(){a.emit("fadetype","logarithmic"),k(this)}),c.on("click",".btn-linear",function(){a.emit("fadetype","linear"),k(this)}),c.on("click",".btn-scurve",function(){a.emit("fadetype","sCurve"),k(this)}),c.on("click",".btn-exponential",function(){a.emit("fadetype","exponential"),k(this)}),c.on("click",".btn-zoom-in",function(){a.emit("zoomin")}),c.on("click",".btn-zoom-out",function(){a.emit("zoomout")}),c.on("click",".btn-trim-audio",function(){a.emit("trim")}),c.on("click",".btn.print",function(){console.log(e.playlist.getInfo())}),c.on("click",".btn-download",function(){a.emit("startaudiorendering","wav")}),c.on("click",".btn-seektotime",function(){var n=parseInt(document.getElementById("seektime").value,10);a.emit("select",n,n)}),c.on("change",".select-seek-style",function(n){e.playlist.setSeekStyle(n.target.value)}),c.on("change","#fileInput",function(n){for(var t=this.files,e=0;e<t.length;e++)a.emit("newtrack",t[e])}),c.on("dragenter",".track-drop",function(n){n.preventDefault(),n.target.classList.add("drag-enter")}),c.on("dragover",".track-drop",function(n){n.preventDefault()}),c.on("dragleave",".track-drop",function(n){n.preventDefault(),n.target.classList.remove("drag-enter")}),c.on("drop",".track-drop",function(n){n.preventDefault(),n.target.classList.remove("drag-enter");for(var t=n.originalEvent,e=0;e<t.dataTransfer.files.length;e++)a.emit("newtrack",t.dataTransfer.files[e])}),c.on("change",".time-format",function(n){d=r.val(),a.emit("durationformat",d),y(f,m),w(h)}),c.on("input change",".master-gain",function(n){a.emit("mastervolumechange",n.target.value)}),c.on("change",".continuous-play",function(n){a.emit("continuousplay",$(n.target).is(":checked"))}),c.on("change",".link-endpoints",function(n){a.emit("linkendpoints",$(n.target).is(":checked"))}),c.on("change",".automatic-scroll",function(n){a.emit("automaticscroll",$(n.target).is(":checked"))}),a.on("select",y),a.on("timeupdate",w),a.on("mute",function(n){S("Mute button pressed for "+n.name,n)}),a.on("solo",function(n){S("Solo button pressed for "+n.name,n)});var D=null;a.on("volumechange",function(n,t){S(t.name+" now has volume "+n+"."),clearTimeout(D),D=setTimeout(function(){I(t)},500)});var R=null;a.on("stereopan",function(n,t){S(t.name+" now has stereo pan "+n+"."),clearTimeout(R),R=setTimeout(function(){I(t)},500)}),a.on("mastervolumechange",function(n){S("Master volume now has volume "+n+".")});var _=["uninitialized","loading","decoding","finished"];a.on("audiorequeststatechange",function(n,t){var e=t;t instanceof File&&(e=t.name),E("Track "+e+" is in state "+_[n])}),a.on("loadprogress",function(n,t){var e=t;t instanceof File&&(e=t.name),E("Track "+e+" has loaded "+n+"%")}),a.on("audiosourcesloaded",function(){E("Tracks have all finished decoding.")});var M=null;a.on("audiosourcesrendered",function(n){if(e.USER_PERMISSION)if(n){M=n;var t=e.playlist.tracks.length-1,o=e.playlist.tracks[t];!o||null!=o&&o.customClass||(M=null,e.trackHandler.displayOptMenuForNewTrack(n))}else if(M){var i=M;M=null,e.trackHandler.displayOptMenuForNewTrack(i)}E("Tracks have been rendered")}),a.on("audiosourceserror",function(n){E(n.message)}),a.on("audiorenderingfinished",function(n,t,o){o>=0&&e.USER_PERMISSION?(t.name="audio",t.fileName=Date.now()+".wav",e.fileUploader.sendData(t,"blob")):"wav"==n&&(p&&window.URL.revokeObjectURL(p),C(p=window.URL.createObjectURL(t)))}),a.on("finished",function(){console.log("The cursor has reached the end of the selection !"),v&&n.then(function(){n=e.playlist.play(f,m)})});
},{"../../../common/js/indexedDB":"bt5Z","./composition":"AYcs","./composition_helper":"tm8Q","./latencymeasure/testlatency":"jGnR"}]},{},["l74b"], null)
//# sourceMappingURL=eventemitter.fec5f389.js.map