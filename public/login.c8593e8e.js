function e(e,t,o,n){Object.defineProperty(e,t,{get:o,set:n,enumerable:!0,configurable:!0})}var t=globalThis,o={},n={},i=t.parcelRequire1e7e;null==i&&((i=function(e){if(e in o)return o[e].exports;if(e in n){var t=n[e];delete n[e];var i={id:e,exports:{}};return o[e]=i,t.call(i.exports,i,i.exports),i.exports}var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,t){n[e]=t},t.parcelRequire1e7e=i);var l=i.register;l("ck9ES",function(t,o){e(t.exports,"LOADER_ELEM_ID",()=>l),e(t.exports,"uriUserPage",()=>a),e(t.exports,"uriCollectionPage",()=>r),e(t.exports,"LevelPrivacy",()=>d),e(t.exports,"PRIVACY_BADGE_STYLE",()=>c),e(t.exports,"PRIVACY_BADGE_TEXT",()=>s),e(t.exports,"startLoader",()=>m),e(t.exports,"cancelLoader",()=>u),e(t.exports,"callJsonApi",()=>g),e(t.exports,"looksLikeMail",()=>E),e(t.exports,"activateGoHomeLink",()=>p),e(t.exports,"isSafari",()=>f);var n=i("9QUIF");let l="loader",a="/index.html?userid=",r="/index.html?collectionid=";Object.freeze({none:0,owner:1,admin:2,member:3,guest:4});let d=Object.freeze({public:1,onlyreg:2,private:3}),c={[d.public]:"badge-public",[d.onlyreg]:"badge-onlyreg",[d.private]:"badge-private"},s={[d.public]:"PUBLIC",[d.onlyreg]:"REG USERS",[d.private]:"PRIVATE"},m=(e,t)=>{let o=document.getElementById(e);o.nextElementSibling.textContent=t,o.classList.add(e)},u=e=>{let t=document.getElementById(e);t.classList.remove(e),t.nextElementSibling.textContent=""},g=async(e,t,o)=>{let i={method:t||"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}};o&&(i.body=JSON.stringify(o));try{m(l,"Loading...");let t=await fetch(n.ENDPOINT+e,i);u(l);let o=await t.json();if(o&&!o.error)return o;return o?.error||"An error occurred"}catch(e){return u(l),e}},E=e=>{let t=e.lastIndexOf("@"),o=e.lastIndexOf(".");return t<o&&t>0&&-1==e.indexOf("@@")&&o>2&&e.length-o>2},p=()=>{let e=document.getElementById("goHome");"localhost:80"===window.location.host||"http://localhost"===window.location.origin?e.href=window.location.origin+"/index.html":e.href=window.location.origin},f=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}),l("9QUIF",function(e,t){let o="STAGE",n={PROD:{ENDPOINT:"",UPLOAD_ENDPOINT:""},STAGE:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"},DEV:{ENDPOINT:window.location.protocol+"//"+window.location.hostname,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.hostname+":7007/fileUpload"}};e.exports={ENDPOINT:n[o].ENDPOINT,UPLOAD_ENDPOINT:n[o].UPLOAD_ENDPOINT}});var a=i("ck9ES");let r=null;const d=async()=>{(await (0,a.callJsonApi)("/profile","GET")).ok&&(window.location.href=window.location.origin+"/profile.html")},c=async()=>{let e=document.getElementById("inputloginemail").value;if((0,a.looksLikeMail)(e)){let t=await (0,a.callJsonApi)("/generatelogincode/"+e,"PUT");t.ok?(r=e,document.getElementById("authmethodform").hidden=!0,document.getElementById("validationcodefield").hidden=!1):(document.getElementById("inputloginemail").classList.add("is-invalid"),document.getElementById("validationEmailResult").innerText=t)}else document.getElementById("inputloginemail").classList.add("is-invalid"),document.getElementById("validationEmailResult").innerText="Sorry, invalid email address format."},s=async()=>{let e=document.getElementById("verificationCode").value;if(/\d{6}/.test(e)){let t={email:r,code:e};(await (0,a.callJsonApi)("/logincodevalidation","POST",t)).ok?(r=null,window.location.href=window.location.origin):(document.getElementById("verificationCode").classList.add("is-invalid"),document.getElementById("validationCodeResult").innerText="Wrong code, sorry")}else document.getElementById("verificationCode").classList.add("is-invalid"),document.getElementById("validationCodeResult").innerText="Sorry, invalid code format."};(0,a.activateGoHomeLink)(),document.getElementById("googleLoginButton").onclick=()=>{window.location.href="/googlelogin"},document.getElementById("sendcodebutton").onclick=c,document.getElementById("inputloginemail").onkeydown=function(e){if("Enter"==e.key)return c()},document.getElementById("validatecodebutton").onclick=s,document.getElementById("verificationCode").onkeydown=function(e){if("Enter"==e.key)return s()},d();
//# sourceMappingURL=login.c8593e8e.js.map
