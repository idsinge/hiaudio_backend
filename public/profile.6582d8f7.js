function e(e,t,o,n){Object.defineProperty(e,t,{get:o,set:n,enumerable:!0,configurable:!0})}var t=globalThis,o={},n={},i=t.parcelRequire1e7e;null==i&&((i=function(e){if(e in o)return o[e].exports;if(e in n){var t=n[e];delete n[e];var i={id:e,exports:{}};return o[e]=i,t.call(i.exports,i,i.exports),i.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){n[e]=t},t.parcelRequire1e7e=i);var a=i.register;a("9QUIF",function(e,t){let o="STAGE",n={PROD:{ENDPOINT:"",UPLOAD_ENDPOINT:""},STAGE:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"},DEV:{ENDPOINT:window.location.protocol+"//"+window.location.host,UPLOAD_ENDPOINT:window.location.protocol+"//"+window.location.host+"/fileUpload"}};e.exports={ENDPOINT:n[o].ENDPOINT,UPLOAD_ENDPOINT:n[o].UPLOAD_ENDPOINT}}),a("ck9ES",function(t,o){e(t.exports,"LOADER_ELEM_ID",()=>a),e(t.exports,"uriUserPage",()=>l),e(t.exports,"uriCollectionPage",()=>r),e(t.exports,"LevelPrivacy",()=>c),e(t.exports,"PRIVACY_BADGE_STYLE",()=>d),e(t.exports,"PRIVACY_BADGE_TEXT",()=>s),e(t.exports,"startLoader",()=>m),e(t.exports,"cancelLoader",()=>u),e(t.exports,"callJsonApi",()=>p),e(t.exports,"looksLikeMail",()=>E),e(t.exports,"activateGoHomeLink",()=>g),e(t.exports,"MEDIA_CONSTRAINTS",()=>y);var n=i("9QUIF");let a="loader",l="/index.html?userid=",r="/index.html?collectionid=";Object.freeze({none:0,owner:1,admin:2,member:3,guest:4});let c=Object.freeze({public:1,onlyreg:2,private:3}),d={[c.public]:"badge-public",[c.onlyreg]:"badge-onlyreg",[c.private]:"badge-private"},s={[c.public]:"PUBLIC",[c.onlyreg]:"REG USERS",[c.private]:"PRIVATE"},m=(e,t)=>{let o=document.getElementById(e);o.nextElementSibling.textContent=t,o.classList.add(e)},u=e=>{let t=document.getElementById(e);t.classList.remove(e),t.nextElementSibling.textContent=""},p=async(e,t,o)=>{let i={method:t||"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}};o&&(i.body=JSON.stringify(o));try{m(a,"Loading...");let t=await fetch(n.ENDPOINT+e,i);u(a);let o=await t.json();if(o&&!o.error)return o;return o?.error||"An error occurred"}catch(e){return u(a),e}},E=e=>{let t=e.lastIndexOf("@"),o=e.lastIndexOf(".");return t<o&&t>0&&-1==e.indexOf("@@")&&o>2&&e.length-o>2},g=()=>{let e=document.getElementById("goHome");"localhost:80"===window.location.host||"http://localhost"===window.location.origin?e.href=window.location.origin+"/index.html":e.href=window.location.origin};/^((?!chrome|android).)*safari/i.test(navigator.userAgent);let y={audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,latency:0,channelCount:1}}}),a("hcAI8",function(t,o){e(t.exports,"checkIfTermsAccepted",()=>a),e(t.exports,"generateAcceptTermsModal",()=>d);var n=i("ck9ES");let a=(e,t)=>{(0,n.cancelLoader)(n.LOADER_ELEM_ID),t(e?.terms_accepted)},l=()=>{$("#acceptTermsModal").modal({backdrop:"static",keyboard:!1}),$("#acceptTermsModal").modal("show"),document.getElementById("buttonAcceptTerms").onclick=r,document.getElementById("buttonRejectTerms").onclick=c},r=async()=>{(await (0,n.callJsonApi)("/acceptterms","PUT")).ok&&$("#acceptTermsModal").modal("hide")},c=async()=>{(await (0,n.callJsonApi)("/rejectterms","PUT")).ok&&($("#acceptTermsModal").modal("hide"),window.location.href=window.location.origin)},d=e=>{if(!document.getElementById("acceptTermsModal")){let t=`<div class="modal fade" id="acceptTermsModal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title">Accept Terms</h5>                
                </div>
                <div class="modal-body">
                <p>By clicking on OK you accept the Terms of Use.</p>
                <p>More information at: <span> <a href="${window.location.origin}/static/terms.html" target="_blank">${window.location.origin}/static/terms.html</a></span></p>
                </div>
                <div class="modal-footer">
                <button id="buttonRejectTerms" type="button" class="btn btn-secondary" data-dismiss="modal">Reject</button>
                <button id="buttonAcceptTerms" type="button" class="btn btn-primary">OK</button>
                </div>
            </div>
            </div>
        </div>`;document.getElementsByTagName(e)[0].insertAdjacentHTML("afterend",t)}l()}});var l=i("9QUIF"),r=i("ck9ES"),c=i("hcAI8");let d=null,s=!1;const m=document.getElementById("editusernamebutton"),u=e=>{e||(0,c.generateAcceptTermsModal)("main")},p=async e=>{let t=await (0,r.callJsonApi)("/profile","GET");t&&e(t)},E=e=>{document.getElementById("button-deleteprofile").addEventListener("click",async()=>{await y(e)})},g=()=>{document.getElementById("copytokenbutton").onclick=()=>{window.prompt("Copy to clipboard: Ctrl+C, Enter",document.getElementById("apitoken").innerHTML)}},y=async e=>{let t=prompt("To confirm, please enter your User ID","");if(t===e)try{let t=await fetch(l.ENDPOINT+"/deleteuser/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"}});await t.json()&&(window.location.href=window.location.origin)}catch(e){alert(e)}else t!==e&&null!==t&&alert("Sorry, the User ID does not match")},T=()=>{document.getElementById("usernameinputfield").classList.add("italic"),document.getElementById("usernameinputfield").removeAttribute("readonly")},I=async()=>{let e=document.getElementById("usernameinputfield"),t=e.value;if(e.value=t.trim(),d===t)w();else{let o=await (0,r.callJsonApi)("/updateusername","PATCH",{user_name:t});o.ok?(d=t,w()):(e.classList.add("is-invalid"),document.getElementById("validationusernameresult").innerText="Sorry, "+o)}},w=()=>{let e=document.getElementById("usernameinputfield");s=!1,m.innerHTML='<i class="fas fa-edit">&nbsp;</i>Edit username',e.setAttribute("readonly","true"),e.classList.remove("is-invalid"),e.classList.remove("italic"),document.getElementById("validationusernameresult").innerText=""};(0,r.activateGoHomeLink)(),m.addEventListener("click",()=>{s?I():(s=!0,m.innerHTML='<i class="fas fa-save">&nbsp;</i>Save',T())},!1),p(e=>{e.ok?((0,c.checkIfTermsAccepted)(e,u),document.getElementById("profilecard").hidden=!1,document.getElementById("profilepicture").src=`https://picsum.photos/seed/${e.user_uid}/200`,d=e.name,document.getElementById("usernameinputfield").value=e.name,document.getElementById("userid").innerHTML=e.user_uid,document.getElementById("emailaddress").innerHTML=e.email,E(e.user_uid),document.getElementById("apicard").hidden=!1,document.getElementById("apitoken").innerHTML=e.token,document.getElementById("curlcode").innerHTML=`$ export JWT="${e.token}"  <br /><br />$ curl ${window.location.protocol}//${window.location.host}/profile   -H "Authorization: Bearer $JWT"`,g()):document.getElementById("logincard").hidden=!1});
//# sourceMappingURL=profile.6582d8f7.js.map
